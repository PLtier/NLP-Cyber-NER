Uses O
RijndaelManaged O
instead O
of O
AES O
for O
encryption O
. O

( O
with O
ECB O
mode O
, O
which O
is O
considered O
weak O
) O
. O

Quasar B-Malware
contains O
the O
NetSerializer O
library O
that O
handles O
serialization O
of O
high O
level O
IPacket O
objects O
that O
the O
client O
and O
server O
use O
to O
communicate O
. O

The O
serialization O
assigns O
unique O
IDs O
for O
serializable O
objects O
types O
. O

The O
open O
source O
and O
several O
other O
samples O
we O
found O
give O
a O
dynamically-assigned O
1 O
byte O
ID O
at O
compile O
time O
. O

The O
sample O
we O
analyzed O
changed O
that O
behavior O
and O
hard-coded O
DWORD O
for O
each O
object O
type O
. O

This O
is O
a O
better O
implementation O
, O
as O
it O
allows O
servers O
and O
clients O
from O
different O
versions O
to O
communicate O
with O
each O
other O
to O
some O
extent O
. O

The O
sample O
we O
analyzed O
is O
most O
likely O
forked O
from O
open O
source O
quasar O
1.2.0.0 O
. O

We O
find O
multiple O
file/object O
names O
hinting O
at O
the O
version O
, O
but O
must O
compelling O
: O
Quasar B-System
version O
1.1.0.0 O
names O
the O
encryption O
module O
name O
space O
“ O
Encryption O
” O
, O
while O
subsequent O
Quasar O
versions O
use O
“ O
Cryptography O
” O
– O
which O
we O
observe O
in O
this O
sample O
. O

Quasar B-System
version O
1.3.0.0 O
changed O
the O
encryption O
key O
generation O
, O
and O
stopped O
saving O
the O
password O
in O
the O
sample O
. O

There O
are O
more O
indications O
as O
well O
, O
such O
as O
names O
of O
objects O
, O
files O
etc O
. O

Other O
samples O
we O
analyzed O
had O
different O
combinations O
of O
modification O
to O
cryptography O
and O
serialization O
. O

Our O
decompilation O
of O
the O
serialization O
library O
was O
not O
complete O
enough O
to O
allow O
simple O
recompilation O
. O

Instead O
, O
we O
downloaded O
and O
compiled O
the O
1.2.0.0 O
server O
of O
the O
open-source O
Quasar B-System
RAT I-Malware
, O
having O
determined O
that O
this O
seemed O
likely O
the O
most O
similar O
version O
. O

The O
out-of-the-box O
server O
could O
not O
communicate O
with O
the O
client O
sample O
owing O
to O
the O
previously O
documented O
modifications O
that O
we O
had O
observed O
. O

We O
incorporated O
those O
changes O
into O
our O
build O
, O
discovering O
that O
this O
worked O
for O
most O
sample O
versions O
with O
almost O
no O
further O
modification O
. O

Both O
the O
client O
and O
the O
server O
use O
the O
same O
code O
to O
serialize O
and O
encrypt O
the O
communications O
. O

Instead O
of O
compiling O
a O
different O
server O
for O
each O
client O
, O
our O
server O
uses O
the O
code O
from O
within O
the O
client O
to O
communicate O
with O
it O
. O

Using O
Reflection O
, O
the O
server O
can O
load O
the O
assembly O
of O
the O
client O
to O
find O
the O
relevant O
functions O
and O
passwords O
. O

This O
was O
more O
complex O
. O

Both O
the O
client O
and O
server O
uses O
the O
same O
API O
, O
but O
the O
client O
serializer O
cannot O
serialize O
server O
objects O
, O
because O
they O
are O
not O
the O
same O
as O
their O
“ O
mirrored O
” O
objects O
inside O
the O
client O
. O

In O
some O
cases O
these O
objects O
are O
completely O
different O
, O
for O
example O
the O
server O
commands O
to O
get O
the O
file O
system O
. O

Our O
solution O
is O
to O
: O
Translate O
on O
the O
fly O
the O
objects O
the O
server O
send O
to O
mirrored O
matching O
client O
objects O
( O
will O
not O
work O
if O
client O
doesn’t O
have O
this O
object O
, O
or O
renamed O
it O
) O
. O

Copy O
the O
content O
from O
the O
server O
object O
into O
the O
new O
client O
object O
( O
will O
not O
work O
if O
client O
implementation O
is O
different O
) O
. O

Serialize O
the O
client O
object O
( O
which O
will O
be O
later O
encrypted O
and O
sent O
) O
. O

Deserialize O
the O
decrypted O
response O
into O
another O
client O
response O
object O
. O

Translate O
the O
client O
response O
object O
into O
the O
server O
version O
of O
the O
client O
response O
object O
. O

Copy O
the O
contents O
from O
the O
client O
response O
object O
into O
the O
translated O
server O
object O
. O

Return O
the O
translated O
object O
. O

Our O
sample O
communicates O
with O
app.progsupdate.com B-System
, O
which O
resolved O
to O
185.141.25.68 O
, O
over O
TCP O
port O
4664 O
. O

The O
server O
sends O
a O
command O
. O

for O
example O
, O
“ O
Get O
System O
Information O
” O
. O

The O
command O
is O
translated O
to O
an O
IPacket O
of O
type O
GetSystemInfo O
. O

The O
packet O
is O
serialized O
into O
a O
stream O
of O
bytes O
. O

The O
stream O
of O
bytes O
is O
encrypted O
( O
in O
some O
versions O
there O
is O
also O
optional O
compression O
step O
) O
. O

The O
stream O
of O
bytes O
is O
sent O
over O
TCP O
to O
the O
client O
. O

The O
client O
receives O
and O
decrypts O
the O
packet O
. O

The O
client O
deserializes O
the O
packet O
into O
IPacket O
GetSystemInfo O
. O

The O
relevant O
handler O
of O
the O
client O
is O
called O
, O
collects O
the O
system O
information O
and O
sends O
it O
back O
inside O
IPacket O
of O
GetSystemInfoResponse O
. O

Each O
of O
these O
layers O
seems O
to O
be O
different O
to O
some O
extent O
in O
the O
various O
samples O
we O
found O
. O

The O
IPacket O
, O
Serialization O
and O
Encryption O
framework I-System
code O
is O
shared O
between O
the O
client O
and O
the O
server O
, O
therefore O
we O
can O
use O
it O
with O
Reflection O
. O

However O
the O
Server O
handlers O
and O
command O
function O
are O
not O
, O
so O
we O
cannot O
create O
a O
completely O
perfect O
simulation O
. O

The O
attacker B-Organization
can O
issue O
commands O
( O
not O
all O
commands O
appear O
in O
different O
samples O
) O
through O
the O
Quasar B-System
server O
GUI O
for O
each O
client O
: O
Get O
system O
information O
. O

Get O
file O
system O
. O

Upload O
/ O
download O
/ O
execute O
files O
. O

Startup O
manager O
. O

Open O
task O
manager O
. O

Kill O
/ O
start O
processes O
. O

Edit O
registry O
. O

Reverse O
Proxy O
. O

Shutdown O
/ O
restart O
the O
computer O
. O

Open B-System
remote I-System
desktop I-System
connection I-System
. O

Observe O
the O
desktop O
and O
actions O
of O
active O
user O
. O

Issue O
remote O
mouse O
clicks O
and O
keyboard O
strokes O
. O

Password O
stealing O
. O

Retrieve O
Keylogger O
logs O
. O

Visit O
website O
. O

Display O
a O
message O
box O
. O

The O
file O
system O
commands O
underling O
handlers O
and O
IPacket O
were O
modified O
to O
support O
more O
features O
, O
so O
these O
commands O
don’t O
work O
out O
of O
the O
box O
and O
required O
manual O
implementation O
from O
us O
. O

With O
further O
analysis O
of O
the O
Quasar B-System
RAT I-System
C2 O
Server I-System
, O
we O
uncovered O
vulnerabilities O
in O
the O
server O
code O
, O
which O
would O
allow O
remote O
code O
execution O
. O

This O
might O
allow O
a O
second O
attacker O
to O
install O
code O
of O
their O
choice O
– O
for O
example O
, O
their O
own O
Quasar B-System
RAT I-Malware
– O
on O
the O
original O
attacker B-Organization
’s O
server O
. O

We O
refer O
to O
this O
( O
somewhat O
ironic O
) O
technique O
as O
a O
“ O
Double O
Edged O
Sword O
Attack O
” O
. O

We O
did O
not O
apply O
this O
to O
any O
live O
C2 O
servers O
– O
we O
only O
tested O
this O
with O
our O
own O
servers O
in O
our O
lab O
. O

In O
the O
lab O
, O
we O
changed O
our O
Quasar B-System
RAT I-Malware
source O
code O
to O
use O
the O
known O
encryption O
key O
, O
and O
to O
send O
fake O
victim O
IP O
address O
, O
City O
, O
Country O
code O
, O
Flag O
, O
and O
Username O
. O

The O
Quasar B-System
serve O
does O
not O
verify O
the O
RAT O
data O
, O
and O
displays O
this O
data O
in O
the O
RAT O
Server O
GUI O
when O
the O
RAT O
is O
executed O
and O
connects O
to O
the O
server O
. O

We O
found O
this O
could O
be O
used O
to O
supply O
compelling O
“ O
victim O
data O
” O
to O
convince O
the O
attacker O
to O
connect O
to O
this O
“ O
victim O
” O
via O
the O
GUI O
. O

Quasar B-System
serve O
includes O
a O
File O
Manager O
window O
, O
allowing O
the O
attacker O
to O
select O
victim O
files O
, O
and O
trigger O
file O
operations O
– O
for O
example O
, O
uploading O
a O
file O
from O
victim O
machine O
to O
server O
. O

Uploaded O
files O
are O
written O
to O
the O
server O
sub O
directory O
“ O
clients\user_name@machine_name_ipaddress O
” O
. O

Quasar B-Malware
serve O
does O
not O
verify O
that O
the O
size O
, O
filename O
, O
extension O
, O
or O
header O
of O
the O
uploaded O
file O
is O
the O
same O
as O
requested O
. O

Therefore O
, O
if O
we O
convince O
the O
attacker O
to O
request O
the O
file O
“ O
secret_info.doc O
( O
20KB O
) O
” O
, O
we O
can O
instead O
return O
to O
the O
server O
any O
file O
of O
our O
choice O
, O
of O
any O
size O
or O
type O
. O

When O
the O
Quasar B-Malware
serve O
retrieves O
the O
name O
of O
the O
uploaded O
file O
from O
the O
victim O
, O
it O
does O
not O
verify O
that O
it O
is O
a O
valid O
file O
path O
. O

Therefore O
sending O
the O
file O
path O
“ O
..\..\ O
secret_info.doc O
” O
will O
result O
in O
writing O
our O
file O
instead O
to O
the O
same O
directory O
as O
the O
Quasar B-Malware
serve O
code O
. O

Quasar B-System
serve O
does O
not O
even O
verify O
that O
a O
file O
was O
requested O
from O
the O
victim O
. O

Immediately O
when O
the O
File O
Manager O
window O
is O
opened O
by O
the O
attacker B-Organization
, O
the O
Quasar O
serve O
sends O
two O
commands O
to O
the O
RAT O
: O
GetDrives O
and O
listDirectory O
( O
to O
populate O
the O
list O
of O
the O
victim O
’s O
files O
in O
the O
RAT O
Server O
GUI O
) O
. O

We O
can O
respond O
to O
those O
commands O
by O
instead O
sending O
two O
files O
of O
our O
choice O
to O
the O
Quasar B-System
serve O
. O

Again O
, O
we O
control O
the O
content O
of O
the O
file O
, O
the O
size O
and O
the O
path O
and O
filename O
. O

Quasar B-System
is O
a O
.NET O
Framework O
assembly O
, O
loading O
multiple O
DLLs O
upon O
launch O
, O
for O
example O
“ O
dnsapi.dll O
” O
. O

Quasar B-System
serve O
is O
vulnerable O
to O
a O
simple O
DLL O
hijacking O
attack O
, O
by O
using O
this O
technique O
to O
replace O
server O
DLLs B-Vulnerability
. O

When O
the O
attacker B-Organization
restarts O
the O
Quasar B-System
application O
, O
our O
uploaded O
“ O
dnsapi.dll O
” O
will O
instead O
be O
loaded O
. O

Through O
this O
vector O
, O
we O
could O
drop O
our O
own O
Quasar B-System
clien O
on O
the O
attacker B-Organization
’s O
server O
and O
execute O
it O
. O

Our O
Quasar B-System
RAT I-Malware
will O
connect O
to O
our O
own O
( O
secured O
, O
of O
course O
) O
Quasar O
serve O
, O
allowing O
us O
to O
control O
that O
attacker B-Organization
’s O
server O
with O
his O
own O
RAT O
. O

We O
can O
also O
replace O
“ O
shfolder.dll O
” O
( O
and O
add O
a O
DLL O
export O
proxy O
to O
avoid O
a O
crash O
) O
, O
which O
is O
loaded O
whenever O
the O
attacker O
clicks O
the O
builder O
tab O
– O
allowing O
us O
to O
infect O
the O
server O
while O
it O
runs O
, O
without O
the O
need O
to O
wait O
for O
application O
restart O
. O

Although O
Downeks B-System
has O
been O
publicly O
examined O
to O
some O
extent O
, O
our O
analysis O
found O
several O
features O
not O
previously O
described O
. O

Earlier O
Downeks B-System
samples I-System
were O
all O
written O
in O
native O
code O
. O

However O
, O
among O
our O
Downeks B-Malware
samples O
, O
we O
found O
new O
versions O
apparently O
written O
in O
.NET O
. O

We O
observe O
many O
behavioral O
similarities O
and O
unique O
strings O
across O
both O
the O
native-Downeks O
versions O
, O
and O
the O
new O
.NET O
Downeks O
versions O
. O

Almost O
all O
of O
the O
strings O
and O
behaviors O
we O
describe O
in O
this O
analysis O
of O
a O
.NET O
version O
are O
also O
present O
in O
the O
native O
version O
. O

We O
observed O
these O
samples O
deployed O
only O
against O
Hebrew-speaking O
targets O
. O

Downeks B-Organization
.NET O
internal O
name O
is O
“ O
SharpDownloader O
” O
, O
“ O
Sharp O
” O
may O
be O
a O
reference O
to O
the O
language O
it O
was O
written O
in O
– O
C# O
. O

As O
seen O
in O
previous O
Downeks B-Malware
versions O
, O
it O
uses O
masquerades O
with O
icons O
, O
filenames O
and O
metadata O
imitating O
popular O
legitimate O
applications O
such O
as O
VMware O
workstation O
and O
CCleaner O
, O
or O
common O
file O
formats O
such O
as O
DOC O
and O
PDF B-System
. O

All O
3 O
samples O
were O
compiled O
with O
the O
same O
timestamp O
. O

Downeks.NET O
is O
obfuscated O
using O
“ O
Yano O
” O
and O
can O
be O
easily O
de-obfuscated O
using O
the O
de4dot O
utility O
. O

SHA256 O
: O
4dcf5bd2c7a5822831d9f22f46bd2369c4c9df17cc99eb29975b5e8ae7e88606 O
. O

SHA256 O
: O
905f6a62749ca6f0fd33345d6a8b1831d87e9fd1f81a59cd3add82643b367693 O
. O

SHA256 O
: O
c885f09b10feb88d7d176fe1a01ed8b480deb42324d2bb825e96fe1408e2a35f O
. O

Downeks B-Malware
is O
a O
backdoor O
with O
only O
very O
basic O
capabilities O
. O

It O
communicates O
with O
the O
C2 O
server O
using O
HTTP O
POST O
requests O
. O

It O
runs O
in O
an O
infinite O
loop O
, O
in O
each O
iteration O
it O
requests O
a O
command O
from O
the O
C2 O
, O
and O
then O
it O
sleeps O
for O
a O
time O
period O
it O
receives O
in O
the O
C2 O
response O
( O
defaulting O
to O
1 O
second O
if O
no O
sleep-time O
sent O
) O
. O

The O
data O
that O
is O
sent O
in O
the O
POST O
is O
serialized O
with O
json O
, O
which O
is O
then O
is O
encrypted O
, O
and O
finally O
encoded O
in O
base64 O
. O

The O
json O
format O
is O
typically O
{ O
“mth O
” O
: O
” O
some_method O
” O
, O
“ O
data O
” O
: O
” O
some_encrypted_data O
” O
} O
. O

The O
C2 O
server O
responds O
using O
the O
same O
format O
and O
serialization/encryption/encoding O
. O

As O
described O
in O
earlier O
analyses O
, O
Downeks B-System
’ O
main O
purpose O
is O
as O
a O
downloader O
. O

Unfortunately O
, O
we O
were O
unable O
to O
get O
any O
C2 O
servers O
to O
issue O
download O
commands O
to O
any O
samples O
that O
we O
tested O
in O
our O
lab O
. O

The O
download O
is O
initiated O
upon O
receiving O
json O
with O
a O
“ O
download O
” O
command O
, O
which O
includes O
the O
URL O
of O
the O
file O
to O
be O
downloaded O
. O

Downeks B-Malware
can O
also O
be O
instructed O
to O
execute O
binaries O
that O
already O
exist O
on O
the O
victim O
machine O
. O

After O
successful O
execution O
, O
Downeks B-Organization
returns O
the O
results O
to O
the O
C2 O
server O
. O

Downeks B-Organization
also O
has O
a O
self-update O
capability O
, O
if O
instructed O
by O
the O
C2 O
. O

Downeks B-Malware
can O
be O
instructed O
with O
the O
“ O
img O
” O
command O
to O
capture O
the O
victim O
screen O
and O
transmit O
it O
back O
to O
the O
C2 O
. O

The O
parameters O
“ O
wth O
” O
and O
“ O
qlt O
” O
specify O
“ O
width O
” O
and O
“ O
quality O
” O
. O

Downeks B-Malware
.NET I-Malware
creates O
a O
file O
in O
the O
“ O
Appdata O
” O
directory O
, O
based O
on O
certain O
properties O
of O
the O
machine O
. O

During O
our O
analysis O
, O
Downeks B-Malware
created O
a O
file O
in O
“ O
Appdata\Roaming O
” O
containing O
only O
“ O
SD{new O
line} O
0 O
” O
( O
“ O
SD O
” O
possibly O
for O
“ O
SharpDownloader O
” O
) O
. O

Although O
this O
file O
itself O
is O
not O
particularly O
interesting O
, O
the O
older O
( O
native O
) O
Downeks O
versions O
also O
creates O
a O
file O
in O
Appdata\Roaming O
, O
with O
identical O
data O
. O

The O
filenames O
across O
the O
two O
variants O
bear O
striking O
similarities O
. O

The O
.NET B-Malware
variant O
creates O
“ O
1FABFBFF0000065132F71D94 O
” O
, O
while O
the O
native O
version O
creates O
“ O
000206511FABFBFF O
” O
. O

We O
observed O
the O
string O
“ O
1FABFBFF0000065132F71D94 O
” O
in O
memory O
during O
debugging O
of O
the O
native O
variant O
. O

This O
is O
a O
pseudo-unique O
ID O
for O
each O
machine O
, O
based O
on O
install O
date O
taken O
from O
the O
registry O
, O
volume O
serial O
number O
, O
OS O
version O
and O
service O
pack O
, O
Processor O
architecture O
, O
and O
computer O
name O
. O

Downeks B-Organization
enumerates O
any O
antivirus O
products O
installed O
on O
the O
victim O
machine O
and O
transmits O
the O
list O
to O
the O
C2 O
. O

It O
constructs O
this O
list O
using O
the O
WMI O
query O
: O
“SELECT O
displayName O
FROM O
AntivirusProduct O
” O
. O

Downeks B-Malware
achieves O
host O
persistence O
through O
either O
the O
registry O
“ O
run O
” O
key O
or O
with O
a O
shortcut O
in O
the O
start-up O
folder O
. O

In O
another O
similarity O
between O
both O
variants O
, O
Dowenks O
assesses O
the O
victim O
’s O
external O
IP O
using O
an O
HTTP O
request O
to O
http://www.myexternalIP O
. O

com/raw O
. O

Downeks B-Malware
can O
be O
instructed O
by O
the O
C2 O
to O
perform O
a O
few O
other O
commands O
: O
Check O
if O
the O
computer O
name O
and O
user O
name O
, O
or O
external O
IP O
address O
, O
is O
in O
a O
provided O
list O
and O
if O
so O
, O
display O
a O
message O
box O
with O
a O
message O
as O
defined O
by O
the O
C2 O
. O

Kill O
any O
running O
process O
and O
attempt O
to O
delete O
the O
associated O
executable O
. O

“ O
Setup O
” O
command O
– O
sends O
various O
info O
about O
the O
machine O
with O
each O
iteration O
of O
the O
C2 O
communications O
loop O
. O

Downeks B-Organization
has O
static O
encryption O
keys O
hardcoded O
in O
the O
code O
. O

Palo B-Organization
Alto I-Organization
Networks I-Organization
customers I-Organization
are O
protected O
from O
Downeks B-System
and O
Quasar B-System
used O
in O
this O
attack O
: O
WildFire B-Organization
properly O
classifies O
these O
Downeks B-System
and O
Quasar B-System
samples I-System
as O
malicious O
. O

Traps O
detects O
and O
blocks O
malicious O
behavior O
exhibited O
by O
new O
, O
unknown O
Quasar B-System
samples I-System
. O

C2 O
servers O
associated O
with O
this O
activity O
are O
blocked O
through O
Threat O
Prevention O
DNS O
signatures O
. O

URI O
TERROR O
ATTACK O
& O
KASHMIR O
PROTEST O
THEMED O
SPEAR O
PHISHING O
emails O
TARGETING O
INDIAN O
EMBASSIES O
AND O
INDIAN O
MINISTRY O
OF O
EXTERNAL O
AFFAIRS O
- O
CYSINFO O
. O

In O
my O
previous O
blog O
I O
posted O
details O
of O
a O
cyber O
attack O
targeting O
Indian O
government B-Organization
organizations I-Organization
. O

This O
blog O
post O
describes O
another O
attack O
campaign O
where O
attackers B-Organization
used O
the O
Uri O
terror O
attack O
and O
Kashmir O
protest O
themed O
spear B-Vulnerability
phishing I-Vulnerability
email I-Vulnerability
to O
target O
officials O
in O
the O
Indian O
Embassies O
and O
Indian O
Ministry O
of O
External O
Affairs O
( O
MEA O
) O
. O

In O
order O
to O
infect O
the O
victims O
, O
the O
attackers O
distributed O
spear-phishing B-Vulnerability
emails I-Vulnerability
containing O
malicious O
word O
document O
which O
dropped O
a O
malware O
capable O
of O
spying O
on O
infected O
systems O
. O

The O
email O
purported O
to O
have O
been O
sent O
from O
legitimate O
email O
ids O
. O

The O
attackers B-Organization
spoofed O
the O
email O
ids O
associated O
with O
Indian O
Ministry O
of O
Home O
Affairs O
to O
send O
out O
email O
to O
the O
victims O
. O

Attackers B-Organization
also O
used O
the O
name O
of O
the O
top-ranking O
official O
associated O
with O
Minister O
of O
Home B-System
affairs I-System
in O
the O
signature O
of O
the O
email O
, O
this O
is O
to O
make O
it O
look O
like O
the O
email O
was O
sent O
by O
a O
high-ranking O
Government O
official O
associated O
with O
Ministry O
of O
Home O
Affairs O
( O
MHA O
) O
. O

In O
the O
The O
first O
wave O
of O
attack O
, O
The O
attackers O
spoofed O
an O
email B-Vulnerability
id O
that O
is O
associated O
with O
Indian O
Ministry O
of O
Home O
Affairs O
( O
MHA O
) O
and O
an O
email O
was O
sent O
on O
September O
20th O
, O
2016 O
( O
just O
2 O
days O
after O
the O
Uri O
terror O
attack O
) O
to O
an O
email O
id O
associated O
with O
the O
Indian O
Embassy O
in O
Japan O
. O

The O
email O
was O
made O
to O
look O
like O
as O
if O
an O
investigation O
report O
related O
to O
Uri O
terror O
attack O
was O
shared O
by O
the O
MHA O
official O
. O

On O
Sept O
20th,2016 O
similar O
Uri O
Terror O
report O
themed O
email O
was O
also O
sent O
to O
an O
email O
id O
connected O
with O
Indian O
embassy B-Organization
in O
Thailand O
. O

This O
email O
was O
later O
forwarded O
on O
Oct O
24th,2016 O
from O
a O
spoofed O
email O
id O
which O
is O
associated O
with O
Thailand O
Indian O
embassy O
to O
various O
email O
recipients O
connected O
to O
the O
Indian O
Ministry O
of O
External O
Affairs O
as O
shown O
in O
the O
below O
screen O
shot O
. O

In O
this O
case O
Attackers O
again O
spoofed O
an O
email O
id O
associated O
with O
Indian O
Ministry O
of O
Home O
Affairs O
and O
the O
mail O
was O
sent O
on O
September O
1,2016 O
to O
an O
email O
id O
associated O
Thailand O
Indian O
embassy B-Organization
, O
this O
email O
was O
later O
forwarded O
on O
Oct O
24th,2016 O
from O
a O
spoofed O
email O
of O
Thailand O
Indian O
embassy O
to O
various O
email O
recipients O
connected O
to O
the O
Indian O
Ministry O
of O
External O
Affairs O
( O
MEA O
) O
. O

This O
time O
the O
email O
was O
made O
to O
look O
like O
an O
investigation O
report O
related O
to O
Jammu O
& O
Kashmir O
protest O
was O
shared O
by O
the O
Ministry O
of O
Home O
Affairs O
Official O
and O
the O
forwarded O
email O
was O
made O
to O
look O
like O
the O
report O
was O
forwarded O
by O
an O
Ambassador O
in O
Thailand O
Indian O
embassy O
to O
the O
MEA O
officials I-Organization
. O

From O
the O
emails B-Vulnerability
( O
and O
the O
attachments O
) O
it O
looks O
like O
the O
goal O
of O
the O
attackers B-Organization
was O
to O
infect O
and O
take O
control O
of O
the O
systems O
and O
also O
to O
spy O
on O
the O
actions O
of O
the O
Indian O
Government O
post O
the O
Jammu O
& O
Kashmir O
protest O
and O
Uri O
Terror O
attack O
. O

When O
the O
victim O
opens O
the O
attached O
word O
document O
it O
prompts O
the O
user O
to O
enable O
macro O
content O
and O
both O
the O
documents O
( O
Uri O
Terror O
Report.doc O
and O
mha-report.doc O
) O
displayed O
the O
same O
content O
and O
contained O
a O
Show O
Document O
button O
. O

In O
case O
of O
both O
the O
documents B-Malware
( O
Uri O
Terror O
Report.doc O
and O
mha-report.doc O
) O
the O
malicious O
macro O
code O
was O
heavily O
obfuscated O
(used O
obscure O
variable/function O
names O
to O
make O
analysis O
harder O
) O
and O
did O
not O
contain O
any O
auto O
execute O
functions O
. O

Malicious O
activity O
is O
trigged O
only O
on O
user O
interaction O
, O
attackers O
normally O
use O
this O
technique O
to O
bypass O
sandbox/automated O
analysis O
. O

Reverse O
engineering O
both O
the O
word O
documents O
( O
Uri O
Terror O
Report.doc O
& O
mha-report.doc O
) O
exhibited O
similar O
behaviour O
except O
the O
minor O
difference O
mentioned O
below O
. O

In O
case O
of O
mha-report.doc O
the O
malicious O
activity O
triggered O
only O
when O
the O
show O
document O
button O
was O
clicked O
, O
when O
this O
event O
occurs O
the O
macro O
code O
calls O
a O
subroutine O
CommandButton1_Click() O
which O
in O
turn O
calls O
a O
malicious O
obfuscated O
function O
( O
Bulbaknopka() O
) O
. O

In O
case O
of O
Uri O
Terror O
Report.doc O
the O
malicious O
activity O
triggered O
when O
the O
document O
was O
either O
closed O
or O
when O
the O
show O
document O
button O
was O
clicked O
, O
when O
any O
of O
these O
event O
occurs O
a O
malicious O
obfuscated O
function O
( O
chugnnarabashkoim() O
) O
gets O
called O
. O

The O
malicious O
macro O
code O
first O
decodes O
a O
string O
which O
contains O
a O
reference O
to O
the O
pastebin O
url O
. O

The O
macro O
then O
decodes O
a O
PowerShell B-System
script I-Malware
which O
downloads O
base64 O
encoded O
content O
from O
the O
pastebin O
url O
. O

The O
base64 O
encoded O
content O
downloaded O
from O
the O
Pastebin O
link O
is O
then O
decoded O
to O
an O
executable O
and O
dropped O
on O
the O
system O
. O

The O
technique O
of O
hosting O
malicious O
code O
in O
legitimate O
sites O
like O
Pastebin O
has O
advantages O
and O
it O
is O
highly O
unlikely O
to O
trigger O
any O
suspicion O
in O
security O
monitoring O
and O
also O
can O
bypass O
reputation O
based O
devices O
. O

The O
dropped O
file O
was O
determined O
as O
modified O
version O
of O
njRAT B-System
trojan I-System
. O

The O
dropped O
file O
( O
officeupdate.exe O
) O
is O
then O
executed O
by O
the O
macro O
code O
using O
the O
PowerShell B-System
script I-System
. O

njRAT B-Malware
is O
a O
Remote B-System
Access I-System
Tool I-System
( O
RAT B-System
) O
used O
mostly O
by O
the O
actor B-Organization
groups I-Organization
in O
the O
middle O
east O
. O

Once O
infected O
njRAT B-System
communicates O
to O
the O
attacker O
and O
allows O
the O
attacker O
to O
log O
keystrokes O
, O
upload/download O
files O
, O
access O
victims O
web O
camera O
, O
audio O
recording O
, O
steal O
credentials O
, O
view O
victims O
desktop O
, O
open O
reverse O
shell O
etc O
. O

The O
dropped O
file O
was O
analyzed O
in O
an O
isolated O
environment O
( O
without O
actually O
allowing O
it O
to O
connect O
to O
the O
c2 O
server O
) O
. O

Once O
the O
dropped O
file O
( O
officeupdate.exe O
) O
is O
executed O
the O
malware O
drops O
additional O
files O
( O
googleupdate.exe O
, O
malib.dll O
and O
msccvs.dll O
) O
into O
the O
%AllUsersProfile%\Google O
directory O
and O
then O
executes O
the O
dropped O
googleupdate.exe O
Upon O
execution O
malware O
makes O
a O
connection O
to O
the O
c2 O
server O
on O
port O
5555 O
and O
sends O
the O
system O
& O
operating O
system O
information O
along O
with O
some O
base64 O
encoded O
strings O
to O
the O
attacker O
as O
shown O
below O
. O

This O
section O
contains O
the O
details O
of O
the O
c2 O
domain O
( O
khanji.ddns.net O
) O
. O

Attackers B-Organization
used O
the O
DynamicDNS O
to O
host O
the O
c2 O
server O
, O
this O
allows O
the O
attacker O
to O
quickly O
change O
the O
IP O
address O
in O
real O
time O
if O
the O
malware O
c2 O
server O
infrastructure O
is O
unavailable O
. O

The O
c2 O
domain O
was O
associated O
with O
multiple O
IP O
addresses O
in O
past O
. O

During O
the O
timeline O
of O
this O
cyber O
attack O
most O
of O
these O
IP O
addresses O
were O
located O
in O
Pakistan O
and O
few O
IP O
addresses O
used O
the O
hosting O
provider O
infrastructure O
. O

The O
c2 O
domain O
( O
khanji.ddns.net O
) O
was O
also O
found O
to O
be O
associated O
with O
multiple O
malware O
samples O
in O
the O
past O
, O
Some O
of O
these O
malware O
samples O
made O
connection O
to O
pastebin O
urls O
upon O
execution O
, O
which O
is O
similar O
to O
the O
behavior O
mentioned O
previously O
. O

Based O
on O
the O
base64 O
encoded O
content O
posted O
in O
the O
Pastebin O
, O
userid O
associated O
with O
the O
Pastebin O
post O
was O
determined O
. O

The O
same O
user O
posted O
multiple O
similar O
posts O
most O
of O
them O
containing O
similar O
base64 O
encoded O
content O
( O
probably O
used O
by O
the O
malwares O
in O
other O
campaigns O
to O
decode O
and O
drop O
malware O
executable O
) O
, O
these O
posts O
were O
made O
between O
July O
21st O
, O
2016 O
to O
September O
30 O
, O
2016 O
. O

Below O
screen O
shot O
shows O
the O
posts O
made O
by O
the O
user O
, O
the O
hits O
column O
in O
the O
below O
screen O
shot O
gives O
an O
idea O
of O
number O
of O
times O
the O
links O
were O
visited O
( O
probably O
by O
the O
malicious O
macro O
code O
) O
, O
this O
can O
give O
rough O
idea O
of O
the O
number O
of O
users O
who O
are O
probably O
infected O
as O
a O
result O
of O
opening O
the O
malicious O
document I-Malware
. O

Doing O
a O
Google B-Organization
search I-System
for O
the O
Pastebin O
userid O
landed O
me O
on O
a O
YouTube O
video O
posted O
by O
an O
individual O
demonstrating O
his O
modified O
version O
of O
njRAT B-System
control O
panel/builder O
kit O
. O

The O
Pastebin O
userid O
matched O
with O
the O
email O
ID O
mentioned O
by O
this O
individual O
in O
the O
YouTube O
video O
description O
section O
. O

This O
same O
keyword O
was O
also O
found O
in O
the O
njRAT B-Malware
c2 O
communication O
used O
in O
this O
attack O
. O

After O
inspecting O
the O
njRAT B-Malware
builder O
kit O
it O
was O
determined O
that O
this O
individual O
customized O
the O
existing O
njRAT B-Malware
builder O
kit O
to O
bypass O
security O
products O
. O

The O
product O
information O
in O
the O
builder O
kit O
matched O
with O
this O
individual O
’s O
YouTube O
username O
and O
the O
YouTube O
channel O
. O

The O
njRAT B-System
used O
in O
this O
cyber O
attack O
was O
built O
from O
this O
builder O
kit O
. O

Based O
on O
this O
information O
it O
can O
be O
concluded O
that O
espionage O
actors O
used O
this O
individual O
’s O
modified O
version O
of O
njRAT B-Malware
in O
this O
cyber O
attack O
. O

Even O
though O
this O
individual O
’s O
email O
id O
matched O
with O
the O
Pastebin O
id O
where O
base64 O
encoded O
malicious O
code O
was O
found O
, O
it O
is O
hard O
to O
say O
if O
this O
individual O
was O
or O
was O
not O
involved O
in O
this O
cyber O
attack O
. O

It O
could O
be O
possible O
that O
the O
espionage O
actors O
used O
his O
public O
identity O
as O
a O
diversion O
to O
mislead O
and O
to O
hide O
the O
real O
identity O
of O
the O
attackers B-Organization
or O
it O
is O
also O
possible O
that O
this O
individual O
was O
hired O
to O
carry O
out O
the O
attack O
. O

The O
indicators O
are O
provided O
below O
, O
these O
indicators O
can O
be O
used O
by O
the O
organizations B-Organization
( O
Government O
, O
Public B-Organization
and O
Private B-Organization
organizations I-Organization
) O
to O
detect O
and O
investigate O
this O
attack O
campaign O
. O

14b9d54f07f3facf1240c5ba89aa2410 O
( O
googleupdate.exe O
) O
. O

2b0bd7e43c1f98f9db804011a54c11d6 O
( O
malib.dll O
) O
. O

feec4b571756e8c015c884cb5441166b O
( O
msccvs.dll O
) O
. O

84d9d0524e14d9ab5f88bbce6d2d2582 O
( O
officeupdate.exe O
) O
. O

khanji.ddns.net O
139.190.6.180 O
39.40.141.25 O
175.110.165.110 O
39.40.44.245 O
39.40.67.219 O
. O

http://pastebin.com/raw/5j4hc8gT O
http://pastebin.com/raw/6bwniBtB O
. O

028caf3b1f5174ae092ecf435c1fccc2 O
7732d5349a0cfa1c3e4bcfa0c06949e4 O
9909f8558209449348a817f297429a48 O
63698ddbdff5be7d5a7ba7f31d0d592c O
7c4e60685203b229a41ae65eba1a0e10 O
e2112439121f8ba9164668f54ca1c6af O
. O

Attackers B-Organization
in O
this O
case O
made O
every O
attempt O
to O
launch O
a O
clever O
attack O
campaign O
by O
spoofing O
legitimate O
email O
ids O
and O
using O
an O
email O
theme O
relevant O
to O
the O
targets O
. O

The O
following O
factors O
in O
this O
cyber O
attack O
suggests O
the O
possible O
involvement O
of O
Pakistan O
state O
sponsored O
cyber O
espionage I-Organization
group I-Organization
to O
mainly O
spy O
on O
India O
’s O
actions O
related O
to O
these O
Geo-political O
events O
( O
Uri O
terror O
attack O
and O
Jammu O
& O
Kashmir O
protests O
) O
. O

Victims/targets O
chosen O
( O
Indian O
Embassy O
and O
Indian O
MEA O
officals O
) O
. O

Use O
of O
email O
theme O
related O
to O
the O
Geo-political O
events O
that O
is O
of O
interest O
to O
the O
targets O
. O

Timing O
of O
the O
spear B-Vulnerability
phishing I-Vulnerability
emails I-Vulnerability
sent O
to O
the O
victims O
. O

Location O
of O
the O
c2 O
infrastructure O
. O

Use O
of O
malware O
that O
is O
capable O
of O
spying O
on O
infected O
systems O
. O

The O
following O
factors O
show O
the O
level O
of O
sophistication O
and O
reveals O
the O
attackers O
intention O
to O
remain O
stealthy O
and O
to O
gain O
long-term O
access O
by O
evading O
anti-virus O
, O
sandbox O
and O
security O
monitoring O
at O
both O
the O
desktop O
and O
network O
levels O
. O

Use O
of O
obfuscated O
malicious O
macro O
code O
. O

Use O
of O
macro O
code O
that O
triggers O
only O
on O
user O
intervention O
( O
to O
bypass O
sandbox O
analysis O
) O
. O

Use O
of O
legitimate O
site O
( O
Pastebin O
) O
to O
host O
malicious O
code O
( O
to O
bypass O
security O
monitoring O
) O
. O

Use O
of O
customized B-System
njRAT I-System
( O
capable O
of O
evading O
anti-virus O
) O
. O

The O
Curious O
Case O
of O
Notepad O
and O
Chthonic O
: O
Exposing O
a O
Malicious O
Infrastructure O
. O

Recently O
, O
I O
’ve O
been O
investigating O
malware O
utilizing O
PowerShell B-System
and O
have O
spent O
a O
considerable O
amount O
of O
time O
refining O
ways O
to O
identify O
new O
variants O
of O
attacks O
as O
they O
appear O
. O

This O
posting O
is O
a O
follow-up O
of O
my O
previous O
work O
on O
this O
subject O
in O
“ O
Pulling O
Back O
the O
Curtains O
on O
EncodedCommand O
PowerShell O
Attacks O
” O
. O

In O
a O
sample O
I O
recently O
analyzed O
, O
something O
stood O
out O
as O
extremely O
suspicious O
which O
led O
me O
down O
a O
rabbit O
hole O
, O
uncovering O
malicious O
infrastructure O
supporting O
Chthonic O
, O
Nymaim O
, O
and O
other O
malware O
and O
malicious O
websites O
. O

Throughout O
this O
blog O
post O
I O
present O
my O
analysis O
and O
thought O
process O
during O
this O
research O
, O
but O
if O
you O
would O
just O
like O
a O
list O
of O
the O
findings O
, O
they O
are O
over O
on O
our O
Unit42 B-Organization
GitHub I-Organization
. O

Most O
commonly O
, O
PowerShell B-System
is O
launched O
from O
a O
Microsoft B-Malware
Office I-Malware
document I-Malware
that O
uses O
a O
VBA B-System
macro O
to O
launch O
PowerShell B-System
to O
perform O
something O
malicious O
– O
typically O
downloading O
the O
“ O
real O
” O
malware O
to O
run O
. O

I O
focused O
my O
hunting O
on O
the O
PowerShell O
activity O
with O
Palo B-Organization
Alto I-Organization
Networks I-Organization
AutoFocus I-Organization
to O
determine O
whether O
it O
’s O
worth O
digging O
into O
further O
based O
on O
“ O
uniqueness O
” O
and O
functionality O
. O

In O
this O
case O
, O
the O
first O
sample O
I O
looked O
at O
stood O
out O
for O
another O
reason O
entirely O
. O

If O
you O
take O
a O
look O
at O
the O
below O
PowerShell O
, O
you O
’ll O
quickly O
understand O
why O
. O

Most O
commonly O
, O
PowerShell B-System
is O
launched O
from O
a O
Microsoft B-Malware
Office I-Malware
document I-Malware
that O
uses O
a O
VBA B-System
macro O
to O
launch O
PowerShell B-System
to O
perform O
something O
malicious O
– O
typically O
downloading O
the O
“ O
real O
” O
malware O
to O
run O
. O

I O
focused O
my O
hunting O
on O
the O
PowerShell O
activity O
with O
Palo B-Organization
Alto I-Organization
Networks I-Organization
AutoFocus I-Organization
to O
determine O
whether O
it O
’s O
worth O
digging O
into O
further O
based O
on O
“ O
uniqueness O
” O
and O
functionality O
. O

My O
initial O
thought O
was O
the O
worst-case O
scenario O
– O
they O
’ve O
been O
compromised O
and O
are O
distributing O
malware O
! O
I O
immediately O
downloaded O
the O
file O
from O
the O
website O
, O
but O
everything O
looked O
normal O
. O

Of O
course O
, O
I O
had O
to O
investigate O
further O
. O

Looking O
under O
the O
hood O
we O
see O
the O
VBA O
code O
that O
builds O
the O
PowerShell O
command O
and O
launches O
it O
but O
something O
seemed O
off O
. O

There O
are O
a O
ton O
of O
functions O
that O
are O
clearly O
decoding O
information O
from O
arrays O
after O
which O
it O
executes O
an O
already O
decoded O
PowerShell O
command O
. O

I O
decided O
to O
debug O
the O
macro O
and O
see O
exactly O
what O
it O
’s O
doing O
before O
I O
made O
any O
decisions O
. O

The O
most O
likely O
conclusion O
that O
can O
be O
drawn O
here O
is O
that O
an O
analyst O
or O
researcher O
obtained O
this O
file O
, O
modified O
it O
to O
see O
the O
content O
( O
misspelling O
the O
variable O
name O
along O
the O
way O
) O
post-decoding O
, O
and O
uploaded O
it O
to O
see O
what O
it O
did O
in O
a O
sandbox O
. O

To O
be O
sure O
though O
, O
I O
needed O
to O
find O
other O
samples O
and O
see O
how O
they O
stacked O
up O
against O
this O
one O
. O

Going B-Organization
back O
to O
the O
PowerShell B-System
command O
, O
the O
initial O
reason O
I O
stopped O
to O
look O
at O
it O
was O
due O
to O
the O
way O
they O
concatenated O
variables O
to O
form O
the O
download O
command O
and O
output O
. O

This O
also O
provides O
a O
perfect O
pivot O
point O
to O
hunt O
for O
samples O
. O

The O
dates O
were O
all O
fairly O
recent O
, O
having O
been O
received O
in O
the O
past O
few O
days O
since O
the O
beginning O
of O
August O
. O

The O
documents O
shared O
the O
same O
themes O
for O
lures O
but O
the O
VBA B-System
macro I-System
and O
resulting O
PowerShell O
were O
more O
along O
the O
lines O
of O
what O
I O
expected O
. O

For O
sample O
“ O
538ff577a80748d87b5e738e95c8edd2bd54ea406fe3a75bf452714b17528a87 O
” O
the O
following O
is O
an O
excerpt O
from O
the O
VBA O
macro O
building O
the O
PowerShell B-System
command O
. O

Along O
with O
the O
subsequent O
Process O
Activity O
using O
the O
newly O
built O
PowerShell B-System
command I-System
, O
which O
aligns O
with O
what O
was O
commented O
out O
of O
the O
first O
sample O
analyzed O
. O

Given O
this O
, O
I O
iterated O
over O
all O
171 O
samples O
and O
extracted O
the O
following O
URL O
’s O
where O
PowerShell O
is O
downloading O
a O
payload O
: O
http://ditetec.com O
http://ditetec.com O
http://domass.com.ua O
http://firop.com O
http://unoset.com O
http://unoset.com O
https://doci.download O
https://farhenzel.co O
https://farsonka.co O
https://formsonat.co O
https://fortuma.co O
https://iilliiill.bid O
https://iilliiill.bid O
https://iilliiill.bid O
https://lom.party O
https://naiillad.date O
https://naiillad.date O
https://naiillad.date O
https://naiillad.date O
https://notepad-plus-plus.org/repository O
https://prof.cricket O
https://tvavi.win O
. O

After O
iterating O
over O
the O
171 O
samples O
, O
we O
’re O
left O
with O
this O
list O
of O
hashes O
for O
the O
downloaded O
files O
. O

Note O
that O
there O
are O
fewer O
payloads O
than O
there O
are O
samples O
, O
indicating O
many O
of O
the O
documents O
download O
the O
same O
payload O
. O

Below O
is O
a O
table O
with O
the O
compile O
date O
and O
some O
PDB O
strings O
found O
within O
a O
few O
of O
the O
binaries O
. O

Most O
of O
the O
compile O
times O
are O
within O
the O
past O
two O
months O
, O
with O
6 O
in O
August O
and O
a O
couple O
from O
as O
recently O
as O
two O
days O
ago O
at O
the O
time O
of O
this O
writing O
. O

29c7740f487a461a96fad1c8db3921ccca8cc3e7548d44016da64cf402a475ad O
2016-12-10 O
01 O
. O

d5e56b9b5f52293b209a60c2ccd0ade6c883f9d3ec09571a336a3a4d4c79134b O
2016-12-10 O
03 O
C:\RAMDrive\Charles\heaven\reams\Teac.pdb O
. O

dd5f237153856d19cf20e80ff8238ca42047113c44fae27b5c3ad00be2755eea O
2016-12-10 O
16 O
C:\Cleaner\amuse\rang\AutoPopulate\la.pdb O
. O

a5001e9b29078f532b1a094c8c16226d20c03922e37a4fca2e9172350bc160a0 O
2016-12-20 O
18 O
. O

8284ec768a06b606044defe2c2da708ca6b3b51f8e58cb66f61bfca56157bc88 O
2017-07-05 O
10 O
. O

f0ce51eb0e6c33fdb8e1ccb36b9f42139c1dfc58d243195aedc869c7551a5f89 O
2017-07-09 O
20 O
C:\TableAdapter\encyclopedia\Parik.pdb O
. O

145d47f4c79206c6c9f74b0ab76c33ad0fd40ac6724b4fac6f06afec47b307c6 O
2017-07-10 O
08 O
C:\ayakhnin\reprductive\distortedc.pdb O
. O

dc8f34829d5fede991b478cf9117fb18c32d639573a827227b2fc50f0b475085 O
2017-07-11 O
01 O
C:\positioning\scrapping\Szets\thi.pdb O
. O

7fe1069c118611113b4e34685e7ee58cb469bda4aa66a22db10842c95f332c77 O
2017-07-11 O
02 O
C:\NeXT\volatile\legacyExchangeDNs.pdb O
. O

5edf117e7f8cd176b1efd0b5fd40c6cd530699e7a280c5c7113d06e9c21d6976 O
2017-07-12 O
23 O
. O

2a80fdda87127bdc56fd35c3e04eb64a01a159b7b574177e2e346439c97b770a O
2017-07-13 O
00. O
a9021e253ae52122cbcc2284b88270ceda8ad9647515d6cca96db264a76583f5 O
2017-07-18 O
00 O
. O

dd639d76ff6f33bbfaf3bd398056cf4e95e27822bd9476340c7703f5b38e0183 O
2017-07-18 O
00 O
. O

e5a00b49d4ab3e5a3a8f60278b9295f3d252e3e04dadec2624bb4dcb2eb0fada O
2017-07-24 O
17 O
. O

6263730ef54fbed0c2d3a7c6106b6e8b12a6b2855a03e7caa8fb184ed1eabeb2 O
2017-07-24 O
22 O
C:\Snapshot\Diskette\hiding\ROCKMA.pdb O
. O

43bfaf9a2a4d46695bb313a32d88586c510d040844f29852c755845a5a09d9df O
2017-07-25 O
06 O
. O

b41660db6dcb0d3c7b17f98eae3141924c8c0ee980501ce541b42dc766f85628 O
2017-07-25 O
06 O
C:\mdb\Changed\Container\praise.pdb O
. O

9acdad02ca8ded6043ab52b4a7fb2baac3a08c9f978ce9da2eb51c816a9e7a2e O
2017-07-25 O
07 O
. O

2ddaa30ba3c3e625e21eb7ce7b93671ad53326ef8b6e2bc20bc0d2de72a3929d O
2017-07-25 O
20 O
C:\helpers\better\Expr\Eight\DS.pdb O
. O

b836576877b2fcb3cacec370e5e6a029431f59d5070da89d94200619641ca0c4 O
2017-07-26 O
12 O
C:\V\regard\violates\update\AMBW\a.pdb O
. O

0972fc9602b00595e1022d9cfe7e9c9530d4e9adb5786fea830324b3f7ff4448 O
2017-07-26 O
20 O
. O

2c258ac862d5e31d8921b64cfa7e5a9cd95cca5643c9d51db4c2fcbe75fa957a O
2017-07-27 O
01 O
C:\executablery\constructed\IIc.pdb O
. O

dd9c558ba58ac81a2142ecb308ac8d0f044c7059a039d2e367024d953cd14a00 O
2017-07-27 O
02 O
. O

cb3173a820ac392005de650bbd1dd24543a91e72d4d56300a7795e887a8323b2 O
2017-07-31 O
14 O
C:\letterbxing\EVP\Chices\legit.pdb O
. O

a636f49814ea6603534f780b83a5d0388f5a5d0eb848901e1e1bf2d19dd84f05 O
2017-07-31 O
18 O
C:\Biomuse\moment\705\cnvincing.pdb O
. O

677dd11912a0f13311d025f88caabeeeb1bda27c7c1b5c78cffca36de46e8560 O
2017-07-31 O
21 O
. O

fdedf0f90d42d3779b07951d1e8826c7015b3f3e724ab89e350c9608e1f23852 O
2017-08-01 O
21 O
. O

142bf7f47bfbd592583fbcfa22a25462df13da46451b17bb984d50ade68a5b17 O
2017-08-02 O
09 O
. O

6f4b2c95b1a0f320da1b1eaa918c338c0bab5cddabe169f12ee734243ed8bba8 O
2017-08-02 O
12 O
C:\cataloging\Dr\VarianceShadows11.pdb O
. O

fd5fd7058cf157ea249d4dcba71331f0041b7cf8fd635f37ad13aed1b06bebf2 O
2017-08-04 O
02 O
C:\dumplings\That\BIT\Warez\loc.pdb O
. O

5785c2d68d6f669b96c3f31065f0d9804d2ab1f333a90d225bd993e66656b7d9 O
2017-08-07 O
12 O
C:\Lgisys\hypothesized\donatedc.pdb O
. O

675719a9366386034c285e99bf33a1a8bafc7644874b758f307d9a288e95bdbd O
2017-08-07 O
17 O
C:\work\cr\nata\cpp\seven\seven\release\seven.pdb O
. O

At O
least O
one O
of O
the O
binaries O
compiled O
in O
August O
had O
a O
PDB O
string O
I O
was O
able O
to O
locate O
online O
in O
a O
collection O
of O
other O
PDB O
files O
, O
so O
they O
may O
be O
introducing O
their O
malicious O
code O
into O
these O
files O
before O
compiling O
someone O
else O
’s O
project O
. O

Once O
the O
file O
has O
been O
downloaded O
and O
executed O
, O
the O
new O
process O
will O
launch O
a O
legitimate O
executable O
, O
such O
as O
“ O
msiexec.exe O
” O
, O
and O
inject O
code O
into O
it O
. O

This O
code O
will O
then O
download O
further O
payloads O
through O
a O
POST O
request O
to O
various O
websites O
. O

This O
pattern O
is O
shared O
across O
the O
original O
samples O
. O

These O
HTTP O
requests O
match O
known O
patterns O
for O
a O
banking O
Trojan I-System
named O
Chthonic O
, O
which O
is O
a O
variant O
of O
Zeus O
. O

A O
good O
write-up O
from O
2014 O
on O
the O
malware O
can O
be O
found O
in O
this O
writeup O
from O
Yury O
Namestnikov O
, O
Vladimir O
Kuskov O
, O
Oleg O
Kupreev O
at O
Kaspersky B-Organization
Lab I-Organization
here O
and O
indicates O
that O
the O
returned O
data O
is O
an O
RC4 O
encrypted O
loader O
that O
sets-up O
the O
main O
Chthonic O
module O
which O
can O
download O
additional O
modules O
or O
malware O
. O

Iterating O
once O
again O
over O
the O
171 O
samples O
and O
scraping O
out O
the O
HTTP O
POST O
requests O
, O
I O
ended O
up O
with O
the O
below O
set O
of O
domains O
: O
amellet.bit O
danrnysvp.com O
ejtmjealr.com O
firop.com O
gefinsioje.com O
gesofgamd.com O
ponedobla.bit O
unoset.com O
. O

Using O
this O
as O
the O
next O
pivot O
, O
we O
have O
6,034 O
unique O
samples O
that O
get O
returned O
in O
AutoFocus O
having O
made O
POST O
requests O
to O
these O
sites O
. O

Additionally O
, O
we O
can O
see O
there O
were O
at O
least O
3 O
very O
large O
campaigns O
where O
Palo B-Organization
Alto I-Organization
Networks I-Organization
saw O
activity O
to O
these O
sites O
in O
July O
. O

From O
these O
distribution O
sites O
, O
we O
can O
see O
that O
5,520 O
samples O
are O
making O
HTTP O
requests O
to O
them O
and O
these O
samples O
have O
been O
identified O
as O
another O
downloader O
Trojan I-System
named O
Nymaim O
. O

The O
majority O
of O
the O
overall O
samples O
came O
from O
the O
following O
four O
sites O
: O
ejtmjealr.com O
gefinsioje.com O
gesofgamd.com O
ponedobla.bit O
. O

The O
‘ O
ejtmjealr.com O
’ O
domain O
is O
particularly O
interesting O
due O
to O
a O
similar O
domain O
, O
‘ O
ejdqzkd.com O
’ O
being O
discussed O
by O
Jarosław O
Jedynak O
of O
CERT.PL O
in O
this O
analysis O
of O
Nymaim O
from O
earlier O
in O
the O
year O
. O

They O
go O
on O
to O
discuss O
how O
Nymaim O
uses O
a O
static O
configuration O
to O
contact O
that O
domain O
, O
which O
will O
return O
IP O
’s O
that O
go O
into O
a O
DGA O
and O
output O
the O
actual O
IP O
addresses O
needed O
for O
C2 O
communication O
. O

Ben O
Baker O
, O
Edmund O
Brumaghin O
and O
Jonah O
Samost O
of O
Talos B-Organization
have O
a O
fantastic O
write-up O
of O
this O
process O
here O
. O

To O
continue O
my O
analysis O
, O
I O
shifted O
focus O
to O
Maltego O
so O
as O
to O
visually O
graph O
the O
infrastructure O
. O

For O
this O
task O
, O
I O
used O
PassiveTotal O
’s O
Passive O
DNS O
and O
AutoFocus B-System
Maltego O
transforms O
. O

Pivoting O
off O
the O
five O
highlighted O
IP O
’s O
above O
with O
a O
shared O
infrastructure O
, O
I O
pulled O
the O
reverse O
DNS O
to O
see O
what O
other O
sites O
may O
be O
present O
. O

The O
“ O
idXXXXX.top O
” O
pattern O
immediately O
stands O
out O
and O
may O
suggest O
a O
pattern O
in O
the O
static O
configuration O
for O
the O
initial O
domains O
used O
by O
the O
DGA O
for O
Nymaim O
since O
the O
previous O
two O
started O
with O
“ O
ejX.com O
. O

Given O
the O
level O
of O
overlap O
already O
, O
I O
proceeded O
to O
grab O
all O
of O
the O
passive O
DNS O
available O
for O
each O
of O
the O
707 O
IP O
addresses O
. O

A O
full O
list O
of O
the O
domains O
can O
be O
seen O
here O
. O

From O
the O
first O
cluster O
on O
the O
left O
, O
if O
we O
sort O
by O
incoming O
links O
per O
node O
a O
pattern O
stands O
out O
in O
the O
domain O
names O
looking O
similar O
to O
the O
previously O
mentioned O
Nymaim O
ones O
. O

A O
quick O
search O
with O
the O
AutoFocus O
transform O
to O
pull O
tag O
information O
shows O
these O
are O
specifically O
related O
to O
Nymaim O
, O
most O
likely O
for O
the O
DGA O
seed O
; O
however O
, O
looking O
at O
domains O
with O
less O
links O
, O
other O
malware O
families O
begin O
to O
emerge O
. O

The O
cluster O
on O
the O
right O
is O
actually O
collapsing O
one O
collection O
of O
entities O
due O
to O
the O
sheer O
size O
of O
it O
. O

All O
of O
these O
connected O
domains O
follow O
a O
pattern O
similar O
to O
phishing O
attacks O
masquerading O
as O
legitimate O
services O
– O
in O
this O
case O
“ O
online.verify.paypal O
” O
( O
588 O
) O
and O
“ O
hmrc.secure.refund O
” O
( O
1021 O
) O
. O

In O
addition O
to O
domains O
of O
that O
type O
, O
there O
is O
evidence O
of O
other O
malware O
distribution O
being O
carried O
out O
on O
this O
infrastructure O
. O

Collapsing O
the O
collection O
back O
down O
, O
note O
the O
two O
domains O
“ O
brontorittoozzo.com O
” O
and O
“ O
randomessstioprottoy.net O
” O
that O
fall O
outside O
of O
the O
collection O
due O
to O
more O
infrastructure O
connections O
. O

By O
pivoting O
off O
of O
one O
sample O
we O
were O
able O
to O
zoom O
out O
and O
identify O
a O
sizable O
infrastructure O
of O
what O
appears O
to O
be O
707 O
IP O
’s O
and O
2,611 O
domains O
being O
utilized O
for O
malicious O
activity O
. O

As O
such O
, O
these O
findings O
represent O
a O
collection O
of O
compromised O
websites I-System
, O
compromised O
registrar I-System
accounts O
used O
to O
spin O
up O
subdomains O
, O
domains O
used O
by O
malware O
DGA O
’s O
, O
phishing B-Vulnerability
kits O
, O
carding O
forums O
, O
malware O
C2 O
sites O
, O
and O
a O
slew O
of O
other O
domains O
that O
revolve O
around O
criminal O
activity O
. O

Hopefully O
this O
analysis O
has O
been O
helpful O
in O
understanding O
how O
truly O
connected O
some O
of O
these O
infrastructures O
can O
be O
and O
how O
with O
a O
little O
digging O
, O
you O
can O
uncover O
a O
substantial O
amount O
of O
operationally O
useful O
indicators O
to O
protect O
you O
and O
yours O
. O

The O
Full O
Shamoon O
: O
How O
the O
Devastating O
Malware O
Was O
Inserted O
Into O
Networks O
. O

Researchers O
from O
the O
IBM B-Organization
X-Force I-Organization
Incident I-Organization
Response O
and O
Intelligence B-Organization
Services I-Organization
( O
IRIS B-Organization
) O
team O
identified O
a O
missing O
link O
in O
the O
operations O
of O
a O
threat O
actor O
involved O
in O
recent O
Shamoon O
malware O
attacks O
against O
Gulf O
state O
organizations O
. O

These O
attacks O
, O
which O
occurred O
in O
November O
2016 O
and O
January O
2017 O
, O
reportedly O
affected O
thousands O
of O
computers O
across O
multiple O
government B-Organization
and O
civil B-Organization
organizations I-Organization
in O
Saudi O
Arabia O
and O
elsewhere O
in O
Gulf O
states O
. O

Shamoon O
is O
designed O
to O
destroy O
computer O
hard O
drives O
by O
wiping O
the O
master O
boot O
record O
( O
MBR O
) O
and O
data O
irretrievably O
, O
unlike O
ransomware O
, O
which O
holds O
the O
data O
hostage O
for O
a O
fee O
. O

Through O
their O
recent O
investigations O
, O
our O
forensics O
analysts O
pinpointed O
the O
initial O
compromise O
vector O
and O
post-compromise O
operations O
that O
led O
to O
the O
deployment O
of O
the O
destructive O
Shamoon O
malware O
on O
targeted O
infrastructures O
. O

It O
’s O
worth O
mentioning O
that O
, O
according O
to O
X-Force B-Organization
IRIS I-Organization
, O
the O
initial O
compromise O
took O
place O
weeks O
before O
the O
actual O
Shamoon O
deployment O
and O
activation O
were O
launched O
. O

Since O
Shamoon O
incidents O
feature O
the O
infiltration O
and O
escalation O
stages O
of O
targeted O
attacks O
, O
X-Force B-Organization
IRIS I-Organization
responders O
sought O
out O
the O
attackers B-Organization
’ O
entry O
point O
. O

Their O
findings O
pointed O
to O
what O
appears O
to O
be O
the O
initial O
point O
of O
compromise O
the O
attackers B-Organization
used O
: O
a O
document O
containing O
a O
malicious O
macro O
that O
, O
when O
approved O
to O
execute O
, O
enabled O
C2 O
communications O
to O
the O
attacker O
’s O
server O
and O
remote O
shell O
via O
PowerShell B-System
. O

The O
document B-Malware
was O
not O
the O
only O
one O
discovered O
in O
the O
recent O
attack O
waves O
. O

X-Force B-Organization
IRIS I-Organization
researchers O
had O
been O
tracking O
earlier O
activity O
associated O
with O
similar O
malicious O
, O
PowerShell-laden O
documents O
themed O
as O
resumes O
and O
human O
resources O
documents O
, O
some O
of O
which O
related O
to O
organizations O
in O
Saudi O
Arabia O
. O

This O
research O
identified O
several O
bouts O
of O
offensive O
activity O
that O
occurred O
in O
the O
past O
few O
months O
, O
which O
revealed O
similar O
operational O
methods O
in O
which O
the O
attackers O
served O
malicious O
documents I-Malware
and O
other O
malware O
executables O
from O
web O
servers O
to O
their O
targets O
to O
establish O
an O
initial O
foothold O
in O
the O
network O
. O

Although O
Shamoon O
was O
previously O
documented O
in O
research O
blogs O
, O
the O
specific O
network O
compromise O
methods O
leading O
to O
the O
attacks O
have O
remained O
unclear O
in O
the O
reported O
cases O
. O

X-Force B-Organization
IRIS I-Organization
researchers O
studied O
Shamoon B-Organization
’s O
attack O
life O
cycle O
and O
observed O
its O
tactics O
at O
Saudi-based O
organizations O
and O
private O
sector I-Organization
companies I-Organization
. O

This O
research O
led O
them O
to O
believe O
that O
the O
actor B-Organization
using O
Shamoon O
in O
recent O
attacks O
relied O
heavily O
on O
weaponized O
documents O
built O
to O
leverage O
PowerShell B-System
to O
establish O
their O
initial O
network O
foothold O
and O
subsequent O
operations O
: O
Attackers O
send O
a O
spear B-Vulnerability
phishing I-Vulnerability
email I-Vulnerability
to O
employees O
at O
the O
target O
organization O
. O

The O
email O
contains O
a O
Microsoft B-Malware
Office I-Malware
document I-Malware
as O
an O
attachment O
. O

Opening O
the O
attachment O
from O
the O
email O
invokes O
PowerShell O
and O
enables O
command O
line O
access O
to O
the O
compromised O
machine O
. O

Attackers B-Organization
can O
now O
communicate O
with O
the O
compromised O
machine O
and O
remotely O
execute O
commands O
on O
it O
. O

The O
attackers B-Organization
use O
their O
access O
to O
deploy O
additional O
tools O
and O
malware O
to O
other O
endpoints O
or O
escalate O
privileges O
in O
the O
network O
. O

Attackers B-Organization
study O
the O
network O
by O
connecting O
to O
additional O
systems O
and O
locating O
critical O
servers O
. O

The O
attackers O
deploy O
the O
Shamoon B-System
malware I-System
. O

A O
coordinated O
Shamoon O
outbreak O
begins O
and O
computer O
hard O
drives O
across O
the O
organization O
are O
permanently O
wiped O
. O

X-Force B-Organization
IRIS I-Organization
identified O
the O
below O
malicious O
document I-Malware
. O

X-Force B-Organization
IRIS I-Organization
File O
name O
: O
cv_itworx.doc O
. O

X-Force B-Organization
IRIS I-Organization
MD5 O
: O
45b0e5a457222455384713905f886bd4 O
. O

X-Force B-Organization
IRIS I-Organization
SHA256 O
: O
528714aaaa4a083e72599c32c18aa146db503eee80da236b20aea11aa43bdf62 O
. O

X-Force B-Organization
IRIS I-Organization
Hosting O
URL O
: O
http://mol.com-ho.me/cv_itworx.doc O
. O

Our O
researchers O
examined O
the O
domain O
that O
hosted O
the O
first O
malicious O
file O
, O
mol.com-ho.me O
. O

Per O
the O
domain O
’s O
WHOIS O
record O
, O
an O
anonymized O
registrant O
registered O
com-ho.me O
in O
October O
2016 O
and O
used O
it O
to O
serve O
malicious O
documents O
with O
similar O
macro O
activation O
features O
. O

The O
following O
list O
of O
documents O
included O
: O
cv.doc O
: O
f4d18316e367a80e1005f38445421b1f O
. O

cv_itworx.doc O
: O
45b0e5a457222455384713905f886bd4 O
. O

cv_mci.doc O
: O
f4d18316e367a80e1005f38445421b1f O
. O

discount_voucher_codes.xlsm O
: O
19cea065aa033f5bcfa94a583ae59c08 O
. O

Health_insurance_plan.doc O
: O
ecfc0275c7a73a9c7775130ebca45b74 O
. O

Health_insurance_registration.doc O
: O
1b5e33e5a244d2d67d7a09c4ccf16e56 O
. O

job_titles.doc O
: O
fa72c068361c05da65bf2117db76aaa8 O
. O

job_titles_itworx.doc O
: O
43fad2d62bc23ffdc6d301571135222c O
. O

job_titles_mci.doc O
: O
ce25f1597836c28cf415394fb350ae93 O
. O

Password_Policy.xlsm O
: O
03ea9457bf71d51d8109e737158be888 O
. O

These O
files O
were O
most O
likely O
delivered O
via O
spear B-Vulnerability
phishing I-Vulnerability
emails I-Vulnerability
to O
lure O
employees O
into O
unwittingly O
launching O
the O
malicious O
payload O
. O

A O
closer O
review O
of O
the O
file O
names O
revealed O
“ O
IT O
Worx O
” O
and O
“ O
MCI O
” O
. O

A O
search O
of O
the O
name O
IT O
Worx O
brings O
up O
a O
global O
software O
professional O
services O
organization O
headquartered O
in O
Egypt O
. O

MCI O
is O
Saudi O
Arabia O
’s O
Ministry O
of O
Commerce O
and O
Investment O
. O

It O
is O
possible O
these O
names O
were O
used O
in O
spear B-Vulnerability
phishing I-Vulnerability
emails I-Vulnerability
because O
they O
would O
seem O
benign O
to O
Saudi-based O
employees O
and O
lure O
them O
to O
open O
the O
attachment O
. O

X-Force B-Organization
IRIS I-Organization
researchers O
further O
identified O
that O
the O
threat B-Organization
actor O
behind O
the O
malicious O
documents I-Malware
served O
many O
of O
them O
using O
a O
URL-shortening O
scheme O
in O
the O
following O
pattern O
: O
briefl.ink/{a-z0-9}[5] O
. O

File O
Detail O
: O
Info O
File O
name O
: O
job_titles_itworx.doc O
. O

MD5 O
: O
43fad2d62bc23ffdc6d301571135222c O
. O

SHA256 O
: O
e5b643cb6ec30d0d0b458e3f2800609f260a5f15c4ac66faf4ebf384f7976df6 O
. O

Hosting O
URL O
: O
http://briefl.ink/qhtma O
. O

Passive O
DNS O
results O
on O
a O
communications O
domain O
associated O
with O
the O
Shamoon O
attack O
revealed O
related O
network O
infrastructure O
, O
identifying O
additional O
domains O
used O
by O
the O
threat B-Organization
actors O
. O

Domain O
Name O
: O
Spoofed O
Site O
ntg-sa.com O
The O
domain O
ntg-sa.com O
appears O
to O
spoof O
the O
legit O
domain O
ntg.sa.com O
associated O
with O
the O
Namer O
Trading O
Group O
. O

Per O
their O
webpage O
, O
NTG O
“ O
was O
established O
primarily O
to O
cater O
the O
growing O
demands O
of O
Petrochemicals O
waste O
management O
within O
the O
Kingdom O
of O
Saudi O
Arabia O
” O
. O

maps-modon.club O
: O
The O
maps-modon.club O
domain O
appears O
to O
spoof O
maps.modon.gov.sa O
, O
which O
is O
associated O
with O
the O
Saudi O
Industrial O
Property O
Authority O
, O
an O
organization O
“ O
responsible O
for O
the O
development O
of O
industrial O
cities O
with O
integrated O
infrastructure O
and O
services O
” O
. O

X-Force B-Organization
IRIS I-Organization
discovered O
that O
the O
threat B-Organization
actor I-Organization
was O
hosting O
at O
least O
one O
malicious O
executable O
on O
a O
server O
hosted O
on O
ntg-sa.com O
. O

This O
file O
duped O
targets O
into O
believing O
it O
was O
a O
Flash O
player O
installer O
that O
would O
drop O
a O
Windows O
batch O
to O
invoke O
PowerShell O
into O
the O
same O
C2 O
communications O
. O

Analysis O
of O
one O
of O
the O
threat O
actor O
’s O
documents O
found O
that O
if O
the O
macro O
executes O
, O
it O
launches O
two O
separate O
PowerShell O
Scripts O
. O

The O
first O
one O
executes O
a O
PowerShell O
script O
served O
from O
http://139.59.46.154:3485/eiloShaegae1 O
. O

The O
host O
is O
possibly O
related O
to O
attacks O
that O
served O
the O
Pupy B-System
RAT I-System
, O
a O
publicly O
available O
cross-platform O
remote I-System
access I-System
tool I-System
. O

The O
second O
script O
calls O
VirtualAlloc O
to O
create O
a O
buffer O
, O
uses O
memset O
to O
load O
Metasploit-related O
shellcode O
into O
that O
buffer O
and O
executes O
it O
through O
CreateThread O
. O

Metasploit B-Malware
is O
an O
open O
source O
framework O
popular O
as O
a O
tool O
for O
developing O
and O
executing O
exploit O
code O
against O
a O
remote O
target O
machine O
. O

The O
shellcode O
performs O
a O
DWORD O
XOR O
of O
4 O
bytes O
at O
an O
offset O
from O
the O
beginning O
of O
the O
shellcode O
that O
changes O
the O
code O
to O
create O
a O
loop O
so O
the O
XOR O
continues O
0x57 O
times O
. O

If O
this O
execution O
is O
successful O
, O
it O
creates O
a O
buffer O
using O
VirtualAlloc O
and O
calls O
InternetReadFile O
in O
a O
loop O
until O
all O
the O
file O
contents O
are O
retrieved O
from O
http://45.76.128.165:4443/0w0O6 O
. O

This O
is O
then O
returned O
as O
a O
string O
to O
PowerShell B-System
, O
which O
calls O
invoke-expression O
( O
iex O
) O
on O
it O
, O
indicating O
that O
the O
expected O
payload O
is O
PowerShell O
. O

Of O
note O
, O
the O
macro O
contained O
a O
DownloadFile() O
function O
that O
would O
use O
URLDownloadToFileA O
, O
but O
this O
was O
never O
actually O
used O
. O

Based O
on O
observations O
associated O
with O
the O
malicious O
document I-Malware
, O
we O
observed O
subsequent O
shell O
sessions O
probably O
associated O
with O
Metasploit B-System
’s I-System
Meterpreter I-System
that O
enabled O
deployment O
of O
additional O
tools O
and O
malware O
preceding O
deployment O
of O
three O
Shamoon-related O
files O
: O
ntertmgr32.exe O
, O
ntertmgr64.exe O
and O
vdsk911.sys O
. O

Although O
the O
complete O
list O
of O
Shamoon O
’s O
victims O
is O
not O
public O
, O
Bloomberg O
reported O
that O
in O
one O
case O
, O
thousands O
of O
computers O
were O
destroyed O
at O
the O
headquarters O
of O
Saudi O
’s O
General O
Authority O
of O
Civil O
Aviation I-Organization
, O
erasing O
critical O
data O
and O
bringing O
operations O
to O
a O
halt O
for O
several O
days O
. O

The O
recent O
activity B-Organization
X-Force I-Organization
IRIS I-Organization
is O
seeing O
from O
the O
Shamoon B-Organization
attackers B-Organization
has O
so O
far O
been O
detected O
in O
two O
waves O
, O
but O
those O
are O
likely O
to O
subside O
following O
the O
public O
attention O
the O
cases O
have O
garnered O
since O
late O
2016 O
. O

Saudi O
Arabia O
released O
a O
warning O
to O
local O
organizations O
about O
the O
Shamoon O
malware O
, O
alerting O
about O
potential O
attacks O
and O
advising O
organizations O
to O
prepare O
. O

Additional O
Insights O
on O
Shamoon2 O
. O

IBM B-Organization
analysts O
recently O
unveiled O
a O
first O
look O
at O
how O
threat B-Organization
actors O
may O
have O
placed O
Shamoon2 O
malware O
on O
systems O
in O
Saudi O
Arabia O
. O

Researchers O
showcased O
a O
potential O
malware O
lifecycle O
which O
started O
with O
spear B-Vulnerability
phishing I-Vulnerability
and O
eventually O
led O
to O
the O
deployment O
of O
the O
disk-wiping B-System
malware I-System
known O
as O
Shamoon B-System
. O

Their O
research O
showcased O
a O
set O
of O
downloaders O
and O
domains O
that O
could O
potentially O
lead O
to O
a O
more O
extensive O
malware O
distribution O
campaign O
. O

While O
researching O
elements O
in O
the O
IBM B-Organization
report O
, O
ASERT B-Organization
discovered O
additional O
malicious O
domains O
, O
IP O
addresses O
, O
and O
artifacts O
. O

The O
basic O
functionality O
of O
the O
new O
documents O
and O
their O
PowerShell B-System
components O
matched O
what O
was O
previously O
disclosed O
. O

For O
more O
information O
on O
the O
overall O
capabilities O
of O
the O
malware O
, O
please O
review O
IBM B-Organization
's O
ongoing O
research O
. O

It O
is O
our O
hope O
that O
by O
providing O
additional O
indicators O
, O
end-point O
investigators O
and O
network O
defenders O
will O
be O
able O
to O
discover O
and O
mitigate O
more O
Shamoon2 O
related O
compromises O
. O

The O
following O
new O
samples O
were O
likely O
delivered O
via O
similar O
spear B-Vulnerability
phishing I-Vulnerability
campaigns O
as O
described O
in O
IBM B-Organization
's O
research O
. O

All O
three O
shared O
the O
same O
IPs O
and O
URLs O
, O
also O
provided O
below O
. O

These O
samples O
were O
located O
by O
pivoting O
on O
document O
attributes O
. O

In O
this O
case O
, O
a O
sample O
from O
the O
IBM B-Organization
report O
indicated O
the O
document O
author O
‘ O
gerry.knight O
’ O
which O
led O
us O
to O
the O
following O
three O
additional O
samples O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
2a0df97277ddb361cecf8726df6d78ac O
5e5ea1a67c2538dbc01df28e4ea87472 O
d30b8468d16b631cafe458fd94cc3196 O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
104.218.120.128 O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
69.87.223.26 O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
5.254.100.200 O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
analytics-google.org O
: O
69/checkFile.aspx O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
analytics-google.org O
. O

spear B-Vulnerability
phishing I-Vulnerability
: O
69.87.223.26:8080/p O
. O

From O
the O
previous O
samples O
, O
we O
performed O
a O
passive O
DNS O
lookup O
on O
the O
IPs O
. O

We O
found O
get.adobe.go-microstf.com O
hosted O
at O
104.218.120.128 O
around O
the O
time O
this O
campaign O
was O
ongoing O
, O
November O
2016 O
. O

Researching O
the O
domain O
go-microstf.com O
, O
hosted O
at O
45.63.10.99 O
, O
revealed O
yet O
another O
iteration O
of O
malicious O
executables O
. O

In O
this O
case O
, O
a O
URL O
used O
to O
download O
the O
PowerShell B-System
component O
shared O
a O
naming O
convention O
found O
in O
the O
IBM B-Organization
report O
, O
http://69.87.223.26:8080/eiloShaegae1 O
and O
connected O
to O
the O
IP O
address O
used O
by O
the O
previous O
three O
samples O
. O

The O
following O
are O
IOCs O
related O
to O
this O
domain O
: O
83be35956e5d409306a81e88a1dc89fd O
. O

45.63.10.99 O
. O

69.87.223.26 O
. O

URLs O
go-microstf.com O
. O

69.87.223.26:8080/eiloShaegae1 O
. O

go-microstf.com/checkfile.aspx O
. O

The O
domain O
go-microstf.com O
was O
originally O
set O
up O
to O
spoof O
Google B-Organization
Analytics I-System
login O
page O
. O

Finally O
, O
research O
yielded O
a O
relatively O
unique O
sample O
. O

This O
particular O
iteration O
was O
submitted O
to O
VirusTotal O
on O
September O
16 O
, O
2016 O
. O

The O
majority O
of O
samples O
analyzed O
to O
date O
were O
submitted O
no O
earlier O
than O
mid-October O
, O
with O
most O
being O
submitted O
in O
January O
2017 O
or O
later O
. O

We O
were O
able O
to O
discover O
this O
particular O
version O
by O
diving O
further O
into O
connections O
to O
analytics-google.org O
. O

Unlike O
newer O
samples O
, O
this O
one O
created O
a O
unique O
file O
sloo.exe O
. O

The O
file O
was O
created O
at O
C:\Documents O
and O
Settings\Admin\Local O
Settings\Temp\sloo.exe O
. O

In O
addition O
to O
this O
file O
, O
the O
sample O
also O
contacted O
104.238.184.252 O
for O
the O
PowerShell B-System
executable O
. O

Researchers O
at O
Palo B-Organization
Alto I-Organization
have O
attributed O
sloo.exe O
and O
related O
activities O
to O
threat O
actors O
of O
a O
likely O
Iranian O
state-sponsored O
origin O
which O
they O
’ve O
named O
Magic O
Hound I-Organization
. O

The O
group B-Organization
Magic O
Hound O
is O
linked O
via O
infrastructure O
and O
tools O
to O
the O
Rocket B-Organization
Kitten I-Organization
threat O
actor O
group O
although O
Palo B-Organization
Alto I-Organization
cannot O
confirm O
the O
extent O
of O
any O
relationship O
between O
the O
two O
groups O
. O

Dell B-Organization
Secureworks I-Organization
analysts O
recently O
concluded O
that O
domains O
discussed O
in O
the O
IBM B-Organization
report O
were O
linked O
to O
the O
Iranian O
PuppyRAT O
. O

In O
addition O
, O
Dell B-Organization
analysts O
have O
assessed O
with O
high-confidence O
these O
activities O
are O
attributable O
to O
Iranian O
state-sponsored O
activities O
. O

IOCs O
for O
this O
version O
were O
: O
Shamoon2 O
: O
07d6406036d6e06dc8019e3ade6ee7de O
. O

Shamoon2 O
: O
104.238.184.252 O
. O

Shamoon2 O
: O
5.254.100.200 O
Shamoon2 O
: O
URLs O
. O

Shamoon2 O
: O
analytics-google.org O
: O
69/checkFile.aspx O
. O

These O
additional O
IOCs O
will O
hopefully O
provide O
more O
context O
into O
the O
ongoing O
threat O
. O

The O
link O
to O
possible O
Iranian O
threat B-Organization
actors O
supports O
ongoing O
analysis O
that O
Shamoon2 O
was O
perpetrated O
by O
Iranian O
state-sponsored O
threat O
actors O
. O

The O
last O
sample O
discussed O
may O
be O
malware-0 O
or O
at O
least O
part O
of O
the O
overall O
development O
and O
subsequent O
deployment O
of O
tools O
used O
to O
install O
Shamoon O
on O
Saudi O
systems O
. O

Shamoon2 O
: O
2a0df97277ddb361cecf8726df6d78ac O
. O

Shamoon2 O
: O
5e5ea1a67c2538dbc01df28e4ea87472 O
. O

Shamoon2 O
: O
d30b8468d16b631cafe458fd94cc3196 O
. O

Shamoon2 O
: O
83be35956e5d409306a81e88a1dc89fd O
. O

Shamoon2 O
: O
07d6406036d6e06dc8019e3ade6ee7de O
. O

Shamoon2 O
: O
104.218.120.128 O
. O

Shamoon2 O
: O
69.87.223.26 O
. O

Shamoon2 O
: O
5.254.100.200 O
. O

Shamoon2 O
: O
45.63.10.99 O
. O

Shamoon2 O
: O
104.238.184.252 O
. O

Shamoon2 O
: O
analytics-google.org O
: O
69/checkFile.aspx O
. O

Shamoon2 O
: O
analytics-google.org O
. O

Shamoon2 O
: O
69.87.223.26:8080/p O
. O

Shamoon2 O
: O
go-microstf.com O
. O

Shamoon2 O
: O
69.87.223.26:8080/eiloShaegae1 O
. O

Shamoon2 O
: O
get.adobe.go-microstf.com O
. O

FireEye B-Organization
recently O
observed O
a O
sophisticated O
campaign O
targeting O
individuals O
within O
the O
Mongolian O
government O
. O

Targeted O
individuals O
that O
enabled O
macros O
in O
a O
malicious B-Malware
Microsoft I-Malware
Word I-Malware
document I-Malware
may O
have O
been O
infected O
with O
Poison B-System
Ivy I-System
, O
a O
popular O
remote O
access O
tool O
( O
RAT B-System
) O
that O
has O
been O
used O
for O
nearly O
a O
decade O
for O
key O
logging O
, O
screen O
and O
video O
capture O
, O
file O
transfers O
, O
password O
theft O
, O
system O
administration O
, O
traffic O
relaying O
, O
and O
more O
. O

The O
threat B-Organization
actors O
behind O
this O
attack O
demonstrated O
some O
interesting O
techniques O
, O
including O
: O
Customized O
evasion O
based O
on O
victim O
profile O
– O
The O
campaign O
used O
a O
publicly B-System
available I-System
technique I-System
to O
evade O
AppLocker O
application O
whitelisting O
applied O
to O
the O
targeted O
systems O
. O

Fileless O
execution O
and O
persistence O
– O
In O
targeted O
campaigns O
, O
threat O
actors O
often O
attempt O
to O
avoid O
writing O
an O
executable O
to O
the O
disk O
to O
avoid O
detection O
and O
forensic O
examination O
. O

The O
campaign O
we O
observed O
used O
four O
stages O
of O
PowerShell B-System
scripts O
without O
writing O
the O
the O
payloads O
to O
individual O
files O
. O

Decoy O
documents O
– O
This O
campaign O
used O
PowerShell B-System
to O
download O
benign O
documents O
from O
the O
Internet O
and O
launch O
them O
in O
a O
separate O
Microsoft O
Word I-Malware
instance O
to O
minimize O
user O
suspicion O
of O
malicious O
activity O
. O

The O
threat O
actors O
used O
social B-Vulnerability
engineering I-Vulnerability
to O
convince O
users O
to O
run O
an O
embedded O
macro O
in O
a O
Microsoft B-Malware
Word I-Malware
document I-Malware
that O
launched O
a O
malicious O
PowerShell O
payload O
. O

The O
threat O
actors O
used O
two O
publicly O
available O
techniques O
, O
an O
AppLocker O
whitelisting O
bypass O
and O
a O
script O
to O
inject O
shellcode O
into O
the O
userinit.exe O
process O
. O

The O
malicious O
payload O
was O
spread O
across O
multiple O
PowerShell B-System
scripts I-System
, O
making O
its O
execution O
difficult O
to O
trace O
. O

Rather O
than O
being O
written O
to O
disk O
as O
individual O
script O
files O
, O
the O
PowerShell B-System
payloads O
were O
stored O
in O
the O
registry O
. O

Targets O
of O
the O
campaign O
received O
Microsoft B-Malware
Word I-Malware
documents I-Malware
via O
email O
that O
claimed O
to O
contain O
instructions O
for O
logging O
into O
webmail O
or O
information O
regarding O
a O
state O
law O
proposal O
. O

Microsoft O
application O
whitelisting O
solution O
AppLocker O
prevents O
unknown O
executables O
from O
running O
on O
a O
system O
. O

In O
April O
2016 O
, O
a O
security B-Organization
researcher O
demonstrated O
a O
way O
to O
bypass O
this O
using O
regsvr32.exe O
, O
a O
legitimate O
Microsoft O
executable O
permitted O
to O
execute O
in O
many O
AppLocker O
policies O
. O

The O
regsvr32.exe O
executable O
can O
be O
used O
to O
download O
a O
Windows B-System
Script O
Component O
file O
( O
SCT O
file O
) O
by O
passing O
the O
URL O
of O
the O
SCT O
file O
as O
an O
argument O
. O

This O
technique O
bypasses O
AppLocker O
restrictions O
and O
permits O
the O
execution O
of O
code O
within O
the O
SCT O
file O
. O

In O
the O
decrypted O
shellcode O
, O
we O
also O
observed O
content O
and O
configuration O
related O
to O
Poison B-System
Ivy I-System
. O

Correlating O
these O
bytes O
to O
the O
standard O
configuration O
of O
Poison B-System
Ivy I-System
, O
we O
can O
observe O
the O
following O
: O
Active O
setup O
: O
StubPath O
. O

Encryption/Decryption O
key O
: O
version2013 O
. O

Mutex O
name O
: O
20160509 O
. O

Although O
Poison B-System
Ivy I-System
has O
been O
a O
proven O
threat O
for O
some O
time O
, O
the O
delivery O
mechanism O
for O
this O
backdoor O
uses O
recent O
publicly O
available O
techniques O
that O
differ O
from O
previously O
observed O
campaigns O
. O

Through O
the O
use O
of O
PowerShell B-System
and O
publicly B-System
available I-System
security I-System
control I-System
bypasses I-System
and O
scripts B-System
, O
most O
steps O
in O
the O
attack O
are O
performed O
exclusively O
in O
memory O
and O
leave O
few O
forensic O
artifacts O
on O
a O
compromised O
host O
. O

FireEye B-Organization
HX O
Exploit O
Guard O
is O
a O
behavior-based O
solution O
that O
is O
not O
affected O
by O
the O
tricks O
used O
here O
. O

It O
detects O
and O
blocks O
this O
threat O
at O
the O
initial O
level O
of O
the O
attack O
cycle O
when O
the O
malicious O
macro O
attempts O
to O
invoke O
the O
first O
stage O
PowerShell O
payload O
. O

Alert B-Organization
: O
HIDDEN B-Organization
COBRA I-Organization
- O
North O
Korea O
's O
DDoS O
Botnet O
Infrastructure O
. O

This O
joint O
Technical O
Alert O
( O
TA O
) O
is O
the O
result O
of O
analytic O
efforts O
between O
the O
Department B-Organization
of I-Organization
Homeland I-Organization
Security I-Organization
( O
DHS B-Organization
) O
and O
the O
Federal O
Bureau O
of O
Investigation O
( O
FBI B-Organization
) O
. O

This O
alert O
provides O
technical O
details O
on O
the O
tools O
and O
infrastructure O
used O
by O
cyber B-Organization
actors O
of O
the O
North O
Korean O
government O
to O
target O
the O
media O
, O
aerospace O
, O
financial O
, O
and O
critical B-Organization
infrastructure I-Organization
sectors I-Organization
in O
the O
United O
States O
and O
globally O
. O

Working O
with O
U.S. B-Organization
Government O
partners O
, O
DHS B-Organization
and O
FBI B-Organization
identified O
Internet O
Protocol O
( O
IP O
) O
addresses O
associated O
with O
a O
malware O
variant O
, O
known O
as O
DeltaCharlie O
, O
used O
to O
manage O
North O
Korea O
's O
distributed O
denial-of-service O
( O
DDoS O
) O
botnet O
infrastructure O
. O

This O
alert O
contains O
indicators O
of O
compromise O
( O
IOCs O
) O
, O
malware O
descriptions O
, O
network O
signatures O
, O
and O
host-based O
rules O
to O
help O
network O
defenders O
detect O
activity O
conducted O
by O
the O
North O
Korean O
government O
. O

The O
U.S. B-Organization
Government O
refers O
to O
the O
malicious O
cyber O
activity O
by O
the O
North O
Korean O
government O
as O
HIDDEN B-Organization
COBRA I-Organization
. O

For O
more O
information O
related O
to O
HIDDEN B-Organization
COBRA O
activity O
, O
go O
to O
https://www.us-cert.gov/hiddencobra O
. O

If O
users O
or O
administrators O
detect O
the O
custom O
tools O
indicative O
of O
HIDDEN B-Organization
COBRA I-System
, O
these O
tools O
should O
be O
immediately O
flagged O
, O
reported O
to O
the O
DHS B-Organization
National O
Cybersecurity I-Organization
Communications O
and O
Integration O
Center I-Organization
( O
NCCIC O
) O
or O
the O
FBI B-Organization
Cyber I-Organization
Watch O
( O
CyWatch O
) O
, O
and O
given O
highest O
priority O
for O
enhanced O
mitigation O
. O

This O
alert O
identifies O
IP O
addresses O
linked O
to O
systems O
infected O
with O
DeltaCharlie O
malware O
and O
provides O
descriptions O
of O
the O
malware O
and O
associated O
malware O
signatures O
. O

DHS B-Organization
and O
FBI B-Organization
are O
distributing O
these O
IP O
addresses O
to O
enable O
network O
defense O
activities O
and O
reduce O
exposure O
to O
the O
DDoS O
command-and-control O
network O
. O

FBI B-Organization
has O
high O
confidence O
that O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
are O
using O
the O
IP O
addresses O
for O
further O
network O
exploitation O
. O

This O
alert O
includes O
technical O
indicators O
related O
to O
specific O
North O
Korean O
government O
cyber O
operations O
and O
provides O
suggested O
response O
actions O
to O
those O
indicators O
, O
recommended O
mitigation O
techniques O
, O
and O
information O
on O
reporting O
incidents O
to O
the O
U.S. B-Organization
Government O
. O

On O
August O
23 O
, O
2017 O
, O
DHS B-Organization
published O
a O
Malware O
Analysis O
Report O
( O
MAR-10132963 O
) O
that O
examines O
malware O
functionality O
to O
provide O
detailed O
code O
analysis O
and O
insight O
into O
specific O
tactics O
, O
techniques O
, O
and O
procedures O
( O
TTPs O
) O
observed O
in O
the O
malware O
. O

Since O
2009 O
, O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
have O
leveraged O
their O
capabilities O
to O
target O
and O
compromise O
a O
range O
of O
victims O
; O
some O
intrusions O
have O
resulted O
in O
the O
Exfiltration O
of O
data O
while O
others O
have O
been O
disruptive O
in O
nature O
. O

Commercial O
reporting O
has O
referred O
to O
this O
activity O
as O
Lazarus B-Organization
Group I-Organization
and O
Guardians B-Organization
of O
Peace I-Organization
. O

DHS B-Organization
and O
FBI B-Organization
assess O
that O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
will O
continue O
to O
use O
cyber O
operations O
to O
advance O
their O
government O
's O
military O
and O
strategic O
objectives O
. O

Cyber B-Organization
analysts O
are O
encouraged O
to O
review O
the O
information O
provided O
in O
this O
alert O
to O
detect O
signs O
of O
malicious O
network O
activity O
. O

Tools O
and O
capabilities O
used O
by O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
include O
DDoS B-System
botnet I-System
, O
keyloggers B-System
, O
remote B-System
access I-System
tools I-System
( O
RATs B-System
) O
, O
and O
wiper B-System
malware I-System
. O

Variants O
of O
malware O
and O
tools O
used O
by O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
include O
Destover B-System
, O
Wild B-System
Positron O
, O
and O
Hangman B-System
. O

DHS B-Organization
has O
previously O
released O
Alert O
TA14-353A O
, O
which O
contains O
additional O
details O
on O
the O
use O
of O
a O
server O
message O
block O
( O
SMB B-System
) O
worm O
tool O
employed O
by O
these O
actors B-Organization
. O

Further O
research O
is O
needed O
to O
understand O
the O
full O
breadth O
of O
this O
group O
's O
cyber O
capabilities O
. O

In O
particular O
, O
DHS B-Organization
recommends O
that O
more O
research O
should O
be O
conducted O
on O
the O
North O
Korean O
cyber O
activity O
that O
has O
been O
reported O
by O
cybersecurity B-Organization
and O
threat B-Organization
research I-Organization
firms I-Organization
. O

HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
commonly O
target O
systems O
running O
older O
, O
unsupported O
versions O
of O
Microsoft O
operating O
systems O
. O

The O
multiple O
vulnerabilities O
in O
these O
older O
systems O
provide O
cyber B-Organization
actors O
many O
targets O
for O
exploitation O
. O

These O
actors B-Organization
have O
also O
used O
Adobe B-Vulnerability
Flash I-Vulnerability
player I-Vulnerability
vulnerabilities I-Vulnerability
to O
gain O
initial O
entry O
into O
users' O
environments O
. O

HIDDEN B-Organization
COBRA I-Organization
is O
known O
to O
use O
vulnerabilities O
affecting O
various O
applications O
. O

These O
vulnerabilities O
include O
: O
CVE-2015-6585 O
: O
Hangul O
Word I-Malware
Processor O
Vulnerability B-Vulnerability
. O

CVE-2015-8651 O
: O
Adobe B-Vulnerability
Flash I-Vulnerability
Player I-System
18.0.0.324 O
and O
19.x O
Vulnerability B-Vulnerability
. O

CVE-2016-0034 O
: O
Microsoft O
Silverlight O
5.1.41212.0 O
Vulnerability B-Vulnerability
. O

CVE-2016-1019 O
: O
Adobe B-Vulnerability
Flash I-Vulnerability
Player I-Vulnerability
21.0.0.197 O
Vulnerability B-Vulnerability
. O

CVE-2016-4117 B-Vulnerability
: O
Adobe B-Vulnerability
Flash I-Vulnerability
Player I-Vulnerability
21.0.0.226 O
Vulnerability B-Vulnerability
. O

DHS B-Organization
recommends O
that O
organizations O
upgrade O
these O
applications O
to O
the O
latest O
version O
and O
patch O
level O
. O

If O
Adobe B-System
Flash O
or O
Microsoft O
Silverlight O
is O
no O
longer O
required O
, O
DHS B-Organization
recommends O
that O
those O
applications O
be O
removed O
from O
systems O
. O

The O
IOCs O
provided O
with O
this O
alert O
include O
IP O
addresses O
determined O
to O
be O
part O
of O
the O
HIDDEN B-System
COBRA I-System
botnet I-System
infrastructure I-System
, O
identified O
as O
DeltaCharlie O
. O

The O
DeltaCharlie O
DDoS B-System
bot I-System
was O
originally O
reported O
by O
Novetta B-Organization
in O
their O
2016 O
Operation O
Blockbuster O
Malware O
Report O
. O

This O
malware O
has O
used O
the O
IP O
addresses O
identified O
in O
the O
accompanying O
.csv O
and O
.stix O
files O
as O
both O
source O
and O
destination O
IPs O
. O

In O
some O
instances O
, O
the O
malware O
may O
have O
been O
present O
on O
victims' O
networks O
for O
a O
significant O
period O
. O

DeltaCharlie O
is O
a O
DDoS B-System
tool O
used O
by O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
, O
and O
is O
referenced O
and O
detailed O
in O
Novetta B-Organization
's O
Operation O
Blockbuster O
Destructive O
Malware O
report O
. O

The O
information O
related O
to O
DeltaCharlie O
from O
the O
Operation O
Blockbuster O
Destructive O
Malware O
report O
should O
be O
viewed O
in O
conjunction O
with O
the O
IP O
addresses O
listed O
in O
the O
.csv O
and O
.stix O
files O
provided O
within O
this O
alert O
. O

DeltaCharlie O
is O
a O
DDoS B-System
tool O
capable O
of O
launching O
Domain O
Name O
System O
( O
DNS O
) O
attacks O
, O
Network O
Time O
Protocol O
( O
NTP O
) O
attacks O
, O
and O
Carrier O
Grade O
NAT O
( O
CGN O
) O
attacks O
. O

The O
malware O
operates O
on O
victims' O
systems O
as O
a O
svchost-based O
service O
and O
is O
capable O
of O
downloading O
executables O
, O
changing O
its O
own O
configuration O
, O
updating O
its O
own O
binaries O
, O
terminating O
its O
own O
processes O
, O
and O
activating O
and O
terminating O
denial-of-service O
attacks O
. O

HIDDEN B-Organization
COBRA I-Organization
IOCs O
related O
to O
DeltaCharlie O
are O
provided O
within O
the O
accompanying O
.csv O
and O
.stix O
files O
of O
this O
alert O
. O

DHS B-Organization
and O
FBI B-Organization
recommend O
that O
network O
administrators O
review O
the O
IP O
addresses O
, O
file O
hashes O
, O
network O
signatures O
, O
and O
YARA O
rules O
provided O
, O
and O
add O
the O
IPs O
to O
their O
watchlist O
to O
determine O
whether O
malicious O
activity O
has O
been O
observed O
within O
their O
organization O
. O

When O
reviewing O
network O
perimeter O
logs O
for O
the O
IP O
addresses O
, O
organizations O
may O
find O
numerous O
instances O
of O
these O
IP O
addresses O
attempting O
to O
connect O
to O
their O
systems O
. O

Upon O
reviewing O
the O
traffic O
from O
these O
IP O
addresses O
, O
system O
owners O
may O
find O
that O
some O
traffic O
corresponds O
to O
malicious O
activity O
and O
some O
to O
legitimate O
activity O
. O

System B-Organization
owners O
are O
also O
advised O
to O
run O
the O
YARA O
tool O
on O
any O
system O
they O
suspect O
to O
have O
been O
targeted O
by O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
. O

This O
section O
contains O
network O
signatures O
and O
host-based O
rules O
that O
can O
be O
used O
to O
detect O
malicious O
activity O
associated O
with O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
. O

Although O
created O
using O
a O
comprehensive O
vetting O
process O
, O
the O
possibility O
of O
false O
positives O
always O
remains O
. O

These O
signatures O
and O
rules O
should O
be O
used O
to O
supplement O
analysis O
and O
should O
not O
be O
used O
as O
a O
sole O
source O
of O
attributing O
this O
activity O
to O
HIDDEN B-Organization
COBRA I-Organization
actors I-Organization
. O

A O
successful O
network O
intrusion O
can O
have O
severe O
impacts O
, O
particularly O
if O
the O
compromise O
becomes O
public O
and O
sensitive O
information O
is O
exposed O
. O

Possible O
impacts O
include O
: O
temporary O
or O
permanent O
loss O
of O
sensitive O
or O
proprietary O
information O
, O
disruption O
to O
regular O
operations O
, O
financial O
losses O
incurred O
to O
restore O
systems O
and O
files O
, O
and O
potential O
harm O
to O
an O
organization O
's O
reputation O
. O

Network O
administrators O
are O
encouraged O
to O
apply O
the O
following O
recommendations O
, O
which O
can O
prevent O
as O
many O
as O
85 O
percent O
of O
targeted O
cyber O
intrusions O
. O

The O
mitigation O
strategies O
provided O
may O
seem O
like O
common O
sense O
. O

However O
, O
many O
organizations O
fail O
to O
use O
these O
basic O
security O
measures O
, O
leaving O
their O
systems O
open O
to O
compromise O
: O
Patch O
applications O
and O
operating O
systems O
. O

Most O
attackers O
target O
vulnerable O
applications O
and O
operating O
systems O
. O

Ensuring O
that O
applications O
and O
operating O
systems O
are O
patched O
with O
the O
latest O
updates O
greatly O
reduces O
the O
number O
of O
exploitable O
entry O
points O
available O
to O
an O
attacker B-Organization
. O

Use O
best O
practices O
when O
updating O
software O
and O
patches O
by O
only O
downloading O
updates O
from O
authenticated O
vendor O
sites O
. O

Use O
application O
whitelisting O
. O

Whitelisting O
is O
one O
of O
the O
best O
security O
strategies O
because O
it O
allows O
only O
specified O
programs O
to O
run O
while O
blocking O
all O
others O
, O
including O
malicious O
software O
. O

Restrict O
administrative O
privileges O
. O

Threat B-Organization
actors I-Organization
are O
increasingly O
focused O
on O
gaining O
control O
of O
legitimate O
credentials O
, O
especially O
credentials O
associated O
with O
highly O
privileged O
accounts O
. O

Reduce O
privileges O
to O
only O
those O
needed O
for O
a O
user O
's O
duties O
. O

Separate O
administrators O
into O
privilege O
tiers O
with O
limited O
access O
to O
other O
tiers O
. O

Segment O
networks O
and O
segregate O
them O
into O
security O
zones O
. O

Segment O
networks O
into O
logical O
enclaves O
and O
restrict O
host-to-host O
communications O
paths O
. O

This O
helps O
protect O
sensitive O
information O
and O
critical O
services O
, O
and O
limits O
damage O
from O
network O
perimeter O
breaches O
. O

Validate O
input O
. O

Input O
validation O
is O
a O
method O
of O
sanitizing O
untrusted O
input O
provided O
by O
users O
of O
a O
web O
application O
. O

Implementing O
input O
validation O
can O
protect O
against O
the O
security O
flaws O
of O
web O
applications O
by O
significantly O
reducing O
the O
probability O
of O
successful O
exploitation O
. O

Types O
of O
attacks O
possibly O
averted O
include O
Structured O
Query O
Language O
( O
SQL O
) O
injection O
, O
cross-site O
scripting O
, O
and O
command O
injection O
. O

Use O
stringent O
file O
reputation O
settings O
. O

Tune O
the O
file O
reputation O
systems O
of O
your O
anti-virus O
software O
to O
the O
most O
aggressive O
setting O
possible O
. O

Some O
anti-virus O
products O
can O
limit O
execution O
to O
only O
the O
highest O
reputation O
files O
, O
stopping O
a O
wide O
range O
of O
untrustworthy O
code O
from O
gaining O
control O
. O

Understand O
firewalls O
. O

Firewalls O
provide O
security O
to O
make O
your O
network O
less O
susceptible O
to O
attack O
. O

They O
can O
be O
configured O
to O
block O
data O
and O
applications O
from O
certain O
locations O
( O
IP O
whitelisting O
) O
, O
while O
allowing O
relevant O
and O
necessary O
data O
through O
. O

To O
protect O
against O
code O
injections O
and O
other O
attacks O
, O
system O
operators O
should O
routinely O
evaluate O
known O
and O
published O
vulnerabilities O
, O
periodically O
perform O
software O
updates O
and O
technology O
refreshes O
, O
and O
audit O
external-facing O
systems O
for O
known O
web B-Vulnerability
application O
vulnerabilities O
. O

They O
should O
also O
take O
the O
following O
steps O
to O
harden O
both O
web O
applications O
and O
the O
servers O
hosting O
them O
to O
reduce O
the O
risk O
of O
network O
intrusion O
via O
this O
vector O
. O

Use O
and O
configure O
available O
firewalls O
to O
block O
attacks O
. O

Take O
steps O
to O
secure O
Windows O
systems O
, O
such O
as O
installing O
and O
configuring O
Microsoft O
's O
Enhanced O
Mitigation O
Experience O
Toolkit O
( O
EMET O
) O
and O
Microsoft O
AppLocker O
. O

Monitor O
and O
remove O
any O
unauthorized O
code O
present O
in O
any O
www O
directories O
. O

Disable O
, O
discontinue O
, O
or O
disallow O
the O
use O
of O
Internet B-System
Control I-System
Message I-System
Protocol I-System
( O
ICMP O
) O
and O
Simple O
Network I-System
Management O
Protocol O
( O
SNMP O
) O
as O
much O
as O
possible O
. O

Remove O
unnecessary O
HTTP O
verbs O
from O
web O
servers O
. O

Typical O
web O
servers O
and O
applications O
only O
require O
GET O
, O
POST O
, O
and O
HEAD O
. O

Where O
possible O
, O
minimize O
server O
fingerprinting O
by O
configuring O
web O
servers O
to O
avoid O
responding O
with O
banners O
identifying O
the O
server O
software O
and O
version O
number O
. O

Secure B-System
both O
the O
operating O
system O
and O
the O
application O
. O

Update O
and O
patch O
production O
servers O
regularly O
. O

Disable O
potentially O
harmful O
SQL-stored O
procedure O
calls O
. O

Sanitize O
and O
validate O
input O
to O
ensure O
that O
it O
is O
properly O
typed O
and O
does O
not O
contain O
escaped O
code O
. O

Consider O
using O
type-safe O
stored O
procedures O
and O
prepared O
statements O
. O

Audit O
transaction O
logs O
regularly O
for O
suspicious O
activity O
. O

Perform B-Organization
penetration O
testing O
on O
web O
services O
. O

Ensure O
error O
messages O
are O
generic O
and O
do O
not O
expose O
too O
much O
information O
. O

System B-Organization
operators O
should O
take O
the O
following O
steps O
to O
limit O
permissions O
, O
privileges O
, O
and O
access O
controls O
. O

Reduce O
privileges O
to O
only O
those O
needed O
for O
a O
user O
's O
duties O
. O

Restrict O
users' O
ability O
( O
permissions O
) O
to O
install O
and O
run O
unwanted O
software O
applications O
, O
and O
apply O
the O
principle O
of O
Least O
Privilege O
to O
all O
systems O
and O
services O
. O

Restricting O
these O
privileges O
may O
prevent O
malware O
from O
running O
or O
limit O
its O
capability O
to O
spread O
through O
the O
network O
. O

Carefully O
consider O
the O
risks O
before O
granting O
administrative O
rights O
to O
users O
on O
their O
own O
machines O
. O

Scrub O
and O
verify O
all O
administrator O
accounts O
regularly O
. O

Configure O
Group B-Organization
Policy O
to O
restrict O
all O
users O
to O
only O
one O
login O
session O
, O
where O
possible O
. O

Enforce O
secure O
network O
authentication O
, O
where O
possible O
. O

Instruct O
administrators O
to O
use O
non-privileged O
accounts O
for O
standard O
functions O
such O
as O
web O
browsing O
or O
checking O
webmail O
. O

Segment O
networks O
into O
logical O
enclaves O
and O
restrict O
host-to-host O
communication O
paths O
. O

Containment O
provided O
by O
enclaving O
also O
makes O
incident O
cleanup O
significantly O
less O
costly O
. O

Configure O
firewalls O
to O
disallow O
Remote B-System
Desktop I-System
Protocol I-System
( O
RDP B-System
) O
traffic O
coming O
from O
outside O
of O
the O
network O
boundary O
, O
except O
for O
in O
specific O
configurations O
such O
as O
when O
tunneled O
through O
a O
secondary O
virtual O
private O
network O
( O
VPN O
) O
with O
lower O
privileges O
. O

Audit O
existing O
firewall O
rules O
and O
close O
all O
ports O
that O
are O
not O
explicitly O
needed O
for O
business O
. O

Specifically O
, O
carefully O
consider O
which O
ports O
should O
be O
connecting O
outbound O
versus O
inbound O
. O

Enforce O
a O
strict O
lockout O
policy O
for O
network O
users O
and O
closely O
monitor O
logs O
for O
failed O
login O
activity O
. O

Failed O
login O
activity O
can O
be O
indicative O
of O
failed O
intrusion O
activity O
. O

If O
remote O
access O
between O
zones O
is O
an O
unavoidable O
business O
need O
, O
log O
and O
monitor O
these O
connections O
closely O
. O

In O
environments O
with O
a O
high O
risk O
of O
interception O
or O
intrusion O
, O
organizations O
should O
consider O
supplementing O
password O
authentication O
with O
other O
forms O
of O
authentication O
such O
as O
challenge/response O
or O
multifactor O
authentication O
using O
biometric O
or O
physical O
tokens O
. O

System B-Organization
operators O
should O
follow O
these O
secure O
logging O
practices O
. O

Ensure O
event O
logging O
, O
including O
applications O
, O
events O
, O
login O
activities O
, O
and O
security O
attributes O
, O
is O
turned O
on O
or O
monitored O
for O
identification O
of O
security O
issues O
. O

Configure O
network O
logs O
to O
provide O
adequate O
information O
to O
assist O
in O
quickly O
developing O
an O
accurate O
determination O
of O
a O
security O
incident O
. O

Upgrade O
PowerShell B-System
to O
new O
versions O
with O
enhanced O
logging O
features O
and O
monitor O
the O
logs O
to O
detect O
usage O
of O
PowerShell O
commands O
, O
which O
are O
often O
malware-related O
. O

Secure O
logs O
in O
a O
centralized O
location O
and O
protect O
them O
from O
modification O
. O

Phantom O
of O
the O
Opaera O
: O
New O
KASPERAGENT O
Malware O
Campaign O
. O

ThreatConnect B-Organization
has O
identified O
a O
KASPERAGENT O
malware O
campaign O
leveraging O
decoy O
Palestinian O
Authority O
documents O
. O

The O
samples O
date O
from O
April O
– O
May O
2017 O
, O
coinciding O
with O
the O
run O
up O
to O
the O
May O
2017 O
Palestinian O
Authority O
elections O
. O

Although O
we O
do O
not O
know O
who O
is O
behind O
the O
campaign O
, O
the O
decoy B-Malware
documents I-Malware
’ O
content O
focuses O
on O
timely O
political O
issues O
in O
Gaza B-Organization
and O
the O
IP O
address O
hosting O
the O
campaign O
’s O
command O
and O
control O
node O
hosts O
several O
other O
domains O
with O
Gaza B-Organization
registrants O
. O

In O
this O
blog O
post O
we O
will O
detail O
our O
analysis O
of O
the O
malware O
and O
associated O
indicators O
, O
look O
closely O
at O
the O
decoy B-Malware
files O
, O
and O
leverage O
available O
information O
to O
make O
an O
educated O
guess O
on O
the O
possible O
intended O
target O
. O

Associated O
indicators O
and O
screenshots O
of O
the O
decoy B-Malware
documents I-Malware
are O
all O
available O
here O
in O
the O
ThreatConnect B-Organization
platform O
. O

Some O
of O
the O
indicators O
in O
the O
following O
post O
were O
published O
on O
AlienVault O
OTX O
on O
6/13 O
. O

KASPERAGENT O
is O
Microsoft O
Windows O
malware I-System
used O
in O
efforts O
targeting O
users O
in O
the O
United O
States O
, O
Israel O
, O
Palestinian O
Territories O
, O
and O
Egypt O
since O
July O
2015 O
. O

The O
malware O
was O
discovered O
by O
Palo B-Organization
Alto I-Organization
Networks I-Organization
Unit I-Organization
42 I-Organization
and O
ClearSky B-Organization
Cyber I-Organization
Security I-Organization
, O
and O
publicized B-Organization
in O
April O
2017 O
in O
the O
Targeted O
Attacks O
in O
the O
Middle O
East O
Using O
KASPERAGENT O
and O
MICROPSIA O
blog O
. O

It O
is O
called O
KASPERAGENT O
based O
on O
PDB O
strings O
identified O
in O
the O
malware O
such O
as O
“ O
c O
: O
UsersUSADocumentsVisual O
Studio O
2008ProjectsNew O
folder O
( O
2 O
) O
kasperReleasekasper.pdb O
” O
. O

The O
threat B-Organization
actors O
used O
shortened O
URLs O
in O
spear B-Vulnerability
phishing I-Vulnerability
messages I-Vulnerability
and O
fake O
news O
websites O
to O
direct O
targets O
to O
download O
KASPERAGENT O
. O

Upon O
execution O
, O
KASPERAGENT O
drops O
the O
payload O
and O
a O
decoy B-Malware
document I-Malware
that O
displays O
Arabic O
names O
and O
ID O
numbers O
. O

The O
malware O
establishes O
persistence O
and O
sends O
HTTP O
requests O
to O
the O
command O
and O
control O
domain O
mailsinfo.net O
. O

Of O
note O
, O
the O
callbacks O
were O
to O
PHP O
scripts O
that O
included O
/ O
dad5 O
/ O
in O
the O
URLs O
. O

Most O
samples O
of O
the O
malware O
reportedly O
function O
as O
a O
basic O
reconnaissance O
tool O
and O
downloader B-Malware
. O

However O
, O
some O
of O
the O
recently O
identified O
files O
display O
“ O
extended-capability O
” O
including O
the O
functionality O
to O
steal O
passwords O
, O
take O
screenshots O
, O
log O
keystrokes O
, O
and O
steal O
files O
. O

These O
“ O
extended-capability O
” O
samples O
called O
out O
to O
an O
additional O
command O
and O
control O
domain O
, O
stikerscloud.com O
. O

Additionally O
, O
early O
variants O
of O
KASPERAGENT O
used O
“ O
Chrome B-System
” O
as O
the O
user O
agent O
, O
while O
more O
recent O
samples O
use O
“ O
OPAERA O
” O
– O
a O
possible O
misspelling O
of O
the O
“ O
Opera O
” O
– O
browser O
. O

The O
indicators O
associated O
with O
the O
blog O
article O
are O
available O
in O
the O
ThreatConnect B-System
Technical O
Blogs O
and O
Reports O
source O
here O
. O

The O
samples O
we O
identified O
leverage O
the O
same O
user O
agent O
string O
“ O
OPAERA O
” O
, O
included O
the O
kasper O
PDB O
string O
reported O
by O
Unit B-Organization
42 I-Organization
, O
and O
used O
similar O
POST O
and O
GET O
requests O
. O

The O
command O
and O
control O
domains O
were O
different O
, O
and O
these O
samples O
used O
unique O
decoy B-Malware
documents I-Malware
to O
target O
their O
victims O
. O

We O
didn’t O
start O
out O
looking O
for O
KASPERAGENT O
, O
but O
a O
file O
hit O
on O
one O
of O
our O
YARA O
rules O
for O
an O
executable O
designed O
to O
display O
a O
fake O
XLS O
icon O
– O
one O
way O
adversaries O
attempt O
to O
trick O
targets O
into O
thinking O
a O
malicious O
file I-Malware
is O
innocuous O
. O

The O
first O
malicious O
sample O
we O
identified O
( O
6843AE9EAC03F69DF301D024BFDEFC88 O
) O
had O
the O
file O
name O
“ O
testproj.exe O
” O
and O
was O
identified O
within O
an O
archive O
file O
( O
4FE7561F63A71CA73C26CB95B28EAEE8 O
) O
with O
the O
name O
“ O
التفاصيل O
الكاملة O
لأغتيال O
فقهاء.r24 O
” O
. O

This O
translates O
to O
“ O
The O
Complete O
Details O
of O
Fuqaha O
’s O
Assassination O
” O
, O
a O
reference O
to O
Hamas O
military O
leader O
Mazen O
Fuqaha O
who O
was O
assassinated O
on O
March O
24 O
, O
2017 O
. O

We O
detonated O
the O
file O
in O
VxStream O
’s O
automated O
malware O
analysis O
capability O
and O
found O
testproj.exe O
dropped O
a O
benign O
Microsoft B-Malware
Word I-Malware
document I-Malware
that O
pulls O
a O
jpg O
file O
from O
treestower.com O
. O

Malwr.com O
observed O
this O
site O
in O
association O
with O
another O
sample O
that O
called O
out O
to O
mailsinfo.net O
– O
a O
host O
identified O
in O
the O
Targeted O
Attacks O
in O
the O
Middle O
East O
Using O
KASPERAGENT O
and O
MICROPSIA O
blog O
. O

That O
was O
our O
first O
hint O
that O
we O
were O
looking O
at O
KASPERAGENT O
. O

The O
jpg O
pulled O
from O
treestower.com O
displays O
a O
graphic O
picture O
of O
a O
dead O
man O
, O
which O
also O
appeared O
on O
a O
Palestinian O
news O
website O
discussing O
the O
death O
of O
Hamas O
military O
leader O
Mazen O
Fuqaha O
. O

A O
separate O
malicious O
executable O
– O
2DE25306A58D8A5B6CBE8D5E2FC5F3C5 O
( O
vlc.exe O
) O
– O
runs O
when O
the O
photograph O
is O
displayed O
, O
using O
the O
YouTube O
icon O
and O
calling O
out O
to O
several O
URLs O
on O
windowsnewupdates.com O
. O

This O
host O
was O
registered O
in O
late O
March O
and O
appears O
to O
be O
unique O
to O
this O
campaign O
. O

With O
our O
interest O
piqued O
, O
we O
pivoted O
on O
the O
import O
hashes O
( O
also O
known O
as O
an O
imphash O
) O
, O
which O
captures O
the O
import O
table O
of O
a O
given O
file O
. O

Shared O
import O
hashes O
across O
multiple O
files O
would O
likely O
identify O
files O
that O
are O
part O
of O
the O
same O
malware O
family O
. O

We O
found O
nine O
additional O
samples O
sharing O
the O
imphash O
values O
for O
the O
two O
executables O
, O
C66F88D2D76D79210D568D7AD7896B45 O
and O
DCF3AA484253068D8833C7C5B019B07 O
. O

Analysis O
of O
those O
files O
uncovered O
two O
more O
imphashes O
, O
0B4E44256788783634A2B1DADF4F9784 O
and O
E44F0BD2ADFB9CBCABCAD314D27ACCFC O
, O
for O
a O
total O
of O
20 O
malicious O
files I-Malware
. O

These O
additional O
samples O
behaved O
similarly O
to O
the O
initial O
files O
; O
testproj.exe O
dropped O
benign O
decoy B-Malware
files O
and O
started O
malicious O
executables O
. O

The O
malicious O
executables O
all O
called O
out O
to O
the O
same O
URLs O
on O
windowsnewupdates.com O
. O

These O
malware O
samples O
leverage O
the O
user O
agent O
string O
“ O
OPAERA O
” O
, O
the O
same O
one O
identified O
in O
the O
Targeted O
Attacks O
in O
the O
Middle O
East O
Using O
KASPERAGENT O
and O
MICROPSIA O
blog O
. O

Although O
the O
command O
and O
control O
domain O
was O
different O
from O
those O
in O
the O
report O
, O
the O
POST O
and O
GET O
requests O
were O
similar O
and O
included O
/ O
dad5 O
/ O
in O
the O
URL O
string O
. O

In O
addition O
, O
the O
malware O
samples O
included O
the O
kasper O
PDB O
string O
reported O
by O
Unit B-Organization
42 I-Organization
, O
prompting O
us O
to O
conclude O
that O
we O
were O
likely O
looking O
at O
new O
variants O
of O
KASPERAGENT O
. O

Several O
of O
the O
decoy B-Malware
files I-Malware
appeared O
to O
be O
official O
documents O
associated O
with O
the O
Palestinian O
Authority O
– O
the O
body O
that O
governs O
the O
Palestinian O
Territories O
in O
the O
Middle O
East O
. O

We O
do O
not O
know O
whether O
the O
files O
are O
legitimate O
Palestinian O
Authority O
documents O
, O
but O
they O
are O
designed O
to O
look O
official O
. O

Additionally O
, O
most O
of O
the O
decoy B-Malware
files I-Malware
are O
publicly O
available O
on O
news O
websites O
or O
social O
media O
. O

The O
first O
document O
– O
dated O
April O
10 O
, O
2017 O
– O
is O
marked O
“ O
Very O
Secret O
” O
and O
addressed O
to O
Yahya O
Al-Sinwar O
, O
who O
Hamas O
elected O
as O
its O
leader O
in O
Gaza B-Organization
in O
February O
2017 O
. O

Like O
the O
photo O
displayed O
in O
the O
first O
decoy B-Malware
file O
we O
found O
, O
this O
document O
references O
the O
death O
of O
Mazen O
Fuqaha O
. O

The O
Arabic-language O
text O
and O
English O
translation O
of O
the O
document O
are O
available O
in O
ThreatConnect O
here O
. O

A O
screenshot O
of O
the O
file O
is O
depicted O
below O
. O

The O
second O
legible O
file O
, O
dated O
April O
23 O
, O
has O
the O
same O
letterhead O
and O
also O
is O
addressed O
to O
Yahya O
al-Sinwar O
. O

This O
file O
discusses O
the O
supposed O
announcement O
banning O
the O
rival O
Fatah B-Organization
political O
party O
, O
which O
controls O
the O
West O
Bank O
, O
from O
Gaza B-Organization
. O

It O
mentions O
closing O
the O
Fatah O
headquarters O
and O
houses O
that O
were O
identified O
as O
meeting O
places O
as O
well O
as O
the O
arrest O
of O
some O
members O
of O
the O
party O
. O

We O
don’t O
know O
for O
sure O
who O
is O
responsible O
for O
this O
campaign O
, O
but O
digging O
into O
the O
passive O
DNS O
results O
led O
us O
to O
some O
breadcrumbs O
. O

Starting O
with O
195.154.110.237 O
, O
the O
IP O
address O
which O
is O
hosting O
the O
command O
and O
control O
domain O
windowsnewupdates.com O
, O
we O
found O
that O
the O
host O
is O
on O
a O
dedicated O
server O
. O

Using O
our O
Farsight O
DNSDB O
integration O
, O
we O
identified O
other O
domains O
currently O
and O
previously O
hosted O
on O
the O
same O
IP O
. O

Two O
of O
the O
four O
domains O
that O
have O
been O
hosted O
at O
this O
IP O
since O
2016 O
— O
upfile2box.com O
and O
7aga.net O
— O
were O
registered O
by O
a O
freelance O
web O
developer O
in O
Gaza B-Organization
, O
Palestine O
. O

This O
IP O
has O
been O
used O
to O
host O
a O
small O
number O
of O
domains O
, O
some O
of O
which O
were O
registered O
by O
the O
same O
actor B-Organization
, O
suggesting O
the O
IP O
is O
dedicated O
for O
a O
single O
individual O
or O
group B-Organization
’s O
use O
. O

While O
not O
conclusive O
, O
it O
is O
intriguing O
that O
the O
same O
IP O
was O
observed O
hosting O
a O
domain O
ostensibly O
registered O
in O
Gaza B-Organization
AND O
the O
command O
and O
control O
domain O
associated O
with O
a O
series O
of O
targeted O
attacks O
leveraging O
Palestinian O
Authority O
-themed O
decoy O
documents O
referencing O
Gaza O
. O

Just O
like O
we O
can’t O
make O
a O
definitive O
determination O
as O
to O
who O
conducted O
this O
campaign O
, O
we O
do O
not O
know O
for O
sure O
who O
it O
was O
intended O
to O
target O
. O

What O
we O
do O
know O
is O
that O
several O
of O
the O
malicious O
files O
were O
submitted O
to O
a O
public O
malware O
analysis O
site O
from O
the O
Palestinian O
Territories O
. O

This O
tells O
us O
that O
it O
is O
possible O
either O
the O
threat O
actors O
or O
at O
least O
one O
of O
the O
targets O
is O
located O
in O
that O
area O
. O

Additionally O
, O
as O
previously O
mentioned O
, O
the O
decoy B-Malware
document O
subject O
matter O
would O
likely O
be O
of O
interest O
to O
a O
few O
different O
potential O
targets O
in O
the O
Palestinian O
Territories O
. O

Potential O
targets O
such O
as O
Hamas B-Organization
who O
controls O
the O
Gaza B-Organization
strip O
and O
counts O
Mazen O
Fuqaha O
and O
Yahya O
al-Sinwar O
as O
members O
, O
Israel O
which O
is O
accused O
of O
involvement O
in O
the O
assassination O
of O
Mazen O
Fuqaha O
, O
and O
the O
Fatah O
party O
of O
which O
the O
Prime O
Minister O
and O
President O
of O
the O
Palestinian O
Authority O
are O
members O
. O

The O
campaign O
corresponds O
with O
a O
period O
of O
heightened O
tension O
in O
Gaza B-Organization
. O

Hamas B-Organization
, O
who O
has O
historically O
maintained O
control O
over O
the O
strip O
, O
elected O
Yahya O
al-Sinwar O
– O
a O
hardliner O
from O
its O
military O
wing O
– O
as O
its O
leader O
in O
February O
. O

A O
Humanitarian O
Bulletin O
published O
by O
the O
United O
Nations O
’ O
Office O
for O
the O
Coordination O
of O
Humanitarian O
Affairs O
indicates O
in O
March O
2017 O
( O
just O
before O
the O
first O
malware O
samples O
associated O
with O
this O
campaign O
were O
identified O
in O
early O
April O
) O
Hamas O
created O
“ O
a O
parallel O
institution O
to O
run O
local O
ministries O
in O
Gaza B-Organization
, O
” O
further O
straining O
the O
relationship O
between O
Hamas O
and O
the O
Palestinian O
Authority O
who O
governs O
the O
West O
Bank O
. O

After O
this O
announcement O
, O
the O
Palestinian O
Authority O
cut O
salaries O
for O
its O
employees B-Organization
in O
Gaza B-Organization
by O
30 O
percent O
and O
informed O
Israel O
that O
it O
would O
no O
longer O
pay O
for O
electricity O
provided O
to O
Gaza B-Organization
causing O
blackouts O
throughout O
the O
area O
and O
escalating O
tensions O
between O
the O
rival B-Organization
groups I-Organization
. O

Then O
, O
in O
early O
May O
( O
two O
days O
after O
the O
last O
malware O
sample O
was O
submitted O
) O
the O
Palestinian O
Authority O
held O
local O
elections O
in O
the O
West O
Bank O
which O
were O
reportedly O
seen O
as O
a O
test O
for O
the O
Fatah B-Organization
party O
. O

Elections O
were O
not O
held O
in O
Gaza B-Organization
. O

All O
of O
that O
is O
to O
say O
, O
the O
decoy B-Malware
documents I-Malware
leveraged O
in O
this O
campaign O
would O
likely O
be O
relevant O
and O
of O
interest O
to O
a O
variety O
of O
targets O
in O
Israel O
and O
Palestine O
, O
consistent O
with O
previously O
identified O
KASPERAGENT O
targeting O
patterns O
. O

Additionally O
, O
the O
use O
of O
what O
appear O
to O
be O
carefully O
crafted O
documents O
at O
the O
very O
least O
designed O
to O
look O
like O
official O
government O
correspondence O
suggests O
the O
malware O
may O
have O
been O
intended O
for O
a O
government O
employee O
or O
contractor O
who O
would O
be O
interested O
in O
the O
documents O
’ O
subject O
matter O
. O

APT28 B-Organization
: O
New O
Espionage O
Operations O
Target O
Military O
and O
Government O
Organizations O
. O

Recent O
campaigns O
see O
APT28 B-Organization
group I-Organization
return O
to O
covert O
intelligence O
gathering O
operations O
in O
Europe O
and O
South O
America O
. O

After O
making O
headlines O
during O
2016 O
due O
to O
its O
involvement O
in O
cyber O
attacks O
against O
an O
organization O
involved O
in O
the O
U.S. O
presidential O
election O
, O
APT28 B-Organization
( O
aka O
Swallowtail B-Organization
, O
Fancy B-Organization
Bear I-Organization
) O
has O
continued O
to O
mount O
operations O
during O
2017 O
and O
2018 O
. O

The O
espionage B-Organization
group O
, O
which O
according O
to O
the O
U.S. B-Organization
Department I-Organization
of I-Organization
Homeland I-Organization
Security I-Organization
( O
DHS B-Organization
) O
and O
the O
Federal O
Bureau O
of O
Investigation O
( O
FBI B-Organization
) O
is O
linked O
to O
the O
Russian O
government O
, O
returned O
to O
low-key O
intelligence-gathering O
operations O
during O
2017 O
and O
into O
2018 O
, O
targeting O
a O
range O
of O
military O
and O
government O
targets O
in O
Europe O
and O
South O
America O
. O

APT28 B-Organization
has O
been O
active O
since O
at O
least O
January O
2007 O
but O
received O
public O
attention O
in O
a O
major O
way O
during O
2016 O
when O
it O
was O
implicated O
in O
a O
series O
of O
cyber O
attacks O
in O
the O
run O
up O
to O
the O
U.S. O
presidential O
election O
. O

Beginning O
in O
the O
Spring O
of O
2016 O
, O
APT28 B-Organization
sent O
spear-phishing B-Vulnerability
emails I-Vulnerability
to O
political O
targets O
including O
members O
of O
the O
Democratic O
National O
Committee O
( O
DNC O
) O
. O

These O
emails B-Vulnerability
were O
designed O
to O
trick O
recipients O
into O
supposedly O
changing O
their O
email O
passwords O
on O
a O
fake O
webmail O
domain O
. O

The O
attack O
group O
then O
used O
these O
stolen O
credentials O
to O
gain O
access O
to O
the O
DNC O
network O
, O
install O
malware O
, O
move O
across O
the O
network O
, O
and O
steal O
data O
, O
including O
a O
trove O
of O
emails O
. O

The O
compromised O
information O
was O
later O
leaked O
online O
. O

These O
election O
attacks O
signaled O
a O
change O
of O
tactics O
on O
the O
part O
of O
APT28 B-Organization
, O
moving O
away O
from O
their O
prior O
low-key O
intelligence O
gathering O
towards O
more O
overt O
activity O
, O
seemingly O
intended O
to O
destabilize O
and O
disrupt O
victim O
organizations O
and O
countries O
. O

The O
group B-Organization
was O
also O
responsible O
for O
the O
2016 O
attack O
on O
the O
World O
Anti O
Doping O
Agency O
( O
WADA O
) O
and O
the O
leaking O
of O
confidential O
drug O
testing O
information O
. O

In O
keeping O
with O
its O
shift O
to O
more O
overt O
tactics O
, O
the O
group B-Organization
appeared O
to O
publicly O
take O
credit O
for O
the O
attack O
, O
leaking O
the O
information O
on O
a O
website O
using O
the O
name O
“ O
Fancy O
Bears O
” O
, O
an O
industry O
codename O
that O
was O
already O
widely O
used O
for O
the O
group B-Organization
. O

After O
receiving O
an O
unprecedented O
amount O
of O
attention O
in O
2016 O
, O
APT28 B-Organization
has O
continued O
to O
mount O
operations O
during O
2017 O
and O
2018 O
. O

However O
, O
the O
group B-Organization
’s O
activities O
since O
the O
beginning O
of O
2017 O
have O
again O
become O
more O
covert O
and O
appear O
to O
be O
mainly O
motivated O
by O
intelligence O
gathering O
. O

The O
organizations O
targeted O
by O
APT28 B-Organization
during O
2017 O
and O
2018 O
include O
: O
A O
well-known O
international O
organization O
Military O
targets O
in O
Europe O
Governments O
in O
Europe O
A O
government O
of O
a O
South O
American O
country O
An O
embassy O
belonging O
to O
an O
Eastern O
European O
country O
. O

APT28 B-Organization
uses O
a O
number O
of O
tools O
to O
compromise O
its O
targets O
. O

The O
group B-Organization
’s O
primary O
malware O
is O
Sofacy B-Organization
, O
which O
has O
two O
main O
components O
. O

Trojan.Sofacy O
( O
also O
known O
as O
Seduploader O
) O
performs O
basic O
reconnaissance O
on O
an O
infected O
computer O
and O
can O
download O
further O
malware O
. O

Backdoor.SofacyX O
( O
also O
known O
as O
X-Agent O
) O
is O
a O
second O
stage O
piece O
of O
malware O
, O
capable O
of O
stealing O
information O
from O
the O
infected O
computer O
. O

A O
Mac O
version O
of O
the O
Trojan O
also O
exists O
( O
OSX.Sofacy O
) O
. O

APT28 B-Organization
has O
continued O
to O
develop O
its O
tools O
over O
the O
past O
two O
years O
. O

For O
example O
, O
Trojan.Shunnael O
( O
aka O
X-Tunnel O
) O
, O
malware O
used O
to O
maintain O
access O
to O
infected O
networks O
using O
an O
encrypted O
tunnel O
, O
underwent O
a O
rewrite O
to O
.NET O
. O

In O
addition O
to O
this O
, O
as O
reported O
by O
our O
peers O
at O
ESET B-Organization
last O
week O
, O
the O
group B-Organization
has O
also O
begun O
using O
a O
UEFI O
( O
Unified O
Extensible O
Firmware O
Interface O
) O
rootkit O
known O
as O
Lojax O
. O

Because O
the O
rootkit O
resides O
within O
a O
computer O
’s O
flash O
memory O
, O
it O
allows O
the O
attackers O
to O
maintain O
a O
persistent O
presence O
on O
a O
compromised O
machine O
even O
if O
the O
hard O
drive O
is O
replaced O
or O
the O
operating O
system O
is O
reinstalled O
. O

Symantec B-Organization
products O
block O
attempts O
to O
install O
Lojax O
with O
the O
detection O
name O
Trojan.Lojax O
. O

Another O
attack O
group O
, O
Earworm B-Organization
( O
aka O
Zebrocy B-Organization
) O
, O
has O
been O
active O
since O
at O
least O
May O
2016 O
and O
is O
involved O
in O
what O
appears O
to O
be O
intelligence O
gathering O
operations O
against O
military O
targets O
in O
Europe O
, O
Central O
Asia O
, O
and O
Eastern O
Asia O
. O

The O
group B-Organization
uses O
spear-phishing B-Vulnerability
emails I-Vulnerability
to O
compromise O
its O
targets O
and O
infect O
them O
with O
malware O
. O

Earworm B-Organization
uses O
two O
malware O
tools O
. O

Trojan.Zekapab O
is O
a O
downloader O
component O
that O
is O
capable O
of O
carrying O
out O
basic O
reconnaissance O
functions O
and O
downloading O
additional O
malware O
to O
the O
infected O
computer O
. O

Backdoor.Zekapab O
is O
installed O
on O
selected O
infected O
computers O
and O
is O
capable O
of O
taking O
screenshots O
, O
executing O
files O
and O
commands O
, O
uploading O
and O
downloading O
files O
, O
performing O
registry O
and O
file O
system O
operations O
, O
and O
carrying O
out O
system O
information O
tasks O
. O

Earworm B-Organization
has O
also O
on O
occasion O
installed O
additional O
tools O
onto O
infected O
computers O
for O
the O
purposes O
of O
keylogging O
and O
password O
capture O
. O

During O
2016 O
, O
Symantec B-Organization
observed O
some O
overlap O
between O
the O
command O
and O
control O
( O
C&C O
) O
infrastructure O
used O
by O
Earworm B-Organization
and O
the O
C&C O
infrastructure O
used O
by O
Grizzly O
Steppe O
( O
the O
U.S. O
government O
code O
name O
for O
APT28 B-Organization
and O
related O
actors O
) O
, O
implying O
a O
potential O
connection O
between O
Earworm B-Organization
and O
APT28 B-Organization
. O

However O
, O
Earworm B-Organization
also O
appears O
to O
conduct O
separate O
operations O
from O
APT28 B-Organization
and O
thus O
Symantec B-Organization
tracks O
them O
as O
a O
distinct O
group O
. O

It O
is O
now O
clear O
that O
after O
being O
implicated O
in O
the O
U.S. O
presidential O
election O
attacks O
in O
late O
2016 O
, O
APT28 B-Organization
was O
undeterred O
by O
the O
resulting O
publicity O
and O
continues O
to O
mount O
further O
attacks O
using O
its O
existing O
tools O
. O

After O
its O
foray O
into O
overt O
and O
disruptive O
attacks O
in O
2016 O
, O
the O
group B-Organization
has O
subsequently O
returned O
to O
its O
roots O
, O
mounting O
intelligence O
gathering O
operations O
against O
a O
range O
of O
targets O
. O

This O
ongoing O
activity O
and O
the O
fact O
that O
APT28 B-Organization
continues O
to O
refine O
its O
toolset O
means O
that O
the O
group B-Organization
will O
likely O
continue O
to O
pose O
a O
significant O
threat O
to O
nation O
state O
targets O
. O

Symantec B-Organization
has O
had O
the O
following O
protections O
in O
place O
to O
protect O
customers O
against O
APT28 O
attacks O
: O
Trojan.Sofacy O
Backdoor.SofacyX O
Infostealer.Sofacy O
OSX.Sofacy O
Trojan.Shunnael O
Trojan.Lojax O
. O

The O
following O
protections O
are O
in O
place O
to O
protect O
customers O
against O
Earworm O
attacks O
: O
Trojan.Zekapab O
Backdoor.Zekapab O
. O

A O
BREXIT-themed O
lure O
document O
that O
delivers O
ZEKAPAB O
malware O
. O

SNAKEMACKEREL B-Organization
is O
an O
espionage-motivated O
cyber O
threat O
group I-Organization
, O
also O
known O
as O
Sofacy B-Organization
, O
Pawn B-Organization
Storm I-Organization
, O
Sednit B-Organization
, O
Fancy B-Organization
Bear I-Organization
, O
APT28 B-Organization
, O
Group B-Organization
74 I-Organization
, O
Tsar B-Organization
Team I-Organization
, O
and O
Strontium O
. O

Both O
the O
British O
and O
Dutch O
governments O
have O
publicly O
attributed O
SNAKEMACKEREL O
activities O
to O
the O
Russian O
military O
intelligence O
service O
( O
RIS O
) O
and O
have O
linked O
specific O
cyberattacks O
to O
the O
group O
, O
including O
the O
targeting O
of O
the O
Organisation O
for O
the O
Prohibition O
of O
Chemical O
Weapons O
( O
OPCW O
) O
, O
the O
United O
Kingdom O
Defence O
and O
Science O
Technology O
Laboratory O
( O
DSTL O
) O
and O
the O
United O
Kingdom O
Foreign O
and O
Commonwealth O
Office O
( O
FCO O
) O
. O

According O
to O
the O
FBI B-Organization
, O
the O
SNAKEMACKEREL B-Organization
threat O
group O
"is O
part O
of O
an O
ongoing O
campaign O
of O
cyber-enabled O
operations O
directed O
at O
the O
United O
States O
government O
and O
its O
citizens O
. O

These O
cyber O
operations O
have O
included O
spear B-Vulnerability
phishing I-Vulnerability
campaigns O
targeting O
government B-Organization
organizations I-Organization
, O
critical O
infrastructure O
entities O
, O
think O
tanks O
, O
universities O
, O
political B-Organization
organizations I-Organization
, O
and O
corporations O
, O
leading O
to O
the O
theft O
of O
information O
. O

The O
creation O
of O
this O
malicious O
document I-Malware
, O
coming O
on O
the O
same O
day O
that O
the O
UK O
government O
announced O
an O
initial O
agreed O
draft O
of O
the O
BREXIT O
agreement O
, O
suggests O
that O
SNAKEMACKEREL B-Organization
is O
a O
group O
that O
pays O
close O
attention O
to O
political O
affairs O
and O
is O
able O
to O
leverage O
the O
latest O
news O
headlines O
to O
develop O
lure O
documents O
to O
deliver O
firststage O
malware O
, O
such O
as O
Zekapab O
, O
to O
its O
intended O
targets O
. O

The O
theme O
also O
reflects O
the O
targeting O
of O
the O
group B-Organization
which O
primarily O
focuses O
on O
NATO O
members O
, O
countries O
in O
Central O
Asia O
and O
those O
neighboring O
Russia O
. O

Despite O
the O
public O
reporting O
and O
government O
accusations O
, O
SNAKEMACKEREL B-Organization
remains O
highly O
active O
. O

It O
is O
behind O
a O
large O
number O
of O
cyberattacks O
targeting O
global O
aerospace O
and O
defense B-Organization
contractors I-Organization
, O
military O
units O
, O
political O
parties O
, O
the O
International O
Olympic O
Committee O
( O
IOC B-Organization
) O
, O
anti-doping O
agencies I-Organization
, O
government O
departments O
and O
various O
other O
verticals O
. O

NATO O
and O
EU O
member O
countries O
, O
as O
well O
as O
the O
United O
States O
, O
are O
of O
particular O
interest O
to O
the O
group B-Organization
. O

SNAKEMACKEREL B-Organization
operations O
continue O
to O
be O
some O
of O
the O
most O
far-reaching O
and O
sophisticated O
cyber O
espionage O
and O
intelligence O
campaigns O
to O
date O
. O

This O
report O
provides O
a O
technical O
overview O
of O
a O
BREXIT-themed O
lure O
Microsoft O
Office O
document I-Malware
that O
is O
used O
to O
drop O
a O
Delphi O
version O
of O
the O
Zekapab O
first-stage O
malware O
which O
has O
been O
previously O
reported O
by O
iDefense B-Organization
analysts O
. O

However O
, O
additional O
research O
on O
the O
C2 O
server O
109.248.148.42 O
revealed O
a O
new O
.NET O
version O
of O
Zekapab O
that O
is O
designed O
for O
the O
same O
purpose O
. O

iDefense B-Organization
analysts O
recently O
came O
across O
the O
following O
malicious O
document I-Malware
that O
is O
purportedly O
related O
to O
the O
recent O
BREXIT O
negotiations O
between O
the O
UK O
and O
the O
EU O
. O

Brexit O
15.11.2018.docx O
: O
405655be03df45881aa88b55603bef1d O
. O

Of O
note O
, O
the O
Company O
name O
Grizli777 O
is O
indicative O
of O
a O
cracked O
version O
of O
Microsoft B-Malware
Word I-Malware
. O

To O
trick O
the O
targeted O
individual O
into O
enabling O
macros O
, O
the O
attackers O
deliberately O
used O
jumbled-up O
text O
as O
content O
. O

The O
document O
loads O
malicious O
content O
from O
http://109.248.148.42/office/thememl/2012/main/attachedTemplate.dotm O
via O
the O
settings.xml.rels O
component O
that O
is O
embedded O
within O
the O
DOCX O
document O
. O

The O
downloaded O
macro O
component O
includes O
a O
function O
called O
AutoClose() O
as O
well O
as O
two O
payloads O
embedded O
via O
Base64 O
encoded O
strings O
. O

Research B-Organization
on O
the O
malicious O
IP O
address O
109.248.148.42 O
revealed O
two O
different O
.dotm O
components O
: O
Filename O
: O
attachedTemplate.dotm O
MD5 O
: O
018611b879b2bbd886e86b62484494da O
Filename O
: O
templates.dotm O
MD5 O
: O
2a794b55b839b3237482098957877326 O
. O

The O
two O
components O
are O
dropped O
from O
the O
following O
URLs O
respectively O
: O
http://109.248.148.42/office/thememl/2012/main/attachedTemplate.dotm O
http://109.248.148.42/officeDocument/2006/relationships/templates.dotm O
. O

Both O
components O
contain O
an O
identical O
VBA O
macro O
code O
as O
shown O
above O
, O
each O
containing O
two O
different O
embedded O
payloads O
: O
one O
is O
an O
executable O
binary O
file O
and O
the O
other O
is O
a O
.docm O
file O
. O

attachedTemplate.dotm O
dropped O
the O
following O
: O
Filename O
: O
ntslwin.exe O
MD5 O
: O
7e67122d3a052e4755b02965e2e56a2e O
Filename O
: O
~de03fc12a.docm O
MD5 O
: O
9d703d31795bac83c4dd90527d149796 O
. O

templates.dotm O
dropped O
the O
following O
: O
Filename O
: O
ntslwin.exe O
MD5 O
: O
a13c864980159cd9bdc94074b2389dda O
Filename O
: O
~de03fc12a.docm O
MD5 O
: O
9d703d31795bac83c4dd90527d149796 O
. O

The O
second O
macro O
file O
~de03fc12a.docm O
dropped O
includes O
a O
simple O
macro O
to O
execute O
the O
dropped O
executable O
. O

Analysis O
into O
the O
two O
binaries O
shows O
that O
they O
are O
in O
fact O
a O
Delphi O
( O
initially O
UPX O
packed O
) O
and O
.NET O
version O
of O
the O
Zekapab O
first-stage O
malware O
. O

The O
following O
network O
traffic O
is O
performed O
by O
the O
Delphi O
sample O
which O
has O
the O
following O
metadata O
once O
unpacked O
by O
UPX O
: O
Filename O
: O
ntslwin.exe O
MD5 O
: O
f4cab3a393462a57639faa978a75d10a O
. O

Exhibit O
4 O
shows O
the O
network O
traffic O
generated O
by O
the O
sample O
, O
a O
http O
POST O
request O
containing O
the O
system O
information O
collected O
. O

On O
the O
other O
hand O
, O
the O
network O
traffic O
generated O
by O
the O
.NET B-Malware
version O
is O
unencoded O
. O

Both O
versions O
are O
designed O
to O
collect O
system O
information O
and O
running O
processes O
and O
send O
them O
to O
the O
designated O
C2 O
server O
using O
http O
POST O
to O
the O
URI O
used O
in O
both O
cases O
is O
/agr-enum/progress-inform/cube.php?res= O
. O

If O
the O
system O
is O
deemed O
interesting O
, O
the O
next O
stage O
malware O
would O
be O
delivered O
into O
corresponding O
directories O
. O

The O
second-stage O
malware O
is O
delivered O
to O
different O
destinations O
with O
an O
autorun O
registry O
key O
set O
respectively O
. O

For O
the O
Delphi O
version O
, O
the O
following O
registry O
key O
and O
value O
are O
used O
for O
persistence O
: O
Key O
: O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\AudioMgr O
Value O
: O
%AppData%\Video\videodrv.exe O
. O

For O
the O
.NET O
version O
, O
the O
following O
registry O
key O
and O
value O
are O
used O
for O
persistence O
: O
Key O
: O
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\GoogleIndexer O
Value O
: O
%AppData%\Platform\sslwin.exe O
. O

The O
list O
of O
information O
collected O
includes O
: O
Results O
from O
the O
commands O
systeminfo O
and O
tasklist O
Current O
execution O
path O
Capture O
screenshot O
Drive O
enumeration O
Drive O
serial O
number O
. O

The O
code O
for O
downloading O
and O
executing O
the O
next O
stage O
malware O
. O

As O
shown O
, O
the O
delivery O
of O
the O
next-stage O
malware O
is O
dependent O
on O
the O
information O
collected O
. O

To O
mitigate O
the O
threat O
described O
in O
this O
report O
, O
iDefense B-Organization
recommends O
blocking O
access O
to O
the O
IP O
address O
and O
URI O
pattern O
: O
109.248.148.42 O
/agr-enum/progress-inform/cube.php?res= O
. O

For O
threat O
hunting O
, O
iDefense B-Organization
recommends O
searching O
for O
the O
following O
: O
Network O
: O
Presence O
of O
http O
and O
DNS O
traffic O
to O
the O
network O
IOCs O
shared O
above O
. O

System O
: O
Presence O
of O
the O
following O
artifacts O
. O

Persistence O
mechanism O
Registry O
Key O
: O
Key O
: O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\AudioMgr O
Key O
: O
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run\GoogleIndexer O
. O

On O
disk O
artefacts O
File O
with O
the O
full O
path O
: O
%AppData%\Video\videodrv.exe O
File O
with O
the O
full O
path O
: O
%AppData%\Platform\sslwin.exe O
Files O
with O
following O
file O
hashes O
. O

“ O
Cyber O
Conflict O
” O
Decoy O
Document O
Used O
In O
Real O
Cyber O
Conflict O
. O

Cisco B-Organization
Talos I-Organization
discovered O
a O
new O
malicious O
campaign O
from O
the O
well O
known O
actor B-Organization
Group I-Organization
74 I-Organization
( O
aka O
Tsar B-Organization
Team I-Organization
, O
Sofacy B-Organization
, O
APT28 B-Organization
, O
Fancy B-Organization
Bear I-Organization
) O
. O

Ironically O
the O
decoy B-Malware
document I-Malware
is O
a O
deceptive O
flyer O
relating O
to O
the O
Cyber O
Conflict O
U.S. O
conference O
. O

CyCon O
US O
is O
a O
collaborative O
effort O
between O
the O
Army B-Organization
Cyber I-Organization
Institute I-Organization
at O
the O
United O
States O
Military O
Academy I-Organization
and O
the O
NATO O
Cooperative O
Cyber O
Military O
Academy I-Organization
and O
the O
NATO O
Cooperative O
Cyber B-Organization
Defence I-Organization
Centre O
of O
Excellence O
. O

Due O
to O
the O
nature O
of O
this O
document O
, O
we O
assume O
that O
this O
campaign O
targets O
people O
with O
an O
interest O
in O
cyber B-Organization
security O
. O

Unlike O
previous O
campaigns O
from O
this O
actor O
, O
the O
flyer O
does O
not O
contain O
an O
Office B-Vulnerability
exploit I-Vulnerability
or O
a O
0-day O
, O
it O
simply O
contains O
a O
malicious O
Visual O
Basic O
for O
Applications O
( O
VBA B-System
) O
macro O
. O

The O
VBA B-Malware
drops O
and O
executes O
a O
new O
variant O
of O
Seduploader O
. O

This O
reconnaissance O
malware O
has O
been O
used O
by O
Group B-Organization
74 I-Organization
for O
years O
and O
it O
is O
composed O
of O
2 O
files O
: O
a O
dropper O
and O
a O
payload O
. O

The O
dropper O
and O
the O
payload O
are O
quite O
similar O
to O
the O
previous O
versions O
but O
the O
author O
modified O
some O
public O
information O
such O
as O
MUTEX O
name O
, O
obfuscation O
keys.. O
. O

We O
assume O
that O
these O
modifications O
were O
performed O
to O
avoid O
detection O
based O
on O
public O
IOCs O
. O

The O
article O
describes O
the O
malicious O
document I-Malware
and O
the O
Seduploader O
reconnaissance O
malware O
, O
especially O
the O
difference O
with O
the O
previous O
versions O
. O

The O
decoy B-Malware
document I-Malware
is O
a O
flyer O
concerning O
the O
Cyber O
Conflict O
U.S. O
conference O
with O
the O
following O
filename O
Conference_on_Cyber_Conflict.doc O
. O

The O
Office O
document I-Malware
contains O
a O
VBA O
script O
. O

The O
goal O
of O
this O
code O
is O
to O
get O
information O
from O
the O
properties O
of O
the O
document O
( O
"Subject" O
, O
"Company" O
, O
"Category" O
, O
"Hyperlink O
base" O
and O
finally O
"Comments" O
) O
. O

Some O
of O
this O
information O
can O
be O
directly O
extracted O
from O
the O
Windows O
explorer O
by O
looking O
at O
the O
properties O
of O
the O
file O
. O

The O
"Hyperlink O
Base" O
must O
be O
extracted O
using O
another O
tool O
, O
strings O
is O
capable O
of O
obtaining O
this O
by O
looking O
for O
long O
strings O
. O

Pay O
close O
attention O
to O
the O
contents O
of O
these O
fields O
as O
they O
appear O
base64 O
encoded O
. O

This O
extracted O
information O
is O
concatenated O
together O
to O
make O
a O
single O
variable O
. O

This O
variable O
is O
decoded O
with O
the O
base64 O
algorithm O
in O
order O
to O
get O
a O
Windows O
library O
( O
PE O
file O
) O
which O
is O
written O
to O
disk O
. O

The O
file O
is O
named O
netwf.dat O
. O

On O
the O
next O
step O
this O
file O
is O
executed O
by O
rundll32.exe O
via O
the O
KlpSvc O
export O
. O

We O
see O
that O
this O
file O
drops O
2 O
additional O
files O
: O
netwf.bat O
and O
netwf.dll O
. O

The O
final O
part O
of O
the O
VBA O
script O
changes O
the O
properties O
of O
these O
two O
files O
, O
setting O
their O
attributes O
to O
Hidden O
. O

We O
can O
also O
see O
2 O
VBA O
variable O
names O
: O
PathPld O
, O
probably O
for O
Path O
Payload O
, O
and O
PathPldBt O
, O
for O
Path O
Payload O
Batch O
. O

As O
opposed O
to O
previous O
campaigns O
performed O
by O
this O
actor O
, O
this O
latest O
version O
does O
not O
contain O
privilege O
escalation O
and O
it O
simply O
executes O
the O
payload O
and O
configures O
persistence O
mechanisms O
. O

The O
dropper O
installs O
2 O
files O
: O
netwf.bat O
: O
executes O
netwf.dll O
netwf.dll O
: O
the O
payload O
. O

The O
dropper O
implements O
2 O
persistence O
mechanisms O
: O
HKCU\Environment\UserInitMprLogonScript O
to O
execute O
the O
netwf.bat O
file O
COM O
Object O
hijack O
of O
the O
following O
CLSID O
: O
{BCDE0395-E52F-467C-8E3D-C4579291692E} O
, O
the O
CLSID O
of O
the O
class O
MMDeviceEnumerator O
. O

These O
2 O
techniques O
have O
also O
been O
previously O
used O
by O
this O
actor B-Organization
. O

Finally O
the O
payload O
is O
executed O
by O
rundll32.exe O
( O
and O
the O
ordinal O
#1 O
in O
argument O
) O
or O
by O
explorer.exe O
if O
the O
COM O
Object O
hijack O
is O
performed O
. O

In O
this O
case O
, O
explorer.exe O
will O
instance O
the O
MMDeviceEnumerator O
class O
and O
will O
execute O
the O
payload O
. O

The O
payload O
features O
are O
similar O
to O
the O
previous O
versions O
of O
Seduploader O
. O

We O
can O
compare O
it O
to O
the O
sample O
e338d49c270baf64363879e5eecb8fa6bdde8ad9 O
used O
in O
May O
2017 O
by O
Group B-Organization
74 I-Organization
. O

Of O
the O
195 O
functions O
of O
the O
new O
sample O
, O
149 O
are O
strictly O
identical O
, O
16 O
match O
at O
90% O
and O
2 O
match O
at O
80% O
. O

In O
the O
previous O
campaign O
where O
adversaries O
used O
Office B-Vulnerability
document I-Malware
exploits I-Vulnerability
as O
an O
infection O
vector O
, O
the O
payload O
was O
executed O
in O
the O
Office O
word O
process O
. O

In O
this O
campaign O
, O
adversaries O
did O
not O
use O
any O
exploit O
. O

Instead O
,the O
payload O
is O
executed O
in O
standalone O
mode O
by O
rundll32.exe O
. O

Adversaries B-Organization
also O
changed O
some O
constants O
, O
such O
as O
the O
XOR O
key O
used O
in O
the O
previous O
version O
. O

The O
key O
in O
our O
version O
is O
: O
key=b"\x08\x7A\x05\x04\x60\x7c\x3e\x3c\x5d\x0b\x18\x3c\x55\x64" O
. O

The O
MUTEX O
name O
is O
different O
too O
: O
FG00nxojVs4gLBnwKc7HhmdK0h O
. O

Here O
are O
some O
of O
the O
Seduploader O
features O
: O
Screenshot O
capture O
( O
with O
the O
GDI O
API I-System
) O
; O
data/configuration O
Exfiltration O
; O
Execution O
of O
code O
; O
File O
downloading O
; O
The O
Command O
& O
Control O
( O
CC O
) O
of O
the O
analysed O
sample O
is O
myinvestgroup[.]com O
. O

During O
the O
investigation O
, O
the O
server O
did O
not O
provide O
any O
configuration O
to O
the O
infected O
machines O
. O

Based O
on O
the O
metadata O
of O
the O
Office O
documents I-Malware
and O
the O
PE O
files O
, O
the O
attackers B-Organization
had O
created O
the O
file O
on O
Wednesday O
, O
the O
4th O
of O
October O
. O

Analysis O
of O
this O
campaign O
shows O
us O
once O
more O
that O
attackers B-Organization
are O
creative O
and O
use O
the O
news O
to O
compromise O
the O
targets O
. O

This O
campaign O
has O
most O
likely O
been O
created O
to O
allow O
the O
targeting O
of O
people O
linked O
to O
or O
interested O
by O
cybersecurity O
, O
so O
probably O
the O
people O
who O
are O
more O
sensitive O
to O
cybersecurity O
threats O
. O

In O
this O
case O
, O
Group B-Organization
74 I-Organization
did O
not O
use O
an O
exploit O
or O
any O
0-day O
but O
simply O
used O
scripting O
language O
embedded O
within O
the O
Microsoft B-Malware
Office I-Malware
document I-Malware
. O

Due O
to O
this O
change O
, O
the O
fundamental O
compromise O
mechanism O
is O
different O
as O
the O
payload O
is O
executed O
in O
a O
standalone O
mode O
. O

The O
reasons O
for O
this O
are O
unknown O
, O
but O
, O
we O
could O
suggest O
that O
they O
did O
not O
want O
to O
utilize O
any O
exploits O
to O
ensure O
they O
remained O
viable O
for O
any O
other O
operations O
. O

Actors O
will O
often O
not O
use O
exploits O
due O
to O
the O
fact O
that O
researchers O
can O
find O
and O
eventually O
patch O
these O
which O
renders O
the O
actors O
weaponized O
platforms O
defunct O
. O

Additionally O
the O
author O
did O
some O
small O
updates O
after O
publications O
from O
the O
security B-Organization
community I-Organization
, O
again O
this O
is O
common O
for O
actors O
of O
this O
sophisticated O
nature O
, O
once O
their O
campaigns O
have O
been O
exposed O
they O
will O
often O
try O
to O
change O
tooling O
to O
ensure O
better O
avoidance O
. O

For O
example O
the O
actor O
changed O
the O
XOR O
key O
and O
the O
MUTEX O
name O
. O

APT28 B-Organization
: O
AT O
THE O
CENTER O
OF O
THE O
STORM O
. O

The O
Democratic O
National O
Committee O
’s O
( O
DNC O
) O
June O
2016 O
announcement O
attributing O
its O
network O
breach O
to O
the O
Russian O
Government O
triggered O
an O
international O
debate O
over O
Russia O
’s O
sponsorship O
of O
information O
operations O
against O
the O
U.S. O
Our O
visibility O
into O
the O
operations O
of O
APT28 B-Organization
- O
a O
group O
we O
believe O
the O
Russian O
Government O
sponsors O
- O
has O
given O
us O
insight O
into O
some O
of O
the O
government O
’s O
targets O
, O
as O
well O
as O
its O
objectives O
and O
the O
activities O
designed O
to O
further O
them O
. O

We O
have O
tracked O
and O
profiled O
this O
group O
through O
multiple O
investigations O
, O
endpoint O
and O
network O
detections O
, O
and O
continuous O
monitoring O
. O

Our O
visibility O
into O
APT28 B-Organization
’s O
operations O
, O
which O
date O
to O
at O
least O
2007 O
, O
has O
allowed O
us O
to O
understand O
the O
group O
’s O
malware O
, O
operational O
changes O
, O
and O
motivations O
. O

This O
intelligence O
has O
been O
critical O
to O
protecting O
and O
informing O
our O
clients O
, O
exposing O
this O
threat O
, O
and O
strengthening O
our O
confidence O
in O
attributing O
APT28 B-Organization
to O
the O
Russian O
Government O
. O

On O
December O
29 O
, O
2016 O
, O
the O
Department B-Organization
of I-Organization
Homeland I-Organization
Security I-Organization
( O
DHS B-Organization
) O
and O
Federal O
Bureau O
of O
Investigation O
( O
FBI B-Organization
) O
released O
a O
Joint O
Analysis O
Report O
confirming O
FireEye B-Organization
’s I-Organization
long O
held O
public O
assessment O
that O
the O
Russian O
Government I-Organization
sponsors O
APT28 B-Organization
. O

Since O
at O
least O
2007 O
, O
APT28 B-Organization
has O
engaged O
in O
extensive O
operations O
in O
support O
of O
Russian O
strategic O
interests O
. O

The O
group B-Organization
, O
almost O
certainly O
compromised O
of O
a O
sophisticated O
and O
prolific O
set O
of O
developers O
and O
operators O
, O
has O
historically O
collected O
intelligence O
on O
defense O
and O
geopolitical O
issues O
. O

APT28 B-Organization
espionage O
activity O
has O
primarily O
targeted O
entities O
in O
the O
U.S. O
, O
Europe O
, O
and O
the O
countries O
of O
the O
former O
Soviet O
Union O
, O
including O
governments O
and O
militaries O
, O
defense O
attaches O
, O
media B-Organization
entities I-Organization
, O
and O
dissidents B-Organization
and O
figures O
opposed O
to O
the O
current O
Russian O
Government O
. O

Over O
the O
past O
two O
years O
, O
Russia O
appears O
to O
have O
increasingly O
leveraged O
APT28 B-Organization
to O
conduct O
information O
operations O
commensurate O
with O
broader O
strategic O
military O
doctrine O
. O

After O
compromising O
a O
victim O
organization O
, O
APT28 B-Organization
will O
steal O
internal O
data O
that O
is O
then O
leaked O
to O
further O
political O
narratives O
aligned O
with O
Russian O
interests O
. O

To O
date O
these O
have O
included O
the O
conflict O
in O
Syria O
, O
NATO-Ukraine O
relations O
, O
the O
European O
Union O
refugee O
and O
migrant O
crisis O
, O
the O
2016 O
Olympics O
and O
Paralympics O
Russian O
athlete O
doping O
scandal O
, O
public O
accusations O
regarding O
Russian O
state-sponsored O
hacking O
, O
and O
the O
2016 O
U.S. O
presidential O
election O
. O

This O
report O
details O
our O
observations O
of O
APT28 B-Organization
’s O
targeting O
, O
and O
our O
investigation O
into O
a O
related O
breach O
. O

We O
also O
provide O
an O
update O
on O
shifts O
in O
the O
group B-Organization
’s O
tool O
development O
and O
use O
, O
and O
summarize O
the O
tactics O
APT28 B-Organization
employs O
to O
compromise O
its O
victims O
. O

In O
October O
2014 O
, O
FireEye B-Organization
released O
APT28 B-Organization
: O
A O
Window O
into O
Russia O
’s O
Cyber O
Espionage O
Operations? O
, O
and O
characterized O
APT28 B-Organization
’s O
activity O
as O
aligning O
with O
the O
Russian O
Government O
’s O
strategic O
intelligence O
requirements O
. O

While O
tracking O
APT28 B-Organization
, O
we O
noted O
the O
group B-Organization
’s O
interest O
in O
foreign O
governments O
and O
militaries O
, O
particularly O
those O
of O
European O
and O
Eastern O
European O
nations O
, O
as O
well O
as O
regional O
security O
organizations I-Organization
, O
such O
as O
the O
North O
Atlantic O
Treaty O
Organization O
( O
NATO O
) O
and O
the O
Organization O
for O
Security O
and O
Cooperation O
in O
Europe O
( O
OSCE O
) O
, O
among O
others O
. O

Table O
1 O
highlights O
some O
recent O
examples O
of O
this O
activity O
. O

OSCE O
: O
NOVEMBER O
2016 O
, O
The O
OSCE O
confirmed O
that O
it O
had O
suffered O
an O
intrusion O
, O
which O
a O
Western O
intelligence O
service O
attributed O
to O
APT28 B-Organization
. O

Germany O
's O
Christian O
Democratic O
Union O
( O
CDU O
) O
: O
APRIL O
- O
MAY O
2016 O
, O
Researchers O
at O
Trend B-Organization
Micro I-Organization
observed O
APT28 B-Organization
establish O
a O
fake O
CDU O
email O
server O
and O
launch O
phishing B-Vulnerability
emails I-Vulnerability
against O
CDU O
members O
in O
an O
attempt O
to O
obtain O
their O
email O
credentials O
and O
access O
their O
accounts O
. O

Pussy O
Riot O
AUGUST O
: O
2015 O
, O
APT28 B-Organization
targets O
Russian O
rockers O
and O
dissidents O
Pussy O
Riot O
via O
spear-phishing B-Vulnerability
emails I-Vulnerability
. O

NATO O
, O
Afghan O
Ministry O
of O
Foreign O
Affairs O
, O
Pakistani B-Organization
Military I-Organization
: O
JULY O
2015 O
, O
APT28 B-Organization
used O
two O
domains O
( O
nato-news.com O
and O
bbc-news.org O
) O
to O
host O
an O
Adobe B-Vulnerability
Flash I-Vulnerability
zero-day I-Vulnerability
exploit I-Vulnerability
to O
target O
NATO O
, O
the O
Afghan O
Ministry O
of O
Foreign O
Affairs O
, O
and O
the O
Pakistani O
military O
. O

German O
Bundestag O
& O
Political O
Parties O
: O
JUNE O
2015 O
, O
Germany O
’s O
Federal O
Office O
for O
Security O
in O
Information O
Technology O
( O
BSI O
) O
announced O
that O
APT28 B-Organization
was O
likely O
responsible O
for O
the O
spear B-Vulnerability
phishing I-Vulnerability
emails I-Vulnerability
sent O
to O
members O
of O
several O
German O
political O
parties O
. O

The O
head O
of O
Germany O
’s O
domestic O
intelligence O
agency O
, O
Bundesamt O
für O
Verfassungsschutz O
( O
BfV O
) O
, O
also O
attributed O
the O
June O
2015 O
compromise O
of O
the O
Bundestag O
’s O
networks O
to O
APT28 B-Organization
. O

Kyrgyzstan O
Ministry O
of O
Foreign O
Affairs O
: O
OCTOBER O
2014 O
THROUGH O
SEPTEMBER O
2015 O
, O
FireEye B-Organization
iSight O
Intelligence O
identified O
changes O
made O
to O
domain O
name O
server O
( O
DNS O
) O
records O
that O
suggest O
that O
APT28 B-Organization
intercepted O
email O
traffic O
from O
the O
Kyrgyzstan O
Ministry O
of O
Foreign O
Affairs O
after O
maliciously O
modifying O
DNS O
records O
of O
the O
ministry O
’s O
authoritative O
DNS O
servers O
. O

Polish B-Organization
Government O
& O
Power O
Exchange O
websites O
: O
JUNE O
AND O
SEPTEMBER O
2014 O
, O
APT28 B-Organization
employed O
“ O
Sedkit O
” O
in O
conjunction O
with O
strategic B-Vulnerability
web I-Vulnerability
compromises I-Vulnerability
to O
deliver O
“ O
Sofacy B-Organization
” O
malware O
on O
Polish O
Government O
websites O
, O
and O
the O
websites O
of O
Polish O
energy O
company O
Power O
Exchange O
. O

On O
September O
13 O
, O
WADA B-Organization
confirmed O
that O
APT28 B-Organization
had O
compromised O
its O
networks O
and O
accessed O
athlete O
medical O
data O
. O

On O
September O
12 O
, O
2016 O
, O
the O
“ O
Fancy O
Bears O
’ O
Hack O
Team O
” O
persona O
claimed O
to O
have O
compromised O
WADA O
and O
released O
athletes O
’ O
medical O
records O
as O
“ O
proof O
of O
American O
athletes O
taking O
doping. O
” O
The O
DNC O
announced O
it O
had O
suffered O
a O
network O
compromise O
and O
that O
a O
subsequent O
investigation O
found O
evidence O
of O
two O
breaches O
, O
attributed O
to O
APT28 B-Organization
and O
APT29 B-Organization
. O

FireEye B-Organization
analyzed O
the O
malware O
found O
on O
DNC O
networks O
and O
determined O
that O
it O
was O
consistent O
with O
our O
previous O
observations O
of O
APT28 B-Organization
tools O
. O

In O
June O
2016 O
, O
shortly O
after O
the O
DNC O
’s O
announcement O
, O
the O
Guccifer O
2.0 O
persona O
claimed O
responsibility O
for O
the O
DNC O
breach O
and O
leaked O
documents O
taken O
from O
the O
organization O
’s O
network O
. O

Guccifer O
2.0 O
continued O
to O
leak O
batches O
of O
DNC O
documents O
through O
September O
. O

Investigators B-Organization
found O
that O
John O
Podesta O
, O
Hillary O
Clinton O
’s O
presidential O
campaign O
chairman O
, O
was O
one O
of O
thousands O
of O
individuals O
targeted O
in O
a O
mass O
phishing B-Vulnerability
scheme O
using O
shortened O
URLs O
that O
security O
researchers O
attributed O
to O
APT28 B-Organization
. O

Throughout O
October O
and O
into O
early O
November O
, O
WikiLeaks B-Organization
published O
34 O
batches O
of O
email O
correspondence O
stolen O
from O
John O
Podesta O
’s O
personal O
email O
account O
. O

Correspondence O
of O
other O
individuals O
targeted O
in O
the O
same O
phishing O
campaign O
, O
including O
former O
Secretary O
of O
State O
Colin O
Powell O
and O
Clinton O
campaign O
staffer O
William O
Rinehart O
, O
were O
published O
on O
the O
“ O
DC O
Leaks O
” O
website O
. O

In O
July O
, O
the O
DCCC O
announced O
that O
it O
was O
investigating O
an O
ongoing O
“ O
cybersecurity O
incident O
” O
that O
the O
FBI B-Organization
believed O
was O
linked O
to O
the O
compromise O
of O
the O
DNC O
. O

House O
Speaker O
Nancy O
Pelosi O
later O
confirmed O
that O
the O
DCCC O
had O
suffered O
a O
network O
compromise O
. O

Investigators B-Organization
indicated O
that O
the O
actors B-Organization
may O
have O
gained O
access O
to O
DCCC O
systems O
as O
early O
as O
March O
. O

In O
August O
, O
the O
Guccifer O
2.0 O
persona O
contacted O
reporters O
covering O
U.S. O
House O
of O
Representative O
races O
to O
announce O
newly O
leaked O
documents O
from O
the O
DCCC O
pertaining O
to O
Democratic O
candidates O
. O

From O
August O
to O
October O
, O
Guccifer O
2.0 O
posted O
several O
additional O
installments O
of O
what O
appear O
to O
be O
internal O
DCCC O
documents O
on O
“ O
his O
” O
WordPress O
site O
. O

In O
February O
, O
FireEye B-Organization
identified O
CORESHELL O
traffic O
beaconing O
from O
TV5Monde O
’s O
network O
, O
confirming O
that O
APT28 B-Organization
had O
compromised O
TV5Monde O
’s O
network O
. O

In O
April O
2015 O
, O
alleged O
pro-ISIS O
hacktivist O
group O
CyberCaliphate O
defaced O
TV5Monde O
’s O
websites O
and O
social O
media O
profiles O
and O
forced O
the O
company O
’s O
11 O
broadcast O
channels O
offline O
. O

FireEye B-Organization
identified O
overlaps O
between O
the O
domain O
registration O
details O
of O
CyberCaliphate O
’s O
website O
and O
APT28 B-Organization
infrastructure O
. O

Ukrainian O
officials O
revealed O
that O
the O
investigation O
into O
the O
compromise O
of O
the O
CEC O
’s O
internal O
network O
identified O
malware O
traced O
to O
APT28 B-Organization
. O

During O
the O
May O
2014 O
Ukrainian O
presidential O
election O
, O
purported O
pro-Russian O
hacktivists O
CyberBerkut O
conducted O
a O
series O
of O
malicious O
activities O
against O
the O
CEC O
including O
a O
system O
compromise O
, O
data O
destruction O
, O
a O
data O
leak O
, O
a O
distributed O
denial-of-service O
( O
DDoS O
) O
attack O
, O
and O
an O
attempted O
defacement O
of O
the O
CEC O
website O
with O
fake O
election O
results O
. O

As O
news O
of O
the O
DNC O
breach O
spread O
, O
APT28 B-Organization
was O
preparing O
for O
another O
set O
of O
operations O
: O
countering O
the O
condemnation O
that O
Russia O
was O
facing O
after O
doping O
allegations O
and O
a O
threatened O
blanket O
ban O
of O
the O
Russian O
team O
from O
the O
upcoming O
Rio O
Games O
. O

Russia O
, O
like O
many O
nations O
, O
has O
long O
viewed O
success O
in O
the O
Olympic O
Games O
as O
a O
source O
of O
national O
prestige O
and O
soft O
power O
on O
the O
world O
stage O
. O

The O
doping O
allegations O
and O
prospective O
ban O
from O
the O
Games O
further O
ostracized O
Russia O
, O
and O
likely O
provided O
motivation O
to O
actively O
counter O
the O
allegations O
by O
attempting O
to O
discredit O
anti-doping O
agencies O
and O
policies O
. O

Our O
investigation O
of O
APT28 B-Organization
’s O
compromise O
of O
WADA O
’s O
network O
, O
and O
our O
observations O
of O
the O
surrounding O
events O
reveal O
how O
Russia O
sought O
to O
counteract O
a O
damaging O
narrative O
and O
delegitimize O
the O
institutions O
leveling O
criticism O
. O

Since O
releasing O
our O
2014 O
report O
, O
we O
continue O
to O
assess O
that O
APT28 B-Organization
is O
sponsored O
by O
the O
Russian B-Organization
Government I-Organization
. O

We O
further O
assess O
that O
APT28 B-Organization
is O
the O
group O
responsible O
for O
the O
network O
compromises O
of O
WADA O
and O
the O
DNC O
and O
other O
entities O
related O
to O
the O
2016 O
U.S. O
presidential O
election O
cycle O
. O

These O
breaches O
involved O
the O
theft O
of O
internal O
data O
- O
mostly O
emails O
– O
that O
was O
later O
strategically O
leaked O
through O
multiple O
forums O
and O
propagated O
in O
a O
calculated O
manner O
almost O
certainly O
intended O
to O
advance O
particular O
Russian O
Government O
aims O
. O

In O
a O
report O
released O
on O
January O
7 O
2017 O
, O
the O
U.S. B-Organization
Directorate O
of O
National B-Organization
Intelligence I-Organization
described O
this O
activity O
as O
an O
“ O
influence O
campaign. O
” O
This O
influence O
campaign O
- O
a O
combination O
of O
network O
compromises O
and O
subsequent O
data O
leaks O
- O
aligns O
closely O
with O
the O
Russian O
military O
’s O
publicly O
stated O
intentions O
and O
capabilities O
. O

Influence O
operations O
, O
also O
frequently O
called O
“ O
information O
operations O
, O
” O
have O
a O
long O
history O
of O
inclusion O
in O
Russian O
strategic O
doctrine O
, O
and O
have O
been O
intentionally O
developed O
, O
deployed O
, O
and O
modernized O
with O
the O
advent O
of O
the O
internet O
. O

The O
recent O
activity O
in O
the O
U.S. O
is O
but O
one O
of O
many O
instances O
of O
Russian O
Government I-Organization
influence O
operations O
conducted O
in O
support O
of O
strategic O
political O
objectives O
, O
and O
it O
will O
not O
be O
the O
last O
. O

As O
the O
2017 O
elections O
in O
Europe O
approach O
- O
most O
notably O
in O
Germany O
, O
France O
, O
and O
the O
Netherlands O
- O
we O
are O
already O
seeing O
the O
makings O
of O
similarly O
concerted O
efforts O
. O

In O
our O
2014 O
report O
, O
we O
identified O
APT28 B-Organization
as O
a O
suspected O
Russian O
government-sponsored O
espionage O
actor I-Organization
. O

We O
came O
to O
this O
conclusion O
in O
part O
based O
on O
forensic O
details O
left O
in O
the O
malware O
that O
APT28 B-Organization
had O
employed O
since O
at O
least O
2007 O
. O

We O
have O
provided O
an O
updated O
version O
of O
those O
conclusions O
, O
a O
layout O
of O
the O
tactics O
that O
they O
generally O
employ O
, O
as O
well O
as O
observations O
of O
apparent O
tactical O
shifts O
. O

For O
full O
details O
, O
please O
reference O
our O
2014 O
report O
, O
APT28 B-Organization
: O
A O
Window O
into O
Russia O
’s O
Cyber O
Espionage O
Operations O
? O
APT28 B-Organization
employs O
a O
suite O
of O
malware O
with O
features O
indicative O
of O
the O
group B-Organization
’s O
plans O
for O
continued O
operations O
, O
as O
well O
as O
the O
group B-Organization
’s O
access O
to O
resources O
and O
skilled O
developers O
. O

CHOPSTICK B-System
: O
backdoor B-System
, O
Xagent B-System
, O
webhp O
, O
SPLM B-System
. O

EVILTOSS B-System
: O
backdoor B-Malware
, O
Sedreco O
, O
AZZY B-System
, O
Xagent B-System
, O
ADVSTORESHELL B-System
, O
NETUI O
. O

GAMEFISH B-Organization
: O
backdoor O
, O
Sednit B-System
, O
Seduploader B-System
, O
JHUHUGIT B-System
, O
Sofacy B-Organization
. O

SOURFACE B-Organization
: O
downloader O
, O
Older O
version O
of O
CORESHELL B-Organization
, O
Sofacy B-Organization
. O

OLDBAIT O
: O
credential O
harvester O
, O
Sasfis O
. O

CORESHELL B-Organization
: O
downloader O
, O
Newer O
version O
of O
SOURFACE B-System
, O
Sofacy B-Organization
. O

APT28 B-Organization
continues O
to O
evolve O
its O
toolkit O
and O
refine O
its O
tactics O
in O
what O
is O
almost O
certainly O
an O
effort O
to O
protect O
its O
operational O
effectiveness O
in O
the O
face O
of O
heightened O
public O
exposure O
and O
scrutiny O
. O

In O
addition O
to O
the O
continued O
evolution O
of O
the O
group O
’s O
first O
stage O
tools O
, O
we O
have O
also O
noted O
APT28 B-Organization
: O
Leveraging O
zero-day B-Vulnerability
vulnerabilities I-Vulnerability
in O
Adobe B-System
Flash I-Vulnerability
Player I-Vulnerability
, O
Java B-Vulnerability
, O
and O
Windows O
, O
including O
CVE-2015-1701 B-Vulnerability
, O
CVE-2015-2424 O
, O
CVE-2015-2590 O
, O
CVE-2015-3043 O
, O
CVE-2015-5119 B-Vulnerability
, O
and O
CVE-2015-7645 O
. O

Using O
a O
profiling O
script O
to O
deploy O
zero-days B-System
and O
other O
tools O
more O
selectively O
, O
decreasing O
the O
chance O
that O
researchers O
and O
others O
will O
gain O
access O
to O
the O
group O
’s O
tools O
. O

Increasing O
reliance O
on O
public O
code O
depositories O
, O
such O
as O
Carberp B-System
, O
PowerShell B-System
Empire I-System
, O
P.A.S. B-System
webshell I-System
, O
Metasploit B-System
modules I-System
, O
and O
others O
in O
a O
likely O
effort O
to O
accelerate O
their O
development O
cycle O
and O
provide O
plausible O
deniability O
. O

Obtaining O
credentials O
through O
fabricated O
Google B-Organization
App O
authorization O
and O
Oauth O
access O
requests O
that O
allow O
the O
group O
to O
bypass O
two-factor O
authentication O
and O
other O
security O
measures O
. O

Moving O
laterally O
through O
a O
network O
relying O
only O
on O
legitimate O
tools O
that O
already O
exist O
within O
the O
victims O
’ O
systems O
, O
at O
times O
forgoing O
their O
traditional O
toolset O
for O
the O
duration O
of O
the O
compromise O
. O

Threat B-Organization
Group I-Organization
4127 O
Targets O
Hillary O
Clinton O
Presidential O
Campaign O
. O

The O
Hillary O
Clinton O
email O
leak O
was O
the O
center O
of O
the O
latest O
scandal O
in O
the O
news O
caused O
by O
Threat B-Organization
Group-4127 I-Organization
( O
TG-4127 B-Organization
) O
. O

SecureWorks B-Organization
Counter I-Organization
Threat I-Organization
Unit I-Organization
( O
CTU B-Organization
) O
researchers O
track O
the O
activities O
of O
Threat B-Organization
Group-4127 I-Organization
, O
which O
targets O
governments O
, O
military O
, O
and O
international B-Organization
non-governmental I-Organization
organizations I-Organization
( O
NGOs O
) O
. O

Components O
of O
TG-4127 B-Organization
operations O
have O
been O
reported O
under O
the O
names O
APT28 B-Organization
, O
Sofacy B-Organization
, O
Sednit B-Organization
, O
and O
Pawn B-Organization
Storm I-Organization
. O

CTU B-Organization
researchers O
assess O
with O
moderate O
confidence O
that O
the O
group B-Organization
is O
operating O
from O
the O
Russian O
Federation O
and O
is O
gathering O
intelligence O
on O
behalf O
of O
the O
Russian O
government O
. O

Between O
October O
2015 O
and O
May O
2016 O
, O
CTU B-Organization
researchers O
analyzed O
8,909 O
Bitly B-System
links O
that O
targeted O
3,907 O
individual O
Gmail O
accounts O
and O
corporate O
and O
organizational O
email O
accounts O
that O
use O
Gmail O
as O
a O
service O
. O

In O
March O
2016 O
, O
CTU B-Organization
researchers O
identified O
a O
spearphishing B-Vulnerability
campaign O
using O
Bitly B-System
accounts O
to O
shorten O
malicious O
URLs O
. O

The O
targets O
were O
similar O
to O
a O
2015 O
TG-4127 B-Organization
campaign O
— O
individuals O
in O
Russia O
and O
the O
former O
Soviet O
states O
, O
current O
and O
former O
military O
and O
government B-Organization
personnel I-Organization
in O
the O
U.S. O
and O
Europe O
, O
individuals O
working O
in O
the O
defense O
and O
government O
supply O
chain O
, O
and O
authors O
and O
journalists O
— O
but O
also O
included O
email O
accounts O
linked O
to O
the O
November O
2016 O
United O
States O
presidential O
election O
. O

Specific O
targets O
include O
staff O
working O
for O
or O
associated O
with O
Hillary O
Clinton's O
presidential O
campaign O
and O
the O
Democratic O
National O
Committee O
( O
DNC O
) O
, O
including O
individuals O
managing O
Clinton's O
communications O
, O
travel O
, O
campaign O
finances O
, O
and O
advising O
her O
on O
policy O
. O

The O
short O
links O
in O
the O
spearphishing B-Vulnerability
emails I-Vulnerability
redirected O
victims O
to O
a O
TG-4127 O
controlled O
URL O
that O
spoofed O
a O
legitimate O
Google B-Organization
domain O
. O

A O
Base64 O
encoded O
string O
containing O
the O
victim's O
full O
email O
address O
is O
passed O
with O
this O
URL O
, O
prepopulating O
a O
fake O
Google O
login O
page O
displayed O
to O
the O
victim O
. O

If O
a O
victim O
enters O
their O
credentials O
, O
TG-4127 B-Organization
can O
establish O
a O
session O
with O
Google B-Organization
and O
access O
the O
victim's O
account O
. O

The O
threat B-Organization
actors O
may O
be O
able O
to O
keep O
this O
session O
alive O
and O
maintain O
persistent O
access O
. O

The O
Hillary O
for O
America O
presidential O
campaign O
owns O
the O
hillaryclinton.com O
domain O
, O
which O
is O
used O
for O
the O
campaign O
website O
( O
www.hillaryclinton.com O
) O
and O
for O
email O
addresses O
used O
by O
campaign O
staff O
. O

An O
examination O
of O
the O
hillaryclinton.com O
DNS O
records O
shows O
that O
the O
domain's O
MX O
records O
, O
which O
indicate O
the O
mail O
server O
used O
by O
the O
domain O
, O
point O
to O
aspmx.l.google.com O
, O
the O
mail O
server O
used O
by O
Google B-Organization
Apps I-System
. O

Google B-Organization
Apps O
allows O
organizations O
to O
use O
Gmail O
as O
their O
organizational O
mail O
solution O
. O

TG-4127 B-Organization
exploited O
the O
Hillary O
for O
America O
campaign's O
use O
of O
Gmail B-System
and O
leveraged O
campaign O
employees' O
expectation O
of O
the O
standard O
Gmail O
login O
page O
to O
access O
their O
email O
account O
. O

When O
presented O
with O
TG-4127 B-Organization
's O
spoofed O
login O
page O
, O
victims O
might O
be O
convinced O
it O
was O
the O
legitimate O
login O
page O
for O
their O
hillaryclinton.com O
email O
account O
. O

CTU B-Organization
researchers O
observed O
the O
first O
short O
links O
targeting O
hillaryclinton.com O
email O
addresses O
being O
created O
in O
mid-March O
2016 O
; O
the O
last O
link O
was O
created O
in O
mid-May O
. O

During O
this O
period O
, O
TG-4127 B-Organization
created O
213 O
short O
links O
targeting O
108 O
email O
addresses O
on O
the O
hillaryclinton.com O
domain O
. O

Through O
open-source O
research O
, O
CTU B-Organization
researchers O
identified O
the O
owners O
of O
66 O
of O
the O
targeted O
email O
addresses O
. O

There O
was O
no O
open-source O
footprint O
for O
the O
remaining O
42 O
addresses O
, O
suggesting O
that O
TG-4127 B-Organization
acquired O
them O
from O
another O
source O
, O
possibly O
other O
intelligence O
activity O
. O

The O
identified O
email O
owners I-Organization
held O
a O
wide O
range O
of O
responsibilities O
within O
the O
Hillary O
for O
America O
campaign O
, O
extending O
from O
senior O
figures O
to O
junior O
employees O
and O
the O
group O
mailboxes O
for O
various O
regional O
offices O
. O

Targeted O
senior O
figures O
managed O
communications O
and O
media O
affairs O
, O
policy O
, O
speech O
writing O
, O
finance O
, O
and O
travel O
, O
while O
junior O
figures O
arranged O
schedules O
and O
travel O
for O
Hillary O
Clinton's O
campaign O
trail O
. O

Targets O
held O
the O
following O
titles O
: O
National O
political O
director O
Finance O
director O
Director O
of O
strategic O
communications O
Director O
of O
scheduling O
Director O
of O
travel O
Traveling O
press O
secretary O
Travel O
coordinator O
. O

Publicly O
available O
Bitly B-System
data O
reveals O
how O
many O
of O
the O
short O
links O
were O
clicked O
, O
likely O
by O
a O
victim O
opening O
a O
spearphishing B-Vulnerability
email O
and O
clicking O
the O
link O
to O
the O
fake O
Gmail O
login O
page O
. O

Only O
20 O
of O
the O
213 O
short O
links O
have O
been O
clicked O
as O
of O
this O
publication O
. O

Eleven O
of O
the O
links O
were O
clicked O
once O
, O
four O
were O
clicked O
twice O
, O
two O
were O
clicked O
three O
times O
, O
and O
two O
were O
clicked O
four O
times O
. O

The O
U.S. B-Organization
Democratic O
party's O
governing O
body O
, O
the O
Democratic O
National O
Committee O
( O
DNC O
) O
, O
uses O
the O
dnc.org O
domain O
for O
its O
staff O
email O
. O

Between O
mid-March O
and O
mid-April O
2016 O
, O
TG-4127 B-Organization
created O
16 O
short O
links O
targeting O
nine O
dnc.org O
email O
accounts O
. O

CTU B-Organization
researchers O
identified O
the O
owners O
of O
three O
of O
these O
accounts O
; O
two O
belonged O
to O
the O
DNC O
's O
secretary O
emeritus O
, O
and O
one O
belonged O
to O
the O
communications O
director O
. O

Four O
of O
the O
16 O
short O
links O
were O
clicked O
, O
three O
by O
the O
senior O
staff O
members O
. O

As O
of O
this O
publication O
, O
dnc.org O
does O
not O
use O
the O
Google B-Vulnerability
Apps I-System
Gmail I-System
email I-System
service O
. O

However O
, O
because O
dnc.org O
email O
accounts O
were O
targeted O
in O
the O
same O
way O
as O
hillaryclinton.com O
accounts O
, O
it O
is O
likely O
that O
dnc.org O
did O
use O
Gmail O
at O
that O
time O
and O
later O
moved O
to O
a O
different O
service O
. O

CTU B-Organization
researchers O
do O
not O
have O
evidence O
that O
these O
spearphishing B-Vulnerability
emails I-Vulnerability
are O
connected O
to O
the O
DNC O
network O
compromise O
that O
was O
revealed O
on O
June O
14 O
. O

However O
, O
a O
coincidence O
seems O
unlikely O
, O
and O
CTU B-Organization
researchers O
suspect O
that O
TG-4127 B-Organization
used O
the O
spearphishing B-Vulnerability
emails I-Vulnerability
or O
similar O
techniques O
to O
gain O
an O
initial O
foothold O
in O
the O
DNC O
network O
. O

CTU B-Organization
researchers O
identified O
TG-4127 B-Organization
targeting O
26 O
personal O
gmail.com O
accounts O
belonging O
to O
individuals O
linked O
to O
the O
Hillary O
for O
America O
campaign O
, O
the O
DNC O
, O
or O
other O
aspects O
of O
U.S. O
national O
politics O
. O

Five O
of O
the O
individuals O
also O
had O
a O
hillaryclinton.com O
email O
account O
that O
was O
targeted O
by O
TG-4127 B-Organization
. O

Many O
of O
these O
individuals O
held O
communications O
, O
media O
, O
finance O
, O
or O
policy O
roles O
. O

They O
include O
the O
director O
of O
speechwriting O
for O
Hillary O
for O
America O
and O
the O
deputy O
director O
office O
of O
the O
chair O
at O
the O
DNC O
. O

TG-4127 B-Organization
created O
150 O
short O
links O
targeting O
this O
group O
. O

As O
of O
this O
publication O
, O
40 O
of O
the O
links O
have O
been O
clicked O
at O
least O
once O
. O

Although O
the O
2015 O
campaign O
did O
not O
focus O
on O
individuals O
associated O
with O
U.S. O
politics O
, O
open-source O
evidence O
suggests O
that O
TG-4127 B-Organization
targeted O
individuals O
connected O
to O
the O
U.S. O
White O
House O
in O
early O
2015 O
. O

The O
threat B-Organization
group O
also O
reportedly O
targeted O
the O
German O
parliament O
and O
German O
Chancellor O
Angela O
Merkel's O
Christian O
Democratic O
Union O
party O
. O

CTU B-Organization
researchers O
have O
not O
observed O
TG-4127 B-Organization
use O
this O
technique O
( O
using O
Bitly B-System
short O
links O
) O
to O
target O
the O
U.S. O
Republican O
party O
or O
the O
other O
U.S. O
presidential O
candidates O
whose O
campaigns O
were O
active O
between O
mid-March O
and O
mid-May O
: O
Donald O
Trump O
, O
Bernie O
Sanders O
, O
Ted O
Cruz O
, O
Marco O
Rubio O
, O
and O
John O
Kasich O
. O

However O
, O
the O
following O
email O
domains O
do O
not O
use O
Google O
mail O
servers I-System
and O
may O
have O
been O
targeted O
by O
other O
means O
: O
gop.com O
— O
used O
by O
the O
Republican B-Organization
National O
Committee O
, O
donaldjtrump.com O
— O
used O
by O
the O
Donald O
Trump O
campaign O
, O
johnkasich.com O
— O
used O
by O
the O
John O
Kasich O
campaign O
. O

Access O
to O
targets' O
Google B-Organization
accounts O
allows O
TG-4127 O
to O
review O
internal O
emails O
and O
potentially O
access O
other O
Google B-System
Apps O
services O
used O
by O
these O
organizations O
, O
such O
as O
Google O
Drive O
. O

In O
addition O
to O
the O
value O
of O
the O
intelligence O
, O
the O
threat O
actors O
could O
also O
exploit O
this O
access O
for O
other O
malicious O
activity O
, O
such O
as O
generating O
spearphishing B-Vulnerability
emails I-Vulnerability
from O
internal O
email O
addresses O
to O
compromise O
the O
organizations' O
networks O
with O
malware O
. O

The O
Russian O
government O
views O
the O
U.S. O
as O
a O
strategic O
rival O
and O
is O
known O
to O
task O
its O
intelligence O
agencies O
with O
gathering O
confidential O
information O
about O
individuals O
and O
organizations O
close O
to O
the O
center O
of O
power O
in O
the O
U.S. O
Individuals O
working O
for O
the O
Hillary O
for O
America O
campaign O
could O
have O
information O
about O
proposed O
policies O
for O
a O
Clinton O
presidency O
, O
including O
foreign-policy O
positions O
, O
which O
would O
be O
valuable O
to O
the O
Russian O
government O
. O

Information O
about O
travel O
plans O
and O
campaign O
scheduling O
could O
provide O
short-term O
opportunities O
for O
other O
intelligence O
operations O
. O

Long-term O
access O
to O
email O
accounts O
of O
senior O
campaign O
advisors O
, O
who O
may O
be O
appointed O
to O
staff O
positions O
in O
a O
Clinton O
administration O
, O
could O
provide O
TG-4127 B-Organization
and O
the O
Russian O
government O
with O
access O
to O
those O
individual's O
accounts O
. O

While O
TG-4127 B-Organization
continues O
to O
primarily O
threaten O
organizations O
and O
individuals O
operating O
in O
Russia O
and O
former O
Soviet O
states O
, O
this O
campaign O
illustrates O
its O
willingness O
to O
expand O
its O
scope O
to O
other O
targets O
that O
have O
intelligence O
of O
interest O
to O
the O
Russian O
government O
. O

Non-governmental O
political B-Organization
organizations O
may O
provide O
access O
to O
desirable O
national O
policy O
information O
, O
especially O
foreign O
policy O
, O
but O
may O
not O
have O
the O
same O
level O
of O
protection O
and O
security O
as O
governmental B-Organization
organizations I-Organization
. O

Targeting O
individuals O
linked O
to O
presidential O
campaigns O
could O
represent O
an O
intelligence O
‘ O
long O
game O
,' O
as O
establishing O
access O
to O
potential O
U.S. O
administration O
staff O
before O
they O
are O
appointed O
could O
be O
easier O
than O
targeting O
them O
when O
they O
are O
established O
in O
the O
White O
House O
. O

Access O
to O
an O
individual's O
personal O
or O
corporate O
email O
account O
provides O
a O
substantial O
amount O
of O
useful O
intelligence O
, O
and O
threat O
actors O
could O
also O
leverage O
the O
access O
to O
launch O
additional O
attacks O
to O
penetrate O
the O
network O
of O
an O
associated O
organization O
. O

Users O
rarely O
check O
the O
full O
URL O
associated O
with O
short O
links O
, O
so O
threat B-Organization
groups I-Organization
can O
use O
URL-shortening O
services O
to O
effectively O
hide O
malicious O
URLs O
. O

Threat B-Organization
actors I-Organization
can O
use O
the O
services' O
detailed O
statistics O
about O
which O
links O
were O
clicked O
when O
, O
and O
from O
what O
location O
, O
to O
track O
the O
success O
of O
a O
spearphishing O
campaign O
. O

A O
single O
compromised O
account O
could O
allow O
TG-4127 O
to O
achieve O
its O
operational O
goals O
. O

CTU B-Organization
researchers O
recommend O
that O
clients O
take O
appropriate O
precautions O
to O
minimize O
the O
risk O
of O
these O
types O
of O
attacks O
: O
Educate O
users O
about O
the O
risks O
of O
spearphishing B-Vulnerability
emails I-Vulnerability
. O

Use O
caution O
and O
exercise O
due O
diligence O
when O
faced O
with O
a O
shortened O
link O
, O
especially O
in O
unsolicited O
email O
messages O
. O

Pasting O
Bitly B-System
URLs O
, O
appended O
with O
a O
plus O
sign O
, O
into O
the O
address O
bar O
of O
a O
web O
browser O
reveals O
the O
full O
URL O
. O

Sofacy B-Organization
APT I-Organization
hits O
high O
profile O
targets O
with O
updated O
toolset O
. O

Sofacy B-Organization
( O
also O
known O
as O
“ O
Fancy B-Organization
Bear I-Organization
” O
, O
“ O
Sednit B-Organization
” O
, O
“ O
STRONTIUM B-Organization
” O
and O
“ O
APT28 B-Organization
” O
) O
is O
an O
advanced O
threat O
group O
that O
has O
been O
active O
since O
around O
2008 O
, O
targeting O
mostly O
military O
and O
government B-Organization
entities O
worldwide O
, O
with O
a O
focus O
on O
NATO O
countries O
. O

More O
recently O
, O
we O
have O
also O
seen O
an O
increase O
in O
activity O
targeting O
Ukraine O
. O

Back O
in O
2011-2012 O
, O
the O
group B-Organization
used O
a O
relatively O
tiny O
implant O
( O
known O
as O
“ O
Sofacy B-Organization
” O
or O
SOURFACE B-Organization
) O
as O
its O
first O
stage O
malware O
. O

The O
implant O
shared O
certain O
similarities O
with O
the O
old O
Miniduke B-Malware
implants O
. O

This O
led O
us O
to O
believe O
the O
two O
groups O
were O
connected O
, O
at O
least O
to O
begin O
with O
, O
although O
it O
appears O
they O
parted O
ways O
in O
2014 O
, O
with O
the O
original O
Miniduke B-Organization
group I-Organization
switching O
to O
the O
CosmicDuke B-Malware
implant O
. O

At O
some O
point O
during O
2013 O
, O
the O
Sofacy B-Organization
group I-Organization
expanded O
its O
arsenal O
and O
added O
more O
backdoors O
and O
tools O
, O
including O
CORESHELL B-System
, O
SPLM B-System
( O
aka O
Xagent B-System
, O
aka O
CHOPSTICK B-System
) O
, O
JHUHUGIT B-System
( O
which O
is O
built O
with O
code O
from O
the O
Carberp B-System
sources O
) O
, O
AZZY B-System
( O
aka O
ADVSTORESHELL B-System
, O
NETUI B-System
, O
EVILTOSS B-System
, O
and O
spans B-System
across O
four O
to O
five O
generations O
) O
and O
a O
few O
others O
. O

We O
’ve O
seen O
quite O
a O
few O
versions O
of O
these O
implants O
and O
they O
were O
relatively O
widespread O
for O
a O
time O
. O

Sofacy B-Organization
’s O
August O
2015 O
attack O
wave O
. O

In O
the O
months O
leading O
up O
to O
August O
, O
the O
Sofacy B-Organization
group I-Organization
launched O
several O
waves O
of O
attacks O
relying O
on O
zero-day B-Vulnerability
exploits I-Vulnerability
in O
Microsoft O
Office O
, O
Oracle B-System
Sun I-Vulnerability
Java I-Vulnerability
, O
Adobe B-Vulnerability
Flash I-Vulnerability
Player I-Vulnerability
and O
Windows O
itself O
. O

For O
instance O
, O
its O
JHUHUGIT B-System
implant I-System
was O
delivered O
through O
a O
Flash B-Vulnerability
zero-day B-Vulnerability
and O
used O
a O
Windows B-Vulnerability
EoP I-Vulnerability
exploit I-Vulnerability
to O
break O
out O
of O
the O
sandbox O
. O

The O
JHUHUGIT B-System
implant O
became O
a O
relatively O
popular O
first O
stage O
for O
the O
Sofacy O
attacks O
and O
was O
used O
again O
with O
a O
Java B-Vulnerability
zero-day I-Vulnerability
( O
CVE-2015-2590 O
) O
in O
July O
2015 O
. O

While O
the O
JHUHUGIT B-System
( O
and O
more O
recently O
, O
“ O
JKEYSKW B-Malware
” O
) O
implant O
used O
in O
most O
of O
the O
Sofacy O
attacks O
, O
high O
profile O
victims O
are O
being O
targeted O
with O
another O
first O
level O
implant O
, O
representing O
the O
latest O
evolution O
of O
their O
AZZYTrojan O
. O

The O
first O
versions O
of O
the O
new O
AZZY B-System
implant I-System
appeared O
in O
August O
of O
this O
year O
. O

During O
a O
high O
profile O
incident O
we O
investigated O
, O
our O
products O
successfully O
detected O
and O
blocked O
a O
“ O
standard O
” O
Sofacy O
“ O
AZZY B-Malware
” O
sample O
that O
was O
used O
to O
target O
a O
range O
of O
defense B-Organization
contractors I-Organization
. O

The O
sample O
used O
in O
this O
attack O
( O
MD5 O
A96F4B8AC7AA9DBF4624424B7602D4F7 O
, O
compiled O
July O
29th O
, O
2015 O
) O
was O
a O
pretty O
standard O
Sofacy O
x64 O
AZZY B-System
implant O
, O
which O
has O
the O
internal O
name O
“ O
advshellstore.dll O
” O
. O

Interestingly O
, O
the O
fact O
that O
the O
attack O
was O
blocked O
didn’t O
appear O
to O
stop O
the O
Sofacy B-Organization
team O
. O

Just O
an O
hour O
and O
a O
half O
later O
they O
had O
compiled O
and O
delivered O
another O
AZZY B-System
x64 O
backdoor I-System
( O
md5: O
9D2F9E19DB8C20DC0D20D50869C7A373 O
, O
compiled O
August O
4th O
, O
2015 O
) O
. O

This O
was O
no O
longer O
detectable O
with O
static O
signatures O
by O
our O
product O
. O

However O
, O
it O
was O
detected O
dynamically O
by O
the O
host O
intrusion O
prevention O
subsystem O
when O
it O
appeared O
in O
the O
system O
and O
was O
executed O
. O

This O
recurring O
, O
blindingly-fast O
Sofacy B-Organization
attack O
attracted O
our O
attention O
as O
neither O
sample O
was O
delivered O
through O
a O
zero-day B-Vulnerability
vulnerability I-Vulnerability
— O
instead O
, O
they O
appeared O
to O
be O
downloaded O
and O
installed O
by O
another O
malware O
. O

This O
separate O
malware O
was O
installed O
by O
an O
unknown O
attack O
as O
“ O
AppData\Local\Microsoft\Windows\msdeltemp.dll O
” O
( O
md5: O
CE8B99DF8642C065B6AF43FDE1F786A3 O
) O
. O

The O
top O
level O
malware O
, O
CE8B99DF8642C065B6AF43FDE1F786A3 O
( O
named O
by O
its O
authors O
“ O
msdeltemp.dll O
” O
according O
to O
internal O
strings O
, O
and O
compiled O
July O
28th O
, O
2015 O
) O
is O
a O
rare O
type O
of O
the O
Sofacy B-System
AZZY O
implant O
. O

It O
has O
been O
modified O
to O
drop O
a O
separate O
C&C O
helper O
, O
( O
md5: O
8C4D896957C36EC4ABEB07B2802268B9 O
) O
as O
“ O
tf394kv.dll O
“ O
. O

The O
dropped O
“ O
tf394kv.dll O
” O
file O
is O
an O
external O
C&C O
communications O
library O
, O
compiled O
on O
July O
24th O
, O
2015 O
and O
used O
by O
the O
main O
backdoor O
for O
all O
Internet-based O
communications O
. O

This O
code O
modification O
marks O
an O
unusual O
departure O
from O
the O
typical O
AZZY O
backdoors I-Malware
, O
with O
its O
C&C O
communication O
functions O
moved O
to O
an O
external O
DLL O
file O
. O

In O
the O
past O
, O
the O
Sofacy B-Organization
developers O
modified O
earlier O
AZZY B-System
backdoors I-System
to O
use O
a O
C&C O
server O
encoded O
in O
the O
registry O
, O
instead O
of O
storing O
it O
in O
the O
malware O
itself O
, O
so O
this O
code O
modularisation O
follows O
the O
same O
line O
of O
thinking O
. O

In O
addition O
to O
the O
new O
AZZY B-System
backdoors I-System
with O
side-DLL O
for O
C&C O
, O
we O
observed O
a O
new O
set O
of O
data-theft O
modules O
deployed O
against O
victims O
by O
the O
Sofacy B-Organization
group I-Organization
. O

Among O
the O
most O
popular O
modern O
defense O
mechanisms O
against O
APTs O
are O
air-gaps O
— O
isolated O
network O
segments O
without O
Internet O
access O
, O
where O
sensitive O
data O
is O
stored O
. O

In O
the O
past O
, O
we O
’ve O
seen O
groups O
such O
as O
Equation B-System
and O
Flame B-System
use O
malware O
to O
steal O
data O
from O
air-gapped O
networks O
. O

The O
Sofacy B-Organization
group I-Organization
uses O
such O
tools O
as O
well O
. O

The O
first O
versions O
of O
these O
new O
USB B-System
stealer I-System
modules I-System
appeared O
around O
February O
2015 O
and O
the O
latest O
appear O
to O
have O
been O
compiled O
in O
May O
2015 O
. O

Older O
versions O
of O
these O
USBSTEALER O
modules O
were O
previously O
described O
by O
our O
colleagues O
from O
ESET B-Organization
. O

One O
example O
of O
the O
new O
Sofacy O
USBSTEALER O
modules O
is O
8b238931a7f64fddcad3057a96855f6c O
, O
which O
is O
named O
internally O
as O
msdetltemp.dll O
. O

This O
data O
theft O
module O
appears O
to O
have O
been O
compiled O
in O
May O
2015 O
and O
is O
designed O
to O
watch O
removable O
drives O
and O
collect O
files O
from O
them O
, O
depending O
on O
a O
set O
of O
rules O
defined O
by O
the O
attackers B-Organization
. O

The O
stolen O
data O
is O
copied O
into O
a O
hidden O
directory O
as O
“ O
%MYPICTURES%\%volume O
serial O
number% O
“ O
, O
from O
where O
it O
can O
be O
exfiltrated O
by O
the O
attackers B-Organization
using O
one O
of O
the O
AZZY B-System
implants I-System
. O

More O
details O
on O
the O
new O
USB O
stealers O
are O
available O
in O
the O
section O
on O
technical O
analysis O
. O

Over O
the O
last O
year O
, O
the O
Sofacy B-Organization
group I-Organization
has O
increased O
its O
activity O
almost O
tenfold O
when O
compared O
to O
previous O
years O
, O
becoming O
one O
of O
the O
most O
prolific O
, O
agile O
and O
dynamic O
threat O
actors O
in O
the O
arena O
. O

This O
activity O
spiked O
in O
July O
2015 O
, O
when O
the O
group B-Organization
dropped O
two O
completely O
new O
exploits O
, O
an O
Office B-Vulnerability
and O
Java B-Vulnerability
zero-day I-Vulnerability
. O

At O
the O
beginning O
of O
August O
, O
Sofacy B-Organization
began O
a O
new O
wave O
of O
attacks O
, O
focusing O
on O
defense-related B-Organization
targets O
. O

As O
of O
November O
2015 O
, O
this O
wave O
of O
attacks O
is O
ongoing O
. O

The O
attackers B-Organization
deploy O
a O
rare O
modification O
of O
the O
AZZY B-System
backdoor I-System
, O
which O
is O
used O
for O
the O
initial O
reconnaissance O
. O

Once O
a O
foothold O
is O
established O
, O
they O
try O
to O
upload O
more O
backdoors O
, O
USB O
stealers O
as O
well O
as O
other O
hacking O
tools O
such O
as O
“ O
Mimikatz B-System
” O
for O
lateral O
movement O
. O

Two O
recurring O
characteristics O
of O
the O
Sofacy B-Organization
group I-Organization
that O
we O
keep O
seeing O
in O
its O
attacks O
are O
speed O
and O
the O
use O
of O
multi-backdoor O
packages O
for O
extreme O
resilience O
. O

In O
the O
past O
, O
the O
group B-Organization
used O
droppers O
that O
installed O
both O
the O
SPLM B-System
and O
AZZY B-System
backdoors I-System
on O
the O
same O
machine O
. O

If O
one O
of O
them O
was O
detected O
, O
the O
other O
one O
provided O
the O
attacker O
with O
continued O
access O
. O

Internal O
name O
: O
DWN_DLL_MAIN.dll O
File O
format O
: O
PE32 O
DLL O
MD5: O
ce8b99df8642c065b6af43fde1f786a3 O
Linker O
version O
: O
11.0 O
, O
Microsoft B-Organization
Visual O
Studio O
Linker O
timestamp O
: O
2015.07.28 O
13:05:20 O
( O
GMT O
) O
. O

The O
library O
starts O
its O
main O
worker O
thread O
from O
the O
DllMain O
function O
. O

Most O
of O
the O
strings O
inside O
the O
module O
are O
encrypted O
with O
a O
homebrew O
XOR-based O
algorithm O
. O

In O
addition O
to O
that O
, O
API O
function O
names O
are O
reversed O
, O
presumably O
to O
avoid O
detection O
in O
memory O
. O

Once O
started O
, O
the O
code O
in O
the O
main O
thread O
resolves O
the O
basic O
API O
functions O
it O
needs O
and O
loads O
an O
additional O
library O
from O
the O
following O
location O
: O
“ O
%TEMP%\tf394kv.dll O
” O
. O

If O
this O
file O
is O
not O
present O
, O
it O
is O
recreated O
from O
a O
hardcoded O
encrypted O
array O
inside O
the O
body O
of O
the O
DLL O
. O

Next O
, O
the O
module O
enters O
an O
infinite O
loop O
. O

Every O
five O
minutes O
it O
collects O
basic O
system O
information O
and O
sends O
it O
to O
the O
C2 O
server O
. O

The O
main O
thread O
also O
spawns O
a O
separate O
thread O
for O
receiving O
new O
commands O
from O
the O
C2 O
servers O
. O

Every O
10 O
minutes O
, O
it O
sends O
a O
new O
request O
to O
the O
server O
. O

The O
server O
is O
expected O
to O
send O
back O
executable O
code O
and O
one O
of O
the O
following O
commands O
: O
Write O
a O
new O
file O
“ O
%LOCAL_APPDATA%\dllhost.exe O
” O
or O
“ O
%TEMP%\dllhost.exe O
” O
and O
execute O
it O
, O
then O
delete O
the O
file O
, O
Write O
a O
new O
file O
“ O
%LOCAL_APPDATA%\sechost.dll O
” O
or O
“ O
%TEMP%\sechost.dll O
” O
and O
call O
its O
first O
exported O
function O
using O
“ O
rundll32.exe O
” O
or O
Windows B-System
API I-System
, O
then O
delete O
the O
file O
, O
Run O
shellcode O
provided O
by O
the O
server O
in O
a O
new O
thread O
While O
processing O
the O
commands O
, O
the O
backdoor O
logs O
all O
errors O
and O
execution O
results O
. O

The O
module O
also O
reads O
the O
contents O
of O
the O
file O
“ O
%APPDATA%\chkdbg.log O
” O
and O
appends O
it O
to O
the O
results O
. O

It O
then O
sends O
the O
aggregated O
log O
back O
to O
the O
C2 O
server O
. O

The O
module O
aborts O
the O
thread O
receiving O
C2 O
command O
after O
it O
fails O
to O
correctly O
execute O
commands O
more O
than O
six O
times O
in O
a O
row O
, O
i.e. O
if O
file O
or O
process O
creation O
fails O
. O

The O
export O
called O
“ O
k O
” O
is O
a O
wrapper O
for O
the O
“ O
LoadLibraryA O
” O
API O
function O
. O

The O
export O
called O
“ O
SendDataToServer_2 O
” O
does O
exactly O
what O
the O
name O
means O
: O
it O
encrypts O
all O
collected O
data O
, O
encodes O
it O
using O
Base64 O
encoding O
and O
calls O
its O
additional O
library O
to O
send O
the O
data O
to O
the O
C2 O
server O
. O

The O
names O
of O
the O
C2 O
servers O
are O
hardcoded O
. O

The O
two O
C&C O
’s O
hardcoded O
in O
the O
configuration O
block O
of O
the O
main O
binary O
are O
: O
intelnetservice.com O
intelsupport.net O
The O
export O
called O
“ O
Applicate O
” O
runs O
a O
standard O
Windows O
application O
message O
loop O
until O
a O
“ O
WM_ENDSESSION O
” O
message O
is O
received O
. O

It O
then O
terminates O
the O
main O
thread O
. O

Internal O
name O
: O
snd.dll O
File O
format O
: O
PE32 O
DLL O
MD5: O
8c4d896957c36ec4abeb07b2802268b9 O
Linker O
version O
: O
11.0 O
, O
Microsoft B-Organization
Visual O
Studio O
Linker O
timestamp O
: O
2015.07.24 O
12:07:27 O
( O
GMT O
) O
Exported O
functions O
: O
10001580: O
Init O
10001620: O
InternetExchange O
10001650: O
SendData O
This O
external O
library O
implements O
a O
simple O
Wininet-based O
transport O
for O
the O
main O
module O
. O

The O
strings O
inside O
the O
binary O
are O
encrypted O
using O
3DES O
and O
XOR O
and O
reversed O
. O

The O
DllMain O
function O
initializes O
the O
library O
and O
resolves O
all O
required O
Windows O
API O
functions O
. O

The O
“ O
Init O
” O
export O
establishes O
connection O
to O
port O
80 O
of O
a O
C2 O
server O
using O
Wininet O
API O
. O

The O
user O
agent O
string O
employed O
is O
“ O
MSIE O
8.0 O
” O
. O

The O
“ O
SendData O
” O
export O
sends O
a O
HTTP O
POST O
request O
using O
a O
hardcoded O
URI O
“ O
/store/ O
“ O
. O

The O
reply O
, O
if O
its O
length O
is O
not O
equal O
to O
six O
and O
its O
contents O
do O
not O
contain O
“ O
OK O
” O
is O
returned O
back O
to O
the O
caller O
. O

The O
“ O
InternetExchange O
” O
export O
closes O
the O
established O
connection O
and O
frees O
associated O
handles O
. O

Sofacy B-Organization
AZZY I-Organization
4.3 I-Organization
dropper I-System
analysis O
File O
format O
: O
PE32 O
EXE O
File O
size O
: O
142,336 O
bytes O
MD5: O
c3ae4a37094ecfe95c2badecf40bf5bb O
Linker O
version O
: O
11.0 O
, O
Microsoft B-Organization
Visual O
Studio O
Linker O
timestamp O
: O
2015.02.10 O
10:01:59 O
( O
GMT O
) O
Most O
of O
the O
strings O
and O
data O
in O
the O
file O
are O
encrypted O
using O
3DES O
and O
XOR O
. O

The O
code O
makes O
use O
of O
the O
Windows O
Crypto O
API O
for O
3DES O
and O
the O
decryption O
key O
is O
stored O
as O
a O
standard O
Windows O
PUBLICKEYSTRUC O
structure O
. O

First O
, O
it O
creates O
a O
new O
directory O
: O
“ O
%LOCAL_APPDATA%\Microsoft\Windows O
” O
. O

If O
the O
directory O
creation O
fails O
it O
tries O
to O
install O
into O
“ O
%TEMP% O
” O
directory O
instead O
. O

Next O
it O
writes O
a O
hardcoded O
binary O
from O
its O
body O
to O
“ O
msdeltemp.dll O
” O
into O
the O
target O
directory O
. O

If O
the O
file O
exists O
it O
then O
moves O
it O
to O
“ O
__tmpdt.tmp O
” O
in O
the O
same O
directory O
and O
continues O
the O
installation O
. O

Sets O
file O
creation O
timestamp O
to O
that O
of O
“ O
%SYSTEM%\sfc.dll O
” O
. O

Finally O
, O
the O
program O
removes O
itself O
by O
starting O
the O
following O
command O
: O
“ O
cmd O
/c O
DEL O
%path O
to O
self% O
“ O
The O
MD5 O
of O
the O
dropped O
file O
is O
f6f88caf49a3e32174387cacfa144a89 O
. O

Dropper B-Malware
payload O
– O
downloader O
DLL O
Internal O
name O
: O
msdetltemp.dll O
File O
format O
: O
PE32 O
DLL O
File O
size O
: O
73 O
728 O
bytes O
MD5: O
f6f88caf49a3e32174387cacfa144a89 O
Linker O
version O
: O
11.0 O
, O
Microsoft B-Organization
Visual O
Studio O
Linker O
timestamp O
: O
2015.02.10 O
07:20:02 O
( O
GMT O
) O
Exported O
functions O
: O
10002B55: O
Applicate O
Most O
of O
the O
strings O
inside O
the O
binary O
are O
encrypted O
using O
a O
homebrew O
XOR-based O
algorithm O
and O
reversed O
. O

The O
library O
is O
an O
older O
version O
of O
the O
“ O
DWN_DLL_MAIN.dll O
” O
( O
md5: O
ce8b99df8642c065b6af43fde1f786a3 O
) O
. O

The O
DllMain O
function O
is O
identical O
and O
starts O
the O
main O
thread O
; O
the O
“ O
Applicate O
” O
function O
is O
identical O
to O
the O
one O
in O
the O
newer O
library O
. O

This O
version O
of O
the O
module O
does O
not O
rely O
on O
an O
external O
transport O
DLL O
for O
communicating O
with O
its O
C2 O
servers O
; O
instead O
it O
directly O
uses O
Wininet O
API O
functions O
. O

The O
module O
contains O
the O
following O
hardcoded O
C2 O
server O
names O
: O
drivres-update.info O
softupdates.info O
The O
module O
uses O
a O
hardcoded O
URL O
( O
“ O
/check/ O
“ O
) O
for O
sending O
HTTP O
POST O
requests O
to O
its O
C2 O
servers O
. O

Sofacy B-Organization
APT I-Organization
hits O
high O
profile O
targets O
with O
updated O
toolset O
. O

File O
collection O
module O
( O
“ O
USB B-System
Stealer I-System
” O
) O
Internal O
name O
: O
msdetltemp.dll O
( O
from O
resources O
) O
File O
size O
: O
50,176 O
bytes O
File O
format O
: O
PE32 O
EXE O
MD5: O
0369620eb139c3875a62e36bb7abdae8 O
Linker O
version O
: O
10.0 O
, O
Microsoft B-Organization
Visual O
Studio O
Linker O
timestamp O
: O
2015.02.09 O
11:48:01 O
( O
GMT O
) O
Most O
of O
the O
strings O
inside O
the O
binary O
are O
encrypted O
using O
3DES O
and O
XOR O
and O
reversed O
. O

The O
program O
creates O
the O
mutex O
“ O
mtx O
” O
and O
an O
event O
named O
“ O
WerTyQ34C O
” O
. O

Upon O
start O
, O
it O
creates O
a O
window O
with O
the O
class O
name O
“ O
Hello O
” O
and O
title O
“ O
Program O
” O
, O
subscribes O
for O
device O
arrival O
notifications O
for O
that O
window O
and O
enters O
a O
standard O
Windows O
message O
processing O
loop O
. O

The O
message O
processing O
function O
waits O
for O
the O
WM_DEVICECHANGE O
event O
and O
starts O
a O
new O
thread O
on O
its O
arrival O
. O

The O
module O
inspects O
every O
new O
disk O
volume O
attached O
to O
the O
system O
. O

For O
every O
disk O
it O
creates O
a O
“ O
stash O
” O
directory O
in O
“ O
%root O
stash O
directory O
location%\%volume O
serial O
number O
in O
hex% O
” O
with O
attributes O
FILE_ATTRIBUTE_HIDDEN O
and O
FILE_ATTRIBUTE_SYSTEM O
. O

The O
root O
stash O
directory O
location O
may O
be O
read O
from O
the O
configuration O
file O
or O
set O
to O
the O
default O
location O
which O
is O
“ O
%MYPICTURES% O
” O
. O

Then O
, O
it O
traverses O
the O
filesystem O
of O
the O
volume O
looking O
for O
files O
. O

Depending O
on O
the O
settings O
read O
from O
the O
configuration O
file O
, O
the O
scope O
may O
be O
narrowed O
to O
files O
with O
particular O
extensions O
and/or O
files O
created O
after O
a O
specified O
date O
. O

It O
is O
worth O
noting O
that O
if O
the O
source O
file O
location O
contains O
the O
string O
“ O
System O
Volume O
Information\S-1-5-21-1315235578-283289242\ O
” O
, O
then O
the O
file O
is O
deleted O
after O
copying O
to O
the O
“ O
stash O
” O
directory O
. O

There O
are O
known O
related O
samples O
that O
are O
able O
to O
create O
such O
directories O
on O
removable O
drives O
, O
i.e O
. O

the O
sample O
with O
md5: O
8cb08140ddb00ac373d29d37657a03cc O
. O

The O
configuration O
file I-Malware
is O
loaded O
from O
the O
same O
directory O
as O
the O
module O
and O
is O
expected O
to O
have O
a O
name O
“ O
NvCpld.dat O
“ O
. O

It O
is O
a O
text O
file O
that O
may O
contain O
the O
following O
configuration O
parameters O
: O
Path O
– O
location O
of O
the O
root O
“ O
stash O
” O
directory O
Ext O
– O
search O
for O
files O
with O
one O
of O
these O
extensions O
only O
Date O
– O
search O
for O
files O
not O
earlier O
than O
this O
date O
Internal O
name O
: O
NvCpld.dll O
( O
from O
export O
table O
) O
, O
msdetltemp.dll O
( O
from O
resources O
) O
, O
IGFSRVC.dll O
( O
from O
resources O
) O
File O
format O
: O
PE32 O
DLL O
File O
size O
: O
76,288 O
bytes O
MD5s O
: O
8b238931a7f64fddcad3057a96855f6c O
, O
ce151285e8f0e7b2b90162ba171a4b90 O
Linker O
version O
: O
11.0 O
, O
Microsoft O
Visual O
Studio O
Linker O
timestamps O
: O
2015.05.29 O
11:20:32 O
( O
GMT O
) O
, O
2006.11.25 O
04:39:15 O
( O
GMT O
) O
Exported O
functions O
: O
10002500: O
NvMswt O
10002860: O
NvReg O
10002880: O
NvStart O
10002A80: O
NvStop O
This O
library O
is O
a O
newer O
version O
of O
the O
file O
collection O
module O
( O
md5: O
0369620eb139c3875a62e36bb7abdae8 O
) O
wrapped O
in O
a O
DLL O
file O
. O

There O
are O
two O
known O
variants O
of O
this O
module O
; O
they O
only O
differ O
in O
timestamp O
values O
and O
version O
information O
in O
the O
resource O
section O
. O

The O
DllMain O
function O
only O
decrypts O
the O
data O
structures O
and O
initializes O
Windows O
API O
pointers O
. O

The O
function O
“ O
NvMswt O
” O
is O
a O
wrapper O
for O
the O
API O
function O
MsgWaitForMultipleObjects O
. O

The O
function O
“ O
NvReg O
” O
is O
a O
wrapper O
for O
the O
API O
function O
RegisterClassW O
. O

The O
function O
“ O
NvStart O
” O
is O
similar O
to O
the O
main O
function O
of O
the O
older O
module O
; O
it O
creates O
a O
window O
and O
enters O
the O
message O
loop O
waiting O
for O
device O
arrival O
notifications O
. O

The O
only O
difference O
introduced O
is O
that O
an O
event O
named O
“ O
WerTyQ34C O
” O
can O
be O
signalled O
by O
the O
function O
“ O
NvStop O
” O
to O
terminate O
the O
message O
loop O
and O
stop O
processing O
. O

How O
they O
did O
it O
: O
GRU B-Organization
hackers O
vs O
. O

US O
elections O
. O

In O
a O
press O
briefing O
just O
two O
weeks O
ago O
, O
Deputy B-Organization
Attorney O
General O
Rod O
Rosenstein O
announced O
that O
the O
grand O
jury O
assembled O
by O
Special O
Counsel O
Robert O
Mueller O
had O
returned O
an O
indictment O
against O
12 O
officers O
of O
Russia O
's O
Main O
Intelligence O
Directorate O
of O
the O
Russian O
General O
Staff O
( O
better O
known O
as O
Glavnoye O
razvedyvatel'noye O
upravleniye O
, O
or O
GRU B-Organization
) O
. O

The O
indictment O
was O
for O
conducting O
" O
active O
cyber O
operations O
with O
the O
intent O
of O
interfering O
in O
the O
2016 O
presidential O
election O
. O

" O
The O
espionage O
operation O
was O
run O
by O
Unit B-Organization
26165 O
, O
commanded O
by O
GRU B-Organization
Officer O
Viktor O
Borisovich O
Netykshko O
. O

Unit B-Organization
26165 O
appears O
to O
be O
the O
organization O
behind O
at O
least O
part O
of O
the O
"threat O
group" O
of O
tools O
, O
techniques O
, O
and O
procedures O
known O
as O
" O
Fancy B-Organization
Bear I-Organization
, O
" O
" O
Sofacy B-Organization
, O
" O
" O
APT28 B-Organization
, O
" O
and O
" O
Sednit B-Organization
" O
. O

Within O
the O
unit O
, O
two O
divisions O
were O
involved O
in O
the O
breaches O
: O
one O
specializing O
in O
operations O
and O
the O
second O
in O
development O
and O
maintenance O
of O
hacking O
tools O
and O
infrastructure O
. O

The O
operations O
division O
, O
supervised O
by O
Major O
Boris O
Alekseyevich O
Antonov O
, O
specialized O
in O
targeting O
organizations O
of O
intelligence O
interest O
through O
spear-phishing B-Vulnerability
campaigns O
and O
the O
exploitation O
of O
stolen O
credentials O
. O

Antonov's O
group O
included O
Ivan O
Sergeyevich O
Yermakov O
and O
Senior O
Lieutenant O
Aleksey O
Viktorovich O
Lukashev O
, O
according O
to O
the O
indictment O
, O
and O
they O
were O
responsible O
for O
targeting O
the O
email O
accounts O
that O
were O
exposed O
on O
the O
" O
DCLeaks O
" O
site O
prior O
to O
the O
election O
operations O
. O

The O
second O
division O
, O
overseen O
by O
Lieutenant O
Colonel O
Sergey O
Aleksandrovich O
Morgachev O
, O
managed O
the O
development O
and O
maintenance O
of O
malware O
and O
hacking O
tools O
used O
by O
Unit B-Organization
26165 O
, O
including O
the O
X-Agent O
" O
implant O
" O
. O

X-Agent O
is O
a O
signature O
tool O
of O
Fancy B-Organization
Bear I-Organization
operations—a O
cross-platform B-System
backdoor I-System
toolset O
with O
variants O
for O
Windows B-System
, O
MacOS B-System
, O
Android B-System
, O
and O
iOS B-System
. O

The O
Windows O
and O
MacOS B-Vulnerability
versions O
of O
X-Agent O
are O
capable O
of O
recording O
keystrokes O
, O
taking O
screenshots O
, O
and O
exfiltrating O
files O
from O
infected O
systems O
back O
to O
a O
command O
and O
control O
server O
. O

Lieutenant O
Captain O
Nikolay O
Kozacheck O
( O
who O
used O
the O
hacker O
monikers O
" O
kazak O
" O
and O
" O
blablabla1234465 O
" O
) O
was O
the O
primary O
developer O
and O
maintainer O
of O
X-Agent O
, O
according O
to O
the O
indictment O
, O
and O
he O
was O
assisted O
by O
another O
officer O
, O
Pavel O
Yershov O
, O
in O
preparing O
it O
for O
deployment O
. O

Once O
X-Agent O
was O
implanted O
on O
the O
DNC O
and O
DCCC O
networks O
, O
Second O
Lieutenant O
Artem O
Malyshev O
( O
AKA O
" O
djangomagicdev O
" O
and O
" O
realblatr O
" O
) O
monitored O
the O
implants O
through O
the O
command O
and O
control O
network O
configured O
for O
the O
task O
. O

The O
information O
operations O
unit O
, O
Unit B-Organization
74455 O
, O
was O
commanded O
by O
Colonel O
Aleksandr O
Vladimirovich O
Osadchuk O
. O

Unit B-Organization
74455 O
's O
members O
would O
be O
responsible O
for O
the O
distribution O
of O
some O
of O
the O
stolen O
data O
from O
the O
breaches O
through O
the O
" O
DCLeaks O
" O
and O
" O
Guccifer O
2.0 I-Malware
" O
websites O
. O

This O
group O
famously O
also O
reached O
out O
to O
WikiLeaks B-Organization
( O
referred O
to O
as O
" O
Organization O
1 O
" O
in O
the O
indictment O
) O
to O
amplify O
their O
information O
operation O
, O
and O
they O
promoted O
the O
leaks O
to O
journalists O
through O
GRU O
-controlled O
email O
and O
social O
media O
accounts O
. O

Within O
Unit B-Organization
74455 O
, O
Officer O
Aleksy O
Potemkin—a O
department O
supervisor—oversaw O
information O
operations O
infrastructure O
. O

His O
group O
configured O
the O
DCLeaks O
and O
Guccifer O
2.0 O
blogs O
and O
social O
media O
accounts O
that O
would O
later O
be O
used O
to O
spread O
data O
stolen O
from O
the O
DNC O
, O
DCCC O
, O
and O
Clinton O
campaigns O
. O

Bears O
in O
the O
Midst O
: O
Intrusion O
Into O
the O
Democratic O
National O
Committee O
. O

There O
is O
rarely O
a O
dull O
day O
at O
CrowdStrike B-Organization
where O
we O
are O
not O
detecting O
or O
responding O
to O
a O
breach O
at O
a O
company O
somewhere O
around O
the O
globe O
. O

In O
all O
of O
these O
cases O
, O
we O
operate O
under O
strict O
confidentiality O
rules O
with O
our O
customers O
and O
cannot O
reveal O
publicly O
any O
information O
about O
these O
attacks O
. O

But O
on O
rare O
occasions O
, O
a O
customer O
decides O
to O
go O
public O
with O
information O
about O
their O
incident O
and O
give O
us O
permission O
to O
share O
our O
knowledge O
of O
the O
adversary O
tradecraft O
with O
the O
broader O
community O
and O
help O
protect O
even O
those O
who O
do O
not O
happen O
to O
be O
our O
customers O
. O

This O
story O
is O
about O
one O
of O
those O
cases O
. O

CrowdStrike B-Organization
Services I-Organization
Inc. O
, O
our O
Incident O
Response O
group I-Organization
, O
was O
called O
by O
the O
Democratic O
National O
Committee O
( O
DNC O
) O
, O
the O
formal O
governing O
body O
for O
the O
US O
Democratic O
Party O
, O
to O
respond O
to O
a O
suspected O
breach O
. O

We O
deployed O
our O
IR O
team O
and O
technology O
and O
immediately O
identified O
two O
sophisticated O
adversaries O
on O
the O
network O
– O
COZY O
BEAR O
and O
FANCY B-Organization
BEAR I-Organization
. O

We O
’ve O
had O
lots O
of O
experience O
with O
both O
of O
these O
actors O
attempting O
to O
target O
our O
customers O
in O
the O
past O
and O
know O
them O
well O
. O

In O
fact O
, O
our O
team O
considers O
them O
some O
of O
the O
best O
threat O
actors O
out O
of O
all O
the O
numerous O
nation-state O
, O
criminal O
and O
hacktivist/terrorist O
groups O
we O
encounter O
on O
a O
daily O
basis O
. O

Their O
tradecraft O
is O
superb O
, O
operational O
security O
second O
to O
none O
and O
the O
extensive O
usage O
of O
‘ O
living-off-the-land O
’ O
techniques O
enables O
them O
to O
easily O
bypass O
many O
security O
solutions O
they O
encounter O
. O

In O
particular O
, O
we O
identified O
advanced O
methods O
consistent O
with O
nation-state O
level O
capabilities O
including O
deliberate O
targeting O
and O
‘ O
access O
management O
’ O
tradecraft O
– O
both O
groups B-Organization
were O
constantly O
going O
back O
into O
the O
environment O
to O
change O
out O
their O
implants O
, O
modify O
persistent O
methods O
, O
move O
to O
new O
Command O
& O
Control O
channels O
and O
perform O
other O
tasks O
to O
try O
to O
stay O
ahead O
of O
being O
detected O
. O

Both O
adversaries O
engage O
in O
extensive O
political O
and O
economic O
espionage O
for O
the O
benefit O
of O
the O
government O
of O
the O
Russian O
Federation O
and O
are O
believed O
to O
be O
closely O
linked O
to O
the O
Russian O
government O
’s O
powerful O
and O
highly O
capable O
intelligence O
services O
. O

COZY O
BEAR B-Organization
( O
also O
referred O
to O
in O
some O
industry O
reports O
as O
CozyDuke B-Organization
or O
APT O
29 O
) O
is O
the O
adversary O
group O
that O
last O
year O
successfully O
infiltrated O
the O
unclassified O
networks O
of O
the O
White O
House O
, O
State O
Department B-Organization
, O
and O
US O
Joint O
Chiefs O
of O
Staff O
. O

In O
addition O
to O
the O
US O
government O
, O
they O
have O
targeted O
organizations O
across O
the O
Defense B-Organization
, O
Energy B-Organization
, O
Extractive O
, O
Financial O
, O
Insurance O
, O
Legal O
, O
Manufacturing O
Media O
, O
Think O
Tanks O
, O
Pharmaceutical O
, O
Research B-Organization
and O
Technology O
industries O
, O
along O
with O
Universities O
. O

Victims O
have O
also O
been O
observed O
in O
Western O
Europe O
, O
Brazil O
, O
China O
, O
Japan O
, O
Mexico O
, O
New O
Zealand O
, O
South O
Korea O
, O
Turkey O
and O
Central O
Asian O
countries O
. O

COZY O
BEAR B-Organization
’s O
preferred O
intrusion O
method O
is O
a O
broadly O
targeted O
spearphish O
campaign O
that O
typically O
includes O
web O
links O
to O
a O
malicious O
dropper I-Malware
. O

Once O
executed O
on O
the O
machine O
, O
the O
code O
will O
deliver O
one O
of O
a O
number O
of O
sophisticated O
Remote O
Access I-System
Tools I-System
( O
RATs B-System
) O
, O
including O
AdobeARM O
, O
ATI-Agent O
, O
and O
MiniDionis O
. O

On O
many O
occasions O
, O
both O
the O
dropper O
and O
the O
payload O
will O
contain O
a O
range O
of O
techniques O
to O
ensure O
the O
sample O
is O
not O
being O
analyzed O
on O
a O
virtual O
machine O
, O
using O
a O
debugger O
, O
or O
located O
within O
a O
sandbox O
. O

They O
have O
extensive O
checks O
for O
the O
various O
security O
software O
that O
is O
installed O
on O
the O
system O
and O
their O
specific O
configurations O
. O

When O
specific O
versions O
are O
discovered O
that O
may O
cause O
issues O
for O
the O
RAT O
, O
it O
promptly O
exits O
. O

These O
actions O
demonstrate O
a O
well-resourced O
adversary O
with O
a O
thorough O
implant-testing O
regime O
that O
is O
highly O
attuned O
to O
slight O
configuration O
issues O
that O
may O
result O
in O
their O
detection O
, O
and O
which O
would O
cause O
them O
to O
deploy O
a O
different O
tool O
instead O
. O

The O
implants O
are O
highly O
configurable O
via O
encrypted O
configuration O
files O
, O
which O
allow O
the O
adversary O
to O
customize O
various O
components O
, O
including O
C2 O
servers O
, O
the O
list O
of O
initial O
tasks O
to O
carry O
out O
, O
persistence O
mechanisms O
, O
encryption O
keys O
and O
others O
. O

An O
HTTP O
protocol O
with O
encrypted O
payload O
is O
used O
for O
the O
Command O
& O
Control O
communication O
. O

FANCY B-Organization
BEAR I-Organization
( O
also O
known O
as O
Sofacy B-Organization
or O
APT B-Organization
28 O
) O
is O
a O
separate O
Russian-based O
threat O
actor I-Organization
, O
which O
has O
been O
active O
since O
mid O
2000s O
, O
and O
has O
been O
responsible O
for O
targeted O
intrusion O
campaigns O
against O
the O
Aerospace O
, O
Defense B-Organization
, O
Energy B-Organization
, O
Government O
and O
Media B-Organization
sectors I-Organization
. O

Their O
victims O
have O
been O
identified O
in O
the O
United O
States O
, O
Western O
Europe O
, O
Brazil O
, O
Canada O
, O
China O
, O
Georgia O
, O
Iran O
, O
Japan O
, O
Malaysia O
and O
South O
Korea O
. O

Extensive O
targeting O
of O
defense B-Organization
ministries O
and O
other O
military O
victims O
has O
been O
observed O
, O
the O
profile O
of O
which O
closely O
mirrors O
the O
strategic O
interests O
of O
the O
Russian O
government O
, O
and O
may O
indicate O
affiliation O
with O
GRU B-Organization
, O
Russia O
’s O
premier O
military O
intelligence O
service O
. O

This O
adversary O
has O
a O
wide O
range O
of O
implants O
at O
their O
disposal O
, O
which O
have O
been O
developed O
over O
the O
course O
of O
many O
years O
and O
include O
Sofacy B-Organization
, O
X-Agent O
, O
X-Tunnel O
, O
WinIDS O
, O
Foozer O
and O
DownRage O
droppers O
, O
and O
even O
malware O
for O
Linux B-System
, O
OSX B-System
, O
IOS O
, O
Android B-System
and O
Windows O
Phones O
. O

This O
group B-Organization
is O
known O
for O
its O
technique O
of O
registering O
domains O
that O
closely O
resemble O
domains O
of O
legitimate O
organizations O
they O
plan O
to O
target O
. O

Afterwards O
, O
they O
establish O
phishing B-Vulnerability
sites O
on O
these O
domains O
that O
spoof O
the O
look O
and O
feel O
of O
the O
victim O
’s O
web-based O
email O
services O
in O
order O
to O
steal O
their O
credentials O
. O

FANCY B-Organization
BEAR I-Organization
has O
also O
been O
linked O
publicly O
to O
intrusions O
into O
the O
German O
Bundestag O
and O
France O
’s O
TV5 O
Monde O
TV O
station O
in O
April O
2015 O
. O

At O
DNC O
, O
COZY O
BEAR B-Organization
intrusion O
has O
been O
identified O
going O
back O
to O
summer O
of O
2015 O
, O
while O
FANCY B-Organization
BEAR I-Organization
separately O
breached O
the O
network O
in O
April O
2016 O
. O

We O
have O
identified O
no O
collaboration O
between O
the O
two O
actors O
, O
or O
even O
an O
awareness O
of O
one O
by O
the O
other O
. O

Instead O
, O
we O
observed O
the O
two O
Russian O
espionage B-Organization
groups I-Organization
compromise O
the O
same O
systems O
and O
engage O
separately O
in O
the O
theft O
of O
identical O
credentials O
. O

While O
you O
would O
virtually O
never O
see O
Western O
intelligence O
agencies O
going O
after O
the O
same O
target O
without O
de-confliction O
for O
fear O
of O
compromising O
each O
other O
’s O
operations O
, O
in O
Russia O
this O
is O
not O
an O
uncommon O
scenario O
. O

“ O
Putin O
’s O
Hydra O
: O
Inside O
Russia O
’s O
Intelligence O
Services O
” O
, O
a O
recent O
paper O
from O
European O
Council O
on O
Foreign O
Relations O
, O
does O
an O
excellent O
job O
outlining O
the O
highly O
adversarial O
relationship O
between O
Russia O
’s O
main O
intelligence O
services O
– O
FSB O
, O
the O
primary O
domestic O
intelligence O
agency O
but O
one O
with O
also O
significant O
external O
collection O
and O
‘ O
active O
measures O
’ O
remit O
, O
SVR B-Organization
, O
the O
primary O
foreign O
intelligence O
agency O
, O
and O
the O
aforementioned O
GRU O
. O

Not O
only O
do O
they O
have O
overlapping O
areas O
of O
responsibility O
, O
but O
also O
rarely O
share O
intelligence O
and O
even O
occasionally O
steal O
sources O
from O
each O
other O
and O
compromise O
operations O
. O

Thus O
, O
it O
is O
not O
surprising O
to O
see O
them O
engage O
in O
intrusions O
against O
the O
same O
victim O
, O
even O
when O
it O
may O
be O
a O
waste O
of O
resources O
and O
lead O
to O
the O
discovery O
and O
potential O
compromise O
of O
mutual O
operations O
. O

The O
COZY O
BEAR O
intrusion O
relied O
primarily O
on O
the O
SeaDaddy O
implant O
developed O
in O
Python O
and O
compiled O
with O
py2exe O
and O
another O
Powershell O
backdoor I-System
with O
persistence O
accomplished O
via O
Windows O
Management O
Instrumentation O
( O
WMI O
) O
system O
, O
which O
allowed O
the O
adversary O
to O
launch O
malicious O
code O
automatically O
after O
a O
specified O
period O
of O
system O
uptime O
or O
on O
a O
specific O
schedule O
. O

The O
Powershell B-System
backdoor I-System
is O
ingenious O
in O
its O
simplicity O
and O
power O
. O

This O
one-line O
powershell O
command O
, O
stored O
only O
in O
WMI O
database O
, O
establishes O
an O
encrypted O
connection O
to O
C2 O
and O
downloads O
additional O
powershell O
modules O
from O
it O
, O
executing O
them O
in O
memory O
. O

In O
theory O
, O
the O
additional O
modules O
can O
do O
virtually O
anything O
on O
the O
victim O
system O
. O

The O
encryption O
keys O
in O
the O
script O
were O
different O
on O
every O
system O
. O

Powershell O
version O
of O
credential O
theft O
tool O
MimiKatz O
was O
also O
used O
by O
the O
actors O
to O
facilitate O
credential O
acquisition O
for O
lateral O
movement O
purposes O
. O

FANCY B-Organization
BEAR I-Organization
adversary O
used O
different O
tradecraft O
, O
deploying O
X-Agent O
malware O
with O
capabilities O
to O
do O
remote O
command O
execution O
, O
file O
transmission O
and O
keylogging O
. O

It O
was O
executed O
via O
rundll32 O
commands O
such O
as O
: O
rundll32.exe O
“ O
C:\Windows\twain_64.dll O
” O
. O

In O
addition O
, O
FANCY B-Organization
BEAR I-Organization
’s O
X-Tunnel O
network O
tunneling I-System
tool I-System
, O
which O
facilitates O
connections O
to O
NAT-ed O
environments O
, O
was O
used O
to O
also O
execute O
remote O
commands O
. O

Both O
tools O
were O
deployed O
via O
RemCOM O
, O
an O
open-source O
replacement O
for O
PsExec B-System
available O
from O
GitHub B-System
. O

Intelligence O
collection O
directed O
by O
nation B-Organization
state I-Organization
actors I-Organization
against O
US O
political O
targets O
provides O
invaluable O
insight O
into O
the O
requirements O
directed O
upon O
those O
actors O
. O

Regardless O
of O
the O
agency O
or O
unit O
tasked O
with O
this O
collection O
, O
the O
upcoming O
US O
election O
, O
and O
the O
associated O
candidates O
and O
parties O
are O
of O
critical O
interest O
to O
both O
hostile O
and O
friendly O
nation O
states O
. O

The O
2016 O
presidential O
election O
has O
the O
world O
’s O
attention O
, O
and O
leaders O
of O
other O
states O
are O
anxiously O
watching O
and O
planning O
for O
possible O
outcomes O
. O

Corporate O
IoT O
– O
a O
path O
to O
intrusion O
. O

Several O
sources O
estimate O
that O
by O
the O
year O
2020 O
some O
50 O
billion O
IoT O
devices O
will O
be O
deployed O
worldwide O
. O

IoT O
devices O
are O
purposefully O
designed O
to O
connect O
to O
a O
network O
and O
many O
are O
simply O
connected O
to O
the O
internet O
with O
little O
management O
or O
oversight.Some O
IoT O
devices O
may O
even O
communicate O
basic O
telemetry O
back O
to O
the O
device O
manufacturer O
or O
have O
means O
to O
receive O
software O
updates O
. O

In O
2016 O
, O
the O
Mirai O
botnet O
was O
discovered O
by O
the O
malware O
research O
group O
MalwareMustDie O
. O

The O
botnet O
initially O
consisted O
of O
IP O
cameras O
and O
basic O
home O
routers O
, O
two O
types O
of O
IoT O
devices O
commonly O
found O
in O
the O
household O
. O

As O
more O
variants O
of O
Mirai O
emerged O
, O
so O
did O
the O
list O
IoT O
devices O
it O
was O
targeting O
. O

The O
source O
code O
for O
the O
malware O
powering O
this O
botnet O
was O
eventually O
leaked O
online O
. O

In O
2018 O
, O
hundreds O
of O
thousands O
of O
home O
and O
small O
business O
networking O
and O
storage O
devices O
were O
compromised O
and O
loaded O
with O
the O
so-called O
“ O
VPN B-System
Filter I-System
” O
malware O
. O

The O
FBI B-Organization
has O
publicly O
attributed O
this O
activity O
to O
a O
nation-state O
actor O
and O
took O
subsequent O
actions O
to O
disrupt O
this O
botnet O
, O
although O
the O
devices O
would O
remain O
vulnerable O
to O
re-infection O
unless O
proper O
firmware O
or O
security O
controls O
were O
put O
in O
place O
by O
the O
user O
. O

In O
April O
, O
security B-Organization
researchers O
in O
the O
Microsoft B-Organization
Threat I-Organization
Intelligence I-Organization
Center I-Organization
discovered O
infrastructure O
of O
a O
known O
adversary O
communicating O
to O
several O
external O
devices O
. O

Further O
research O
uncovered O
attempts O
by O
the O
actor O
to O
compromise O
popular O
IoT O
devices O
( O
a O
VOIP O
phone O
, O
an O
office O
printer O
, O
and O
a O
video O
decoder O
) O
across O
multiple O
customer O
locations O
. O

The O
investigation O
uncovered O
that O
an O
actor B-Organization
had O
used O
these O
devices O
to O
gain O
initial O
access O
to O
corporate O
networks O
. O

In O
two O
of O
the O
cases O
, O
the O
passwords O
for O
the O
devices O
were O
deployed O
without O
changing O
the O
default O
manufacturer O
’s O
passwords O
and O
in O
the O
third O
instance O
the O
latest O
security O
update O
had O
not O
been O
applied O
to O
the O
device O
. O

These O
devices O
became O
points O
of O
ingress O
from O
which O
the O
actor B-Organization
established O
a O
presence O
on O
the O
network O
and O
continued O
looking O
for O
further O
access O
. O

Once O
the O
actor O
had O
successfully O
established O
access O
to O
the O
network O
, O
a O
simple O
network O
scan O
to O
look O
for O
other O
insecure O
devices O
allowed O
them O
to O
discover O
and O
move O
across O
the O
network O
in O
search O
of O
higher-privileged O
accounts O
that O
would O
grant O
access O
to O
higher-value O
data O
. O

After O
gaining O
access O
to O
each O
of O
the O
IoT O
devices O
, O
the O
actor O
ran O
tcpdump O
to O
sniff O
network O
traffic O
on O
local O
subnets O
. O

They O
were O
also O
seen O
enumerating O
administrative O
groups O
to O
attempt O
further O
exploitation O
. O

As O
the O
actor O
moved O
from O
one O
device O
to O
another O
, O
they O
would O
drop O
a O
simple O
shell O
script O
to O
establish O
persistence O
on O
the O
network O
which O
allowed O
extended O
access O
to O
continue O
hunting O
. O

Analysis O
of O
network O
traffic O
showed O
the O
devices O
were O
also O
communicating O
with O
an O
external O
command O
and O
control O
( O
C2 O
) O
server O
. O

The O
following O
IP O
addresses O
are O
believed O
to O
have O
been O
used O
by O
the O
actor O
for O
command O
and O
control O
( O
C2 O
) O
during O
these O
intrusions O
: O
167.114.153.55 O
94.237.37.28 O
82.118.242.171 O
31.220.61.251 O
128.199.199.187 O
. O

We O
attribute O
the O
attacks O
on O
these O
customers O
using O
three O
popular O
IoT O
devices O
to O
an O
activity O
group O
that O
Microsoft O
refers O
to O
as O
STRONTIUM B-Organization
. O

Since O
we O
identified O
these O
attacks O
in O
the O
early O
stages O
, O
we O
have O
not O
been O
able O
to O
conclusively O
determine O
what O
STRONTIUM B-Organization
’s O
ultimate O
objectives O
were O
in O
these O
intrusions O
. O

Over O
the O
last O
twelve O
months O
, O
Microsoft B-Organization
has O
delivered O
nearly O
1400 O
nation-state O
notifications O
to O
those O
who O
have O
been O
targeted O
or O
compromised O
by O
STRONTIUM B-Organization
. O

One O
in O
five O
notifications O
of O
STRONTIUM O
activity O
were O
tied O
to O
attacks O
against O
non-governmental B-Organization
organizations I-Organization
, O
think O
tanks O
, O
or O
politically O
affiliated O
organizations O
around O
the O
world O
. O

The O
remaining O
80% O
of O
STRONTIUM O
attacks O
have O
largely O
targeted O
organizations O
in O
the O
following O
sectors O
: O
government O
, O
IT O
, O
military O
, O
defense O
, O
medicine O
, O
education O
, O
and O
engineering O
. O

We O
have O
also O
observed O
and O
notified O
STRONTIUM O
attacks O
against O
Olympic O
organizing O
committees O
, O
anti-doping O
agencies I-Organization
, O
and O
the O
hospitality O
industry O
. O

The O
“ O
VPN B-System
Filter I-Malware
” O
malware O
has O
also O
been O
attributed O
to O
STRONTIUM B-Organization
by O
the O
FBI B-Organization
. O

Below O
are O
a O
series O
of O
indicators O
Microsoft B-Organization
has O
observed O
as O
active O
during O
the O
STRONTIUM O
activity O
discussed O
in O
this O
article O
. O

BRONZE O
PRESIDENT O
Targets O
NGOs O
. O

The O
activities O
of O
some O
non-governmental B-Organization
organizations I-Organization
( O
NGOs O
) O
challenge O
governments O
on O
politically O
sensitive O
issues O
such O
as O
social O
, O
humanitarian O
, O
and O
environmental O
policies O
. O

As O
a O
result O
, O
these O
organizations O
are O
often O
exposed O
to O
increased O
government-directed O
threats O
aimed O
at O
monitoring O
their O
activities O
, O
discrediting O
their O
work O
, O
or O
stealing O
their O
intellectual O
property O
. O

BRONZE B-Organization
PRESIDENT O
is O
a O
likely O
People's O
Republic O
of O
China O
( O
PRC O
)-based O
targeted O
cyberespionage O
group O
that O
uses O
both O
proprietary O
and O
publicly B-System
available O
tools I-System
to O
target O
NGO O
networks O
. O

Secureworks B-Organization
Counter I-Organization
Threat I-Organization
Unit I-Organization
( O
CTU B-Organization
) O
researchers O
have O
observed O
BRONZE O
PRESIDENT O
activity O
since O
mid-2018 O
but O
identified O
artifacts O
suggesting O
that O
the O
threat B-Organization
actors O
may O
have O
been O
conducting O
network O
intrusions O
as O
far O
back O
as O
2014 O
. O

The O
BRONZE O
PRESIDENT O
cyberespionage O
group O
targets O
NGOs O
, O
as O
well O
as O
political O
and O
law O
enforcement O
organizations O
in O
countries O
in O
South O
and O
East O
Asia O
. O

The O
threat B-Organization
group O
appears O
to O
have O
developed O
its O
own O
remote O
access O
tools O
that O
it O
uses O
alongside O
publicly O
available O
remote O
access I-System
and O
post-compromise O
toolsets O
. O

After O
compromising O
a O
network O
, O
the O
threat O
actors O
elevate O
their O
privileges O
and O
install O
malware O
on O
a O
large O
proportion O
of O
systems O
. O

The O
group O
runs O
custom O
batch O
scripts O
to O
collect O
specific O
file O
types O
and O
takes O
proactive O
steps O
to O
minimize O
detection O
of O
its O
activities O
. O

Analysis O
of O
a O
threat O
group's I-Organization
targeting O
, O
origin O
, O
and O
competencies O
can O
determine O
which O
organizations O
could O
be O
at O
risk O
. O

This O
information O
can O
help O
organizations O
make O
strategic O
defensive O
decisions O
in O
relation O
to O
the O
BRONZE O
PRESIDENT O
threat O
group O
. O

CTU B-Organization
researchers O
have O
observed O
BRONZE O
PRESIDENT O
targeting O
multiple O
NGOs O
. O

The O
threat O
actors O
steal O
data O
from O
compromised O
systems O
over O
a O
long O
period O
of O
time O
, O
which O
likely O
indicates O
a O
long-term O
objective O
of O
monitoring O
the O
target's O
network O
. O

BRONZE O
PRESIDENT O
uses O
custom B-System
batch I-System
scripts I-System
to O
collect O
either O
specific O
file O
types O
( O
including O
files O
with O
.pptx O
, O
.xlsx O
, O
.pdf O
extensions O
) O
or O
all O
files O
within O
a O
specific O
location O
. O

CTU B-Organization
researchers O
also O
observed O
evidence O
that O
the O
threat B-Organization
actors O
collect O
credentials O
from O
high-privilege O
network O
accounts O
and O
reputationally O
sensitive O
accounts O
, O
such O
as O
social O
media O
and O
webmail O
accounts O
. O

Additionally O
, O
CTU B-Organization
researchers O
have O
observed O
evidence O
of O
BRONZE B-Organization
PRESIDENT O
targeting O
political O
and O
law O
enforcement O
organizations O
in O
countries O
adjacent O
to O
the O
PRC O
, O
including O
Mongolia O
and O
India O
. O

Some O
of O
the O
group's B-Organization
phishing I-Vulnerability
lures O
suggest O
an O
interest O
in O
national O
security O
, O
humanitarian O
, O
and O
law O
enforcement O
organizations O
in O
the O
East O
, O
South O
, O
and O
Southeast O
Asia O
( O
see O
Figure O
1 O
) O
. O

These O
examples O
reveal O
BRONZE B-Organization
PRESIDENT O
's O
likely O
intent O
to O
conduct O
political O
espionage O
in O
other O
countries O
in O
addition O
to O
targeting O
NGOs O
. O

It O
is O
highly O
likely O
that O
BRONZE O
PRESIDENT O
is O
based O
in O
the O
PRC O
due O
to O
the O
following O
observations O
: O
The O
NGOs O
targeted O
by O
BRONZE O
PRESIDENT O
conduct O
research O
on O
issues O
relevant O
to O
the O
PRC O
. O

Strong O
evidence O
links O
BRONZE O
PRESIDENT O
's O
infrastructure O
to O
entities O
within O
the O
PRC O
. O

There O
are O
connections O
between O
a O
subset O
of O
the O
group's B-Organization
operational O
infrastructure O
and O
PRC-based O
Internet O
service O
providers O
. O

Tools O
such O
as O
PlugX B-System
have O
historically O
been O
leveraged O
by O
threat B-Organization
groups I-Organization
operating O
in O
the O
PRC O
. O

It O
is O
likely O
that O
BRONZE B-Organization
PRESIDENT O
is O
sponsored O
or O
at O
least O
tolerated O
by O
the O
PRC O
government O
. O

The O
threat O
group's I-Organization
systemic O
long-term O
targeting O
of O
NGO O
and O
political O
networks O
does O
not O
align O
with O
patriotic O
or O
criminal O
threat B-Organization
groups I-Organization
. O

BRONZE B-Organization
PRESIDENT O
has O
deployed O
a O
variety O
of O
remote O
access O
tools O
. O

The O
use O
of O
tools O
not O
previously O
observed O
by O
CTU B-Organization
researchers O
suggests O
that O
the O
group B-Organization
could O
have O
access O
to O
malware O
development O
capabilities O
. O

BRONZE O
PRESIDENT O
also O
uses O
widely O
available O
or O
modified O
open-source O
tools O
, O
which O
could O
be O
a O
strategic O
effort O
to O
reduce O
the O
risk O
of O
attribution O
or O
to O
minimize O
the O
need O
for O
tool O
development O
resources O
. O

Following O
a O
network O
compromise O
, O
the O
threat O
actors O
typically O
delete O
their O
tools O
and O
processes O
. O

However O
, O
the O
group B-Organization
is O
content O
leaving O
some O
malware O
on O
the O
network O
, O
likely O
to O
provide O
a O
contingency O
if O
other O
access O
channels O
are O
removed O
. O

When O
the O
group's B-Organization
activities O
were O
detected O
in O
one O
incident O
, O
it O
had O
elevated O
privileges O
and O
had O
maintained O
access O
to O
the O
targeted O
environment O
for O
several O
months O
. O

This O
finding O
indicates O
the O
group's O
effectiveness O
at O
maintaining O
long-term O
access O
to O
a O
targeted O
network O
. O

CTU B-Organization
researchers O
and O
Secureworks B-Organization
incident O
responders O
have O
observed O
BRONZE O
PRESIDENT O
using O
the O
following O
tools O
, O
along O
with O
several O
custom O
batch O
scripts O
for O
locating O
and O
archiving O
specific O
file O
types O
: O
Cobalt B-System
Strike I-System
— O
This O
popular O
and O
commercially O
available O
penetration O
tool O
gains O
shell O
access O
to O
an O
infected O
system O
. O

It O
allows O
threat O
actors O
to O
execute O
additional O
tools O
and O
perform O
post-intrusion O
actions O
on O
compromised O
systems O
. O

Cobalt B-System
Strike I-System
appears O
to O
be O
one O
of O
BRONZE O
PRESIDENT O
's O
preferred O
remote O
access O
tools O
. O

During O
one O
intrusion O
, O
the O
threat O
actors O
installed O
it O
on O
over O
70% O
of O
accessible O
hosts O
. O

The O
group's B-Organization
Cobalt I-Organization
Strike I-Organization
installation O
typically O
uses O
a O
payload O
named O
svchost.exe B-System
in O
an O
attempt O
to O
disguise O
Cobalt O
Strike O
activity O
as O
the O
legitimate O
Windows O
svchost.exe I-System
executable O
. O

PlugX B-System
— O
This O
remote O
access O
Trojan O
( O
RAT B-System
) O
is O
popular O
among O
PRC-based O
targeted O
threat O
groups I-Organization
. O

Its O
functionality O
includes O
uploading O
and O
downloading O
files O
, O
and O
it O
has O
configurable O
network O
protocols O
. O

BRONZE O
PRESIDENT O
installs O
PlugX B-System
using O
DLL B-System
side-loading I-System
. O

In O
June O
and O
August O
2019 O
, O
BRONZE B-Organization
PRESIDENT O
delivered O
PlugX B-System
via O
government O
and O
law O
enforcement-themed O
phishing B-Vulnerability
lures O
. O

ORat O
— O
CTU B-Organization
researchers O
have O
only O
observed O
this O
basic O
loader O
tool O
in O
the O
context O
of O
BRONZE O
PRESIDENT O
intrusions O
. O

ORat O
is O
the O
name O
assigned O
by O
the O
malware O
author O
, O
as O
denoted O
by O
the O
program O
debug O
database O
string O
in O
the O
analyzed O
sample O
: O
D:\vswork\Plugin\ORat\build\Release\ORatServer\Loader.pdb O
. O

The O
tool O
uses O
the O
Windows O
Management O
Instrumentation O
( O
WMI O
) O
event O
consumer O
for O
persistence O
by O
installing O
a O
script O
to O
the O
system's O
WMI O
registry O
. O

Messages O
sent O
from O
ORat O
to O
its O
command O
and O
control O
( O
C2 O
) O
server O
start O
with O
the O
string O
"VIEWS0018x" O
. O

If O
the O
data O
received O
from O
the O
C2 O
server O
starts O
with O
the O
same O
string O
, O
then O
the O
remainder O
of O
the O
payload O
is O
decompressed O
using O
ORat O
's O
"deflate" O
algorithm O
and O
called O
as O
a O
function O
. O

ORat O
acts O
as O
a O
flexible O
loader O
tool O
rather O
than O
a O
fully O
featured O
remote O
access O
tool O
. O

RCSession O
— O
This O
basic O
RAT O
is O
installed O
via O
DLL O
side-loading O
, O
and O
CTU B-Organization
researchers O
observed O
BRONZE O
PRESIDENT O
installing O
it O
on O
multiple O
hosts O
during O
intrusions O
. O

RCSession O
was O
extracted O
from O
a O
file O
called O
English.rtf O
and O
launched O
via O
a O
hollowed O
svchost.exe O
process O
. O

RCSession O
connects O
to O
its O
C2 O
server O
via O
a O
custom O
protocol O
, O
can O
remotely O
execute O
commands O
, O
and O
can O
launch O
additional O
tools O
. O

CTU B-Organization
researchers O
have O
no O
evidence O
of O
other O
threat O
actors O
using O
RCSession O
or O
of O
wide O
proliferation O
of O
the O
tool O
, O
suggesting O
it O
may O
be O
exclusively O
used O
by O
BRONZE B-Organization
PRESIDENT O
. O

Nbtscan O
— O
This O
publicly O
available O
command-line O
tool O
scans O
systems O
for O
NetBIOS O
name O
information O
( O
see O
Figure O
2 O
) O
. O

In O
an O
example O
observed O
by O
CTU B-Organization
researchers O
, O
the O
Nbtscan O
executable O
was O
named O
Adobe.exe O
and O
was O
installed O
in O
several O
working O
directories O
on O
compromised O
hosts O
, O
including O
: O
C:\Recovery\ O
. O

Nmap O
— O
BRONZE O
PRESIDENT O
used O
this O
freely O
available O
network O
scanning O
tool O
from O
the O
C:\PerfLogs\ O
folder O
. O

Wmiexec O
— O
This O
publicly B-System
available I-System
tool O
uses O
WMI B-System
to O
create O
SYSTEM-level O
shells O
on O
remote O
hosts O
. O

While O
analyzing O
hosts O
compromised O
by O
BRONZE B-Organization
PRESIDENT O
, O
CTU B-Organization
researchers O
identified O
other O
malware O
artifacts O
. O

Although O
there O
was O
no O
evidence O
of O
the O
group B-Organization
using O
the O
malware O
, O
the O
threat B-Organization
actors O
may O
have O
leveraged O
its O
access O
or O
capabilities O
during O
earlier O
phases O
of O
the O
intrusions O
. O

The O
BRONZE O
PRESIDENT O
intrusions O
observed O
by O
CTU B-Organization
researchers O
appear O
to O
have O
taken O
place O
over O
several O
months O
or O
years O
. O

China B-Malware
Chopper I-Malware
web O
shell I-Malware
files I-Malware
named O
error404.aspx O
included O
the O
"eval O
(Request.Item["|"] O
,"unsafe" O
) O
; O
" O
string O
. O

To O
successfully O
interact O
with O
the O
web O
shell O
, O
a O
threat O
actor O
sent O
HTTP O
requests O
that O
included O
the O
"|" O
parameter O
. O

The O
web B-Malware
shell I-Malware
files I-Malware
appeared O
to O
be O
installed O
during O
the O
timeframe O
that O
BRONZE O
PRESIDENT O
was O
active O
on O
the O
system O
. O

CTU B-Organization
researchers O
identified O
a O
variety O
of O
post-compromise O
tools O
stored O
under O
%AppData% O
( O
e.g. O
, O
\AppData\Roaming\Temp O
) O
on O
several O
compromised O
systems O
. O

The O
widespread O
proliferation O
and O
use O
of O
the O
following O
tools O
suggest O
that O
the O
group B-Organization
likely O
has O
the O
knowledge O
and O
capability O
to O
use O
them O
as O
part O
of O
its O
operations O
: O
Powerview.ps1 O
— O
This O
PowerShell-based O
module O
for O
network O
reconnaissance O
is O
part O
of O
the O
PowerSploit O
penetration O
testing O
framework O
. O

PVE O
Find O
AD O
User O
— O
This O
command-line O
tool O
identifies O
login O
locations O
of O
Active O
Directory O
( O
AD O
) O
users O
. O

AdFind B-System
— O
This O
command-line O
tool O
conducts O
AD O
queries O
. O

NetSess O
— O
This O
publicly O
available O
tool O
enumerates O
NetBIOS O
sessions O
. O

Netview O
— O
This O
tool O
enumerates O
networks O
. O

TeamViewer B-System
— O
This O
remote O
control O
and O
desktop-sharing O
tool O
has O
applications O
for O
legitimate O
and O
malicious O
system O
users O
. O

Its O
installation O
in O
a O
temporary O
directory O
alongside O
network O
reconnaissance O
and O
enumeration O
tools O
likely O
indicates O
malicious O
intent O
. O

At O
the O
time O
of O
detection O
, O
observed O
BRONZE O
PRESIDENT O
incidents O
had O
likely O
been O
ongoing O
for O
several O
months O
or O
even O
years O
. O

As O
a O
result O
, O
CTU B-Organization
researchers O
were O
unable O
to O
ascertain O
the O
initial O
access O
vector O
. O

In O
October O
2019 O
, O
third-party O
researchers O
described O
a O
phishing B-Vulnerability
campaign O
that O
used O
C2 O
infrastructure O
that O
CTU B-Organization
researchers O
attribute O
to O
BRONZE O
PRESIDENT O
. O

This O
connection O
suggests O
that O
the O
group B-Organization
uses O
phishing B-Vulnerability
emails I-Vulnerability
with O
ZIP O
attachments O
that O
contain O
LNK O
files O
as O
an O
initial O
access O
vector O
. O

During O
one O
intrusion O
, O
the O
threat O
actors O
gained O
administrator O
access O
to O
all O
systems O
within O
a O
targeted O
business O
unit O
and O
installed O
their O
remote O
access O
tools O
on O
80% O
of O
the O
hosts O
. O

The O
group O
installed O
multiple O
tools O
within O
the O
environment O
, O
including O
three O
different O
tools O
on O
a O
strategically O
important O
server O
, O
likely O
to O
provide O
contingency O
access O
options O
. O

During O
multiple O
intrusions O
, O
the O
threat O
actors O
employed O
various O
tools O
and O
techniques O
to O
understand O
the O
network O
environments O
. O

For O
example O
, O
they O
used O
Nmap O
to O
scan O
various O
internal O
IP O
address O
ranges O
and O
SMB O
ports O
. O

They O
also O
relied O
on O
Nbtscan O
, O
net O
user O
, O
and O
ping O
commands O
to O
obtain O
insights O
and O
identify O
opportunities O
for O
lateral O
movement O
. O

BRONZE O
PRESIDENT O
regularly O
leverages O
Wmiexec O
to O
move O
laterally O
. O

During O
one O
intrusion O
, O
the O
threat O
actors O
extensively O
used O
this O
tool O
to O
execute O
WMI O
commands O
on O
remote O
hosts O
in O
the O
environment O
. O

The O
threat B-Organization
actors O
retrieved O
the O
NTDS.dit O
file O
from O
the O
volume O
shadow O
copy O
. O

NTDS.dit O
contains O
Active O
Directory O
data O
, O
including O
password O
hashes O
for O
all O
users O
on O
a O
domain O
. O

Extracting O
hashes O
from O
the O
NTDS.dit O
file O
requires O
access O
to O
the O
SYSTEM O
file O
in O
the O
system O
registry O
. O

The O
threat O
actors O
saved O
both O
the O
SYSTEM O
file O
( O
system.hive O
) O
and O
NTDS.dit O
in O
the O
compromised O
host's O
c:\windows\temp O
directory O
. O

These O
files O
were O
likely O
exfiltrated O
and O
exploited O
offline O
to O
retrieve O
user O
password O
hashes O
, O
which O
could O
then O
be O
cracked O
or O
used O
to O
perform O
pass-the-hash O
attacks O
. O

BRONZE O
PRESIDENT O
's O
C2 O
techniques O
are O
dictated O
by O
its O
remote O
access O
tools O
. O

The O
group's B-Organization
primary O
and O
likely O
proprietary O
RCSession O
RAT O
communicates O
with O
a O
hard-coded O
C2 O
server O
using O
a O
custom O
protocol O
over O
TCP O
port O
443 O
. O

After O
connecting O
to O
its O
C2 O
server O
, O
RCSession O
checks O
in O
with O
an O
encrypted O
beacon O
and O
then O
awaits O
instruction O
. O

The O
ORat O
tool O
, O
which O
appears O
to O
be O
used O
less O
frequently O
by O
the O
group B-Organization
, O
communicates O
over O
TCP O
port O
80 O
using O
a O
raw O
socket O
protocol I-System
( O
not O
HTTP O
) O
. O

The O
Cobalt B-System
Strike I-System
tool I-System
has O
malleable O
C2 O
profiles O
. O

During O
one O
intrusion O
, O
it O
connected O
to O
multiple O
C2 O
domains O
on O
TCP O
port O
80 O
, O
including O
mail O
. O

svrchost O
. O

com O
, O
using O
the O
following O
request O
. O

Subsequent O
Cobalt B-System
Strike I-System
C2 O
servers O
included O
subdomains O
of O
svchosts O
. O

com O
, O
svrchost O
. O

com O
, O
and O
strust O
. O

club O
. O

Some O
BRONZE O
PRESIDENT O
C2 O
domains O
analyzed O
by O
CTU B-Organization
researchers O
were O
hosted O
on O
infrastructure O
owned O
by O
Dutch O
VPS O
provider O
Host O
Sailor O
, O
Hong O
Kong-based O
New O
World O
Telecoms O
, O
and O
Malaysia-based O
Shinjiru O
Technology O
( O
see O
Figure O
7 O
) O
. O

The O
threat B-Organization
actors O
have O
used O
discrete O
infrastructure O
clusters O
that O
share O
matching O
hosting O
and O
registration O
characteristics O
. O

The O
pattern O
of O
infrastructure O
hosting O
suggests O
that O
the O
group B-Organization
parks O
its O
domains O
when O
not O
in O
use O
, O
an O
operational O
security O
technique O
that O
limits O
exposure O
of O
the O
group's B-Organization
overall O
hosting O
infrastructure O
. O

Some O
of O
BRONZE O
PRESIDENT O
's O
malware O
has O
persistence O
capabilities O
. O

For O
example O
, O
ORat O
uses O
a O
WMI O
event O
consumer O
to O
maintain O
its O
presence O
on O
a O
compromised O
host O
. O

The O
group B-Organization
also O
creates O
and O
maintains O
scheduled O
tasks O
to O
achieve O
this O
purpose O
. O

Figure O
8 O
shows O
a O
Sysdriver O
scheduled O
task O
that O
periodically O
executes O
a O
Cobalt B-System
Strike I-System
payload O
. O

The O
threat O
actors O
tend O
to O
install O
malware O
on O
a O
large O
proportion O
of O
hosts O
during O
their O
intrusions O
. O

However O
, O
the O
group O
exercises O
restraint O
and O
defensive O
evasion O
tactics O
to O
minimize O
opportunities O
for O
network O
defenders O
to O
detect O
or O
investigate O
its O
activities O
. O

For O
example O
, O
the O
threat O
actors O
deleted O
volume O
shadow O
copies O
after O
using O
them O
for O
NTDS.dit O
retrieval O
. O

BRONZE O
PRESIDENT O
targets O
specific O
data O
types O
. O

The O
threat O
actors O
use O
custom O
batch I-System
scripts I-System
to O
create O
a O
list O
of O
files O
with O
predefined O
criteria O
and O
collate O
the O
identified O
files O
into O
a O
.rar O
archive O
( O
see O
Figure O
9 O
) O
. O

CTU B-Organization
researchers O
have O
observed O
BRONZE O
PRESIDENT O
batch O
scripts O
named O
doc.bat O
, O
xls.bat O
, O
xlsx.bat O
, O
ppt.bat O
, O
pptx.bat O
, O
pdf.bat O
, O
and O
txt.bat O
. O

The O
group B-Organization
also O
uses O
the O
all.bat O
batch O
script O
to O
collect O
all O
files O
stored O
on O
a O
specific O
user's O
desktop O
. O

CTU B-Organization
researchers O
observed O
RCSession O
and O
Cobalt B-System
Strike I-System
on O
systems O
that O
BRONZE O
PRESIDENT O
targeted O
for O
data O
theft O
. O

Either O
of O
these O
tools O
could O
have O
been O
used O
to O
exfiltrate O
the O
archived O
data O
. O

BRONZE B-Organization
PRESIDENT O
has O
demonstrated O
intent O
to O
steal O
data O
from O
organizations O
using O
tools O
such O
as O
Cobalt B-System
Strike I-System
, O
PlugX B-System
, O
ORat B-System
, O
and O
RCSession B-System
. O

The O
concurrent O
use O
of O
so O
many O
tools O
during O
a O
single O
intrusion O
suggests O
that O
the O
group B-Organization
could O
include O
threat O
actors O
with O
distinct O
tactics O
, O
roles O
, O
and O
tool O
preferences O
. O

It O
is O
likely O
that O
BRONZE O
PRESIDENT O
has O
additional O
unobserved O
operational O
tools O
and O
capabilities O
. O

CTU B-Organization
researchers O
recommend O
that O
organizations O
apply O
controls O
to O
mitigate O
common O
intrusion O
techniques O
and O
behaviors O
along O
with O
controls O
that O
address O
the O
tools O
and O
techniques O
discussed O
in O
this O
analysis O
. O

PlugX B-System
C2 I-System
server I-System
: O
ipsoftwarelabs.com O
. O

RCSession O
C2 O
server O
: O
toshibadrive.com O
. O

ORat O
and O
Cobalt B-System
Strike I-System
C2 I-System
server I-System
: O
strust.club O
. O

Cobalt B-System
Strike I-System
C2 I-System
server I-System
: O
svchosts.com O
, O
svrhosts.com O
. O

Cobalt B-System
Strike I-System
download O
location O
: O
116.93.154.250 O
. O

ORat O
malware O
sample O
: O
a0758535cf8eb689782b95d3791d23d5 O
, O
774a9c3ff01a3e734b7bec0c312120126295fad9 O
, O
2e8762c984468ee309dad30a6c5f6d3308676ac721357da442a8a5b9d9d65d82 O
. O

Cobalt B-System
Strike I-System
payload O
: O
7101fff478290d4db8a1c11a8d3b40cb O
, O
4c81777551a772218519fb6dd1a6672aade4a936 O
, O
bdf1452b55b9974f3e9a4aea4439769a02fd931660ed655df92519a2a4df1261 O
. O

Modified O
DLL O
file I-Malware
( O
goopdate.dll O
) O
used O
by O
BRONZE O
PRESIDENT O
to O
install O
RCSession O
: O
0617cad9e5d559356c43d4037c86227f O
, O
f14eaf5d648aebb2ed7b00b2cf4349263b30fb1c O
, O
2ea9ccf653f63bcc3549a313ec9d0bada341556cc32dd2ca4b73e0c034492740 O
. O

Operation O
AppleJeus O
Sequel O
, O
Lazarus B-Organization
continues O
to O
attack O
the O
cryptocurrency O
business O
with O
enhanced O
capabilities O
. O

The O
Lazarus B-Organization
group I-Organization
is O
currently O
one O
of O
the O
most O
active O
and O
prolific O
APT O
actors O
. O

In O
2018 O
, O
Kaspersky B-Organization
published O
a O
report O
on O
one O
of O
their O
campaigns O
, O
named O
Operation O
AppleJeus O
. O

Notably O
, O
this O
operation O
marked O
the O
first O
time O
Lazarus B-Organization
had O
targeted O
macOS B-Organization
users O
, O
with O
the O
group B-Organization
inventing O
a O
fake O
company O
in O
order O
to O
deliver O
their O
manipulated O
application O
and O
exploit O
the O
high O
level O
of O
trust O
among O
potential O
victims O
. O

As O
a O
result O
of O
our O
ongoing O
efforts O
, O
we O
identified O
significant O
changes O
to O
the O
group B-Organization
’s O
attack O
methodology O
. O

To O
attack O
macOS O
users O
, O
the O
Lazarus B-Organization
group I-Organization
has O
developed O
homemade O
macOS I-System
malware I-System
, O
and O
added O
an O
authentication O
mechanism O
to O
deliver O
the O
next O
stage O
payload O
very O
carefully O
, O
as O
well O
as O
loading O
the O
next-stage O
payload O
without O
touching O
the O
disk O
. O

In O
addition O
, O
to O
attack O
Windows O
users O
, O
they O
have O
elaborated O
a O
multi-stage O
infection O
procedure O
, O
and O
significantly O
changed O
the O
final O
payload O
. O

We O
assess O
that O
the O
Lazarus B-Organization
group I-Organization
has O
been O
more O
careful O
in O
its O
attacks O
following O
the O
release O
of O
Operation O
AppleJeus O
and O
they O
have O
employed O
a O
number O
of O
methods O
to O
avoid O
being O
detected O
. O

After O
releasing O
Operation O
AppleJeus O
, O
the O
Lazarus B-Organization
group I-Organization
continued O
to O
use O
a O
similar O
modus O
operandi O
in O
order O
to O
compromise O
cryptocurrency O
businesses O
. O

We O
found O
more O
macOS B-System
malware O
similar O
to O
that O
used O
in O
the O
original O
Operation O
AppleJeus O
case O
. O

This O
macOS B-System
malware O
used O
public O
source I-System
code O
in O
order O
to O
build O
crafted O
macOS O
installers O
. O

The O
malware O
authors O
used O
QtBitcoinTrader O
developed O
by O
Centrabit O
. O

These O
three O
macOS B-Organization
installers I-System
use O
a O
similar O
post O
installer O
script O
in O
order O
to O
implant O
a O
mach-o O
payload O
, O
as O
well O
as O
using O
the O
same O
command-line O
argument O
when O
executing O
the O
fetched O
second-stage O
payload O
. O

However O
, O
they O
have O
started O
changing O
their O
macOS B-System
malware I-System
. O

We O
recognized O
a O
different O
type O
of O
macOS B-System
malware I-System
, O
MarkMakingBot.dmg O
( O
be37637d8f6c1fbe7f3ffc702afdfe1d O
) O
, O
created O
on O
2019-03-12 O
. O

It O
doesn’t O
have O
an O
encryption/decryption O
routine O
for O
network O
communication O
. O

We O
speculate O
that O
this O
is O
an O
intermediate O
stage O
in O
significant O
changes O
to O
their O
macOS B-System
malware O
. O

During O
our O
ongoing O
tracking O
of O
this O
campaign O
, O
we O
found O
that O
one O
victim O
was O
compromised O
by O
Windows O
AppleJeus O
malware O
in O
March O
2019 O
. O

Unfortunately O
, O
we O
couldn’t O
identify O
the O
initial O
installer O
, O
but O
we O
established O
that O
the O
infection O
started O
from O
a O
malicious O
file I-Malware
named O
WFCUpdater.exe O
. O

At O
that O
time O
, O
the O
actor B-Organization
used O
a O
fake O
website O
: O
wfcwallet.com O
. O

The O
actor B-Organization
used O
a O
multi-stage O
infection O
like O
before O
, O
but O
the O
method O
was O
different O
. O

The O
infection O
started O
from O
.NET B-System
malware I-System
, O
disguised O
as O
a O
WFC O
wallet O
updater O
( O
a9e960948fdac81579d3b752e49aceda O
) O
. O

Upon O
execution O
, O
this O
.NET O
executable O
checks O
whether O
the O
command O
line O
argument O
is O
“ O
/Embedding O
” O
or O
not O
. O

This O
malware O
is O
responsible O
for O
decrypting O
the O
WFC.cfg O
file O
in O
the O
same O
folder O
with O
a O
hardcoded O
20-byte O
XOR O
key O
. O

This O
mimics O
the O
wallet O
updater O
connected O
to O
the O
C2 O
addresses O
: O
wfcwallet.com O
( O
resolved O
ip O
: O
108.174.195.134 O
) O
, O
www.chainfun365.com O
( O
resolved O
ip O
: O
23.254.217.53 O
) O
. O

After O
that O
, O
it O
carries O
out O
the O
malware O
operator O
’s O
commands O
in O
order O
to O
install O
the O
next O
stage O
permanent O
payload O
. O

The O
actor B-Organization
delivered O
two O
more O
files O
into O
the O
victim O
’s O
system O
folder O
: O
rasext.dll O
and O
msctfp.dat O
. O

They O
used O
the O
RasMan O
( O
Remote B-System
Access I-System
Connection I-System
Manager I-System
) O
Windows O
service O
to O
register O
the O
next O
payload O
with O
a O
persistence O
mechanism O
. O

After O
fundamental O
reconnaissance O
, O
the O
malware O
operator O
implanted O
the O
delivered O
payload O
by O
manually O
using O
the O
following O
commands O
: O
cmd.exe O
/c O
dir O
rasext.dll O
, O
cmd.exe O
/c O
dir O
msctfp.dat O
, O
cmd.exe O
/c O
tasklist O
/svc O
| O
findstr O
RasMan O
, O
cmd.exe O
/c O
reg O
add O
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\RasMan\ThirdParty O
/v O
DllName O
/d O
rasext.dll O
/f O
. O

In O
order O
to O
establish O
remote O
tunneling O
, O
the O
actor O
delivered O
more O
tools O
, O
executing O
with O
command-line O
parameters O
. O

Unfortunately O
, O
we O
have O
had O
no O
chance O
to O
obtain O
this O
file O
, O
but O
we O
speculate O
that O
Device.exe O
is O
responsible O
for O
opening O
port O
6378 O
, O
and O
the O
CenterUpdater.exe O
tool O
was O
used O
for O
creating O
tunneling O
to O
a O
remote O
host O
. O

Note O
that O
the O
104.168.167.16 O
server O
is O
used O
as O
a O
C2 O
server O
. O

The O
fake O
website O
hosting O
server O
for O
the O
UnionCryptoTrader O
case O
will O
be O
described O
next O
. O

We O
also O
found O
a O
Windows O
version O
of O
the O
UnionCryptoTrader O
( O
0f03ec3487578cef2398b5b732631fec O
) O
. O

It O
was O
executed O
from O
the O
Telegram B-System
messenger I-System
download O
folder O
: O
C:\Users\[user O
name]\Downloads\Telegram O
Desktop\UnionCryptoTraderSetup.exe O
. O

We O
also O
found O
the O
actor B-Organization
’s O
Telegram I-Organization
group I-Organization
on O
their O
fake O
website O
. O

Based O
on O
these O
, O
we O
assess O
with O
high O
confidence O
that O
the O
actor B-Organization
delivered O
the O
manipulated O
installer O
using O
the O
Telegram B-System
messenger I-System
. O

Unfortunately O
, O
we O
can’t O
get O
all O
the O
related O
files O
as O
some O
payloads O
were O
only O
executed O
in O
memory O
. O

However O
, O
we O
can O
reassemble O
the O
whole O
infection O
procedure O
based O
on O
our O
telemetry O
. O

The O
overall O
infection O
procedure O
was O
very O
similar O
to O
the O
WFCWallet O
case O
, O
but O
with O
an O
added O
injection O
procedure O
, O
and O
they O
only O
used O
the O
final O
backdoor O
payload O
instead O
of O
using O
a O
tunneling B-System
tool I-System
. O

The O
UnionCryptoTrader O
Windows O
version O
has O
the O
following O
window O
showing O
a O
price O
chart O
for O
several O
cryptocurrency O
exchanges O
. O

The O
Windows O
version O
of O
UnionCryptoTrader O
updater O
( O
629b9de3e4b84b4a0aa605a3e9471b31 O
) O
has O
similar O
functionality O
to O
the O
macOS O
version O
. O

According O
to O
the O
build O
path O
( O
Z:\Loader\x64\Release\WinloaderExe.pdb O
) O
, O
the O
malware O
author O
called O
this O
malware O
a O
loader O
. O

Upon O
launch O
, O
the O
malware O
retrieves O
the O
victim O
’s O
basic O
system O
information O
, O
sending O
it O
in O
the O
following O
HTTP O
POST O
format O
, O
as O
is O
the O
case O
with O
the O
macOS B-System
malware O
. O

If O
the O
response O
code O
from O
the O
C2 O
server O
is O
200 O
, O
the O
malware O
decrypts O
the O
payload O
and O
loads O
it O
in O
memory O
. O

Finally O
, O
the O
malware O
sends O
the O
act=done O
value O
and O
return O
code O
. O

The O
next O
stage O
payload O
( O
e1953fa319cc11c2f003ad0542bca822 O
) O
, O
downloaded O
from O
this O
loader O
, O
is O
similar O
to O
the O
.NET B-System
downloader I-System
in O
the O
WFCWallet O
case O
. O

This O
malware O
is O
responsible O
for O
decrypting O
the O
Adobe.icx O
file O
in O
the O
same O
folder O
. O

It O
injects O
the O
next O
payload O
into O
the O
Internet O
Explorer O
process O
, O
and O
the O
tainted O
iexplore.exe O
process O
carries O
out O
the O
attacker B-Organization
’s O
commands O
. O

The O
final O
payload O
( O
dd03c6eb62c9bf9adaf831f1d7adcbab O
) O
is O
implanted O
manually O
as O
in O
the O
WFCWallet O
case O
. O

This O
final O
payload O
was O
designed O
to O
run O
only O
on O
certain O
systems O
. O

It O
seems O
that O
the O
malware O
authors O
produced O
and O
delivered O
malware O
that O
only O
works O
on O
specific O
systems O
based O
on O
previously O
collected O
information O
. O

The O
malware O
checks O
the O
infected O
system O
’s O
information O
and O
compares O
it O
to O
a O
given O
value O
. O

It O
seems O
the O
actor O
wants O
to O
execute O
the O
final O
payload O
very O
carefully O
, O
and O
wants O
to O
evade O
detection O
by O
behavior-based O
detection O
solutions O
. O

This O
Windows B-System
malware O
loads O
the O
encrypted O
msctfp.dat O
file O
in O
a O
system O
folder O
, O
and O
loads O
each O
configuration O
value O
. O

Then O
it O
executes O
an O
additional O
command O
based O
on O
the O
contents O
of O
this O
file O
. O

When O
the O
malware O
communicates O
with O
the O
C2 O
server O
, O
it O
uses O
a O
POST O
request O
with O
several O
predefined O
headers O
. O

Finally O
, O
the O
malware O
downloads O
the O
next O
stage O
payload O
, O
decrypting O
it O
and O
possibly O
executing O
it O
with O
the O
Print O
parameter O
. O

We O
speculate O
that O
the O
DLL O
type O
payload O
will O
be O
downloaded O
and O
call O
its O
Print O
export O
function O
for O
further O
infection O
. O

We O
can’t O
get O
hold O
of O
the O
final O
payload O
that O
’s O
executed O
in O
memory O
, O
but O
we O
believe O
its O
backdoor-type O
malware O
is O
ultimately O
used O
to O
control O
the O
infected O
victim O
. O

We O
were O
able O
to O
identify O
several O
victims O
in O
this O
Operation O
AppleJeus O
sequel O
. O

Victims O
were O
recorded O
in O
the O
UK O
, O
Poland O
, O
Russia O
and O
China O
. O

Moreover O
, O
we O
were O
able O
to O
confirm O
that O
several O
of O
the O
victims O
are O
linked O
to O
cryptocurrency O
business O
entities O
. O

The O
actor O
altered O
their O
macOS B-System
and O
Windows B-System
malware O
considerably I-System
, O
adding O
an O
authentication O
mechanism O
in O
the O
macOS B-System
downloader O
and O
changing O
the O
macOS O
development O
framework O
. O

The O
binary O
infection O
procedure O
in O
the O
Windows O
system O
differed O
from O
the O
previous O
case O
. O

They O
also O
changed O
the O
final O
Windows O
payload O
significantly O
from O
the O
well-known O
Fallchill O
malware O
used O
in O
the O
previous O
attack O
. O

We O
believe O
the O
Lazarus B-Organization
group I-Organization
’s O
continuous O
attacks O
for O
financial O
gain O
are O
unlikely O
to O
stop O
anytime O
soon O
. O

Since O
the O
initial O
appearance O
of O
Operation O
AppleJeus O
, O
we O
can O
see O
that O
over O
time O
the O
authors O
have O
changed O
their O
modus O
operandi O
considerably O
. O

NEW O
CYBER O
ESPIONAGE O
CAMPAIGNS O
TARGETING O
PALESTINIANS O
Over O
the O
last O
several O
months O
, O
the O
Cybereason B-Organization
Nocturnus I-Organization
team O
has O
been O
tracking O
recent O
espionage O
campaigns O
targeting O
the O
Middle O
East O
. O

These O
campaigns O
are O
specifically O
directed O
at O
entities O
and O
individuals O
in O
the O
Palestinian O
territories O
. O

This O
investigation O
shows O
multiple O
similarities O
to O
previous O
attacks O
attributed O
to O
a O
group O
called O
MoleRATs B-Organization
( O
aka O
The O
Gaza B-Organization
Cybergang I-Organization
) O
, O
an O
Arabic-speaking O
, O
politically O
motivated O
group O
that O
has O
operated O
in O
the O
Middle O
East O
since O
2012 O
. O

In O
our O
analysis O
, O
we O
distinguish O
between O
two O
separate O
campaigns O
happening O
simultaneously O
. O

These O
campaigns O
differ O
in O
tools O
, O
server O
infrastructure O
, O
and O
nuances O
in O
decoy O
content O
and O
intended O
targets O
. O

The O
Spark O
Campaign O
: O
This O
campaign O
uses O
social B-Vulnerability
engineering O
to O
infect O
victims O
, O
mainly O
from O
the O
Palestinian O
territories O
, O
with O
the O
Spark B-Malware
backdoor I-Malware
. O

This O
backdoor O
first O
emerged O
in O
January O
2019 O
and O
has O
been O
continuously O
active O
since O
then O
. O

The O
campaign O
’s O
lure O
content O
revolves O
around O
recent O
geopolitical O
events O
, O
espeically O
the O
Israeli-Palestinian O
conflict O
, O
the O
assassination O
of O
Qasem O
Soleimani O
, O
and O
the O
ongoing O
conflict O
between O
Hamas O
and O
Fatah O
Palestinian O
movements O
. O

The O
Pierogi B-System
Campaign O
: O
This O
campaign O
uses O
social O
engineering O
attacks O
to O
infect O
victims O
with O
a O
new O
, O
undocumented O
backdoor O
dubbed O
Pierogi B-System
. O

This O
backdoor O
first O
emerged O
in O
December O
2019 O
, O
and O
was O
discovered O
by O
Cybereason B-Organization
. O

In O
this O
campaign O
, O
the O
attackers B-Organization
use O
different O
TTPs O
and O
decoy B-System
documents I-System
reminiscent O
of O
previous O
campaigns O
by O
MoleRATs B-Organization
involving O
the O
Micropsia B-System
and O
Kaperagent O
malware O
. O

In O
part O
one O
of O
this O
research O
, O
we O
analyze O
the O
Spark O
campaign O
. O

This O
campaign O
is O
named O
after O
a O
rare O
backdoor O
used O
by O
the O
MoleRATs B-Organization
Group I-Organization
, O
dubbed O
Spark O
by O
Cybereason B-Organization
and O
previously O
reported O
by O
360 B-Organization
’s I-Organization
blog O
. O

The O
creators O
of O
the O
Spark B-Malware
backdoor I-Malware
use O
several O
techniques O
to O
evade O
detection O
and O
stay O
under O
the O
radar O
. O

They O
pack O
the O
malware O
with O
a O
powerful O
commercial O
tool O
called O
Enigma O
Packer O
and O
implement B-System
language O
checks O
to O
ensure O
the O
victims O
are O
Arabic O
speaking O
. O

This O
minimizes O
the O
risk O
of O
detection O
and O
infection O
of O
unwanted O
victims O
. O

Cyber B-Organization
Espionage O
in O
the O
Middle O
East O
: O
The O
Cybereason B-Organization
Nocturnus I-Organization
team O
has O
discovered O
several O
recent O
, O
targeted O
attacks O
in O
the O
Middle O
East O
. O

These O
attacks O
deliver O
the O
Spark B-System
and O
Pierogi B-System
backdoors I-System
for O
politically-driven O
cyber O
espionage O
operations O
. O

Targeting O
Palestinians O
: O
The O
campaigns O
seems O
to O
target O
Palestinian O
individuals O
and O
entities O
, O
likely O
related O
to O
the O
Palestinian O
government O
. O

Politically-motivated O
APT O
: O
Cybereason B-Organization
suspects O
that O
the O
objective O
of O
the O
threat B-Organization
actor I-Organization
is O
to O
obtain O
sensitive O
information O
from O
the O
victims O
and O
leverage O
it O
for O
political O
purposes O
. O

Lured O
Into O
Deploying O
a O
Backdoor O
: O
The O
attackers B-Organization
use O
specially O
crafted O
lure O
content O
to O
trick O
targets O
into O
opening O
malicious O
files O
that O
infect O
the O
victim O
’s O
machine O
with O
a O
backdoor O
. O

The O
lure O
content O
in O
the O
malicious O
files O
relates O
to O
political O
affairs O
in O
the O
Middle O
East O
, O
with O
specific O
references O
to O
the O
Israeli-Palestinian O
conflict O
, O
tension O
between O
Hamas B-Organization
and O
Fatah B-Organization
, O
and O
other O
political O
entities O
in O
the O
region O
. O

Perpetrated O
by O
an O
Arabic-Speaking O
APT O
Group I-Organization
: O
The O
modus-operandi O
of O
the O
attackers B-Organization
in O
conjunction O
with O
the O
social B-Vulnerability
engineering O
tactics O
and O
decoy O
content O
seem O
aligned O
with O
previous O
attacks O
carried O
out O
by O
the O
Arabic-speaking O
APT O
group I-Organization
MoleRATs B-Organization
( O
aka O
Gaza B-Organization
Cybergang I-Organization
) O
. O

This O
group B-Organization
has O
been O
operating O
in O
the O
Middle O
East O
since O
2012 O
. O

These O
attacks O
show O
significant O
similarities O
to O
previously O
documented O
attacks O
attributed O
to O
the O
Arabic-speaking O
threat B-Organization
actor O
, O
commonly O
referred O
to O
as O
the O
MoleRATs B-Organization
group I-Organization
( O
aka O
, O
The O
Gaza B-Organization
Cybergang I-Organization
, O
Moonlight B-Organization
, O
DustySky B-Organization
, O
Gaza B-Organization
Hacker I-Organization
Team I-Organization
) O
. O

This O
group O
, O
which O
has O
been O
attributed O
by O
various O
security O
teams O
, O
is O
believed O
to O
be O
comprised O
of O
three O
subgroups O
: O
Gaza B-Organization
Cybergang I-Organization
Group I-Organization
1 O
, O
also O
dubbed O
MoleRATs B-Organization
: O
MoleRATs B-Organization
has O
been O
active O
since O
at O
least O
2012 O
. O

This O
Arabic-speaking O
group O
uses O
spear B-Vulnerability
phishing O
attacks O
to O
infect O
target O
machines O
in O
the O
Middle O
East O
and O
North O
Africa O
with O
various O
Remote B-System
Access I-System
Trojans O
( O
RATs B-System
) O
. O

As O
MoleRATs B-Organization
most O
prominently O
targets O
Palestinian O
territories O
, O
its O
spear B-Vulnerability
phishing O
attacks O
often O
use O
attached O
malicious O
documents O
on O
topical O
Palestinian O
Authority-related O
issues O
to O
lure O
their O
victims O
. O

The O
group B-Organization
uses O
a O
mix O
of O
tools I-System
and O
malware O
, O
some O
developed O
by O
the O
group B-Organization
and O
others O
that O
are O
more O
generic O
tools O
. O

Gaza B-Organization
Cybergang I-Organization
Group I-Organization
2 O
, O
also O
dubbed O
Desert B-Organization
Falcons I-Organization
, O
APT-C-23 B-Organization
, O
Arid O
Viper O
. O

This O
second O
group B-Organization
is O
an O
Arabic-speaking O
group O
that O
mainly O
targets O
the O
Middle O
East O
and O
North O
Africa O
, O
with O
a O
few O
targets O
in O
European O
and O
Asian O
countries O
as O
well O
. O

The O
group B-Organization
is O
known O
for O
their O
advanced O
attacks O
that O
leverage O
custom-built B-System
Windows B-System
malware I-System
( O
Kasperagent O
, O
Micropsia B-System
) O
as O
well O
as O
Android B-System
malware I-System
( O
Vamp O
, O
GnatSpy B-System
) O
. O

Gaza B-Organization
Cybergang I-Organization
Group I-Organization
3: O
This O
group B-Organization
is O
believed O
to O
be O
behind O
Operation B-Organization
Parliament I-Organization
. O

It O
is O
considered O
to O
be O
the O
most O
advanced O
group O
of O
the O
three O
, O
and O
is O
focused O
on O
high-profile O
targets O
in O
the O
Middle O
East O
, O
North O
America O
, O
Europe O
and O
Asia O
. O

The O
group B-Organization
is O
reported O
to O
have O
previously O
attacked O
government B-Organization
institutions I-Organization
, O
parliaments O
, O
senates O
, O
diplomatic O
functions O
, O
and O
even O
Olympic O
and O
other O
sports O
bodies O
. O

It O
is O
important O
to O
remember O
there O
are O
many O
threat B-Organization
actors O
operating O
in O
the O
Middle O
East O
, O
and O
often O
there O
are O
overlaps O
in O
TTPs O
, O
tools O
, O
motivation O
, O
and O
victimology O
. O

There O
have O
been O
cases O
in O
the O
past O
where O
a O
threat B-Organization
actor O
attempted O
to O
mimic O
another O
to O
thwart O
attribution O
efforts O
, O
and O
as O
such O
, O
attribution O
should O
rarely O
be O
taken O
as O
is O
, O
but O
instead O
with O
a O
grain O
of O
salt O
and O
critical O
thinking O
. O

In O
this O
attack O
, O
the O
targets O
are O
lured O
to O
open O
a O
document O
or O
a O
link O
attached O
to O
an O
email O
. O

There O
have O
been O
cases O
in O
the O
past O
where O
victims O
also O
downloaded O
malicious O
content O
from O
fake O
news O
websites I-System
. O

The O
names O
of O
the O
files O
and O
their O
content O
play O
a O
major O
part O
in O
luring O
victims O
to O
open O
them O
, O
as O
they O
usually O
relate O
to O
current O
topics O
pertaining O
to O
Hamas O
, O
the O
Palestinian O
National O
Authority O
, O
or O
other O
recent O
events O
in O
the O
Middle O
East O
. O

The O
lure O
documents O
analyzed O
by O
Cybereason B-Organization
in O
this O
attack O
concentrate O
on O
the O
following O
themes O
: O
The O
Conflict O
between O
Hamas B-Organization
and O
Fatah B-Organization
: O
The O
historical O
rivalry O
between O
the O
Hamas B-Organization
and O
Fatah B-Organization
has O
resulted O
in O
many O
open O
battles O
between O
the O
two O
entities O
. O

Since O
2006 O
, O
Hamas B-Organization
has O
controlled O
the O
Gaza B-Organization
strip O
and O
Fatah B-Organization
has O
controlled O
the O
West O
Bank O
. O

Matters O
pertaining O
to O
the O
Israeli-Palestinian O
Conflict O
: O
Some O
of O
the O
documents O
in O
this O
campaign O
reference O
different O
aspects O
of O
the O
Israeli-Palestinian O
conflict O
, O
and O
the O
efforts O
for O
ceasefire O
and O
peace O
processes O
between O
the O
Israelis O
and O
the O
Palestinians O
, O
including O
the O
latest O
peace O
plan O
made O
by O
President O
Donald O
Trump O
and O
Senior O
Advisor O
to O
the O
President O
of O
the O
United O
States O
Jared O
Kushner O
. O

Vigilance O
Following O
Soleimani O
’s O
Assassination O
: O
One O
of O
the O
lure O
documents O
mentions O
sources O
in O
Lebanon O
that O
report O
a O
state O
of O
alert O
and O
vigilance O
amongst O
Iranian O
, O
Syrian O
, O
and O
Lebasense O
militias O
following O
Soleimani O
’s O
assassination O
. O

Tensions O
Between O
Hamas O
and O
the O
Egyptian O
Government O
: O
Egypt O
plays O
a O
major O
role O
as O
a O
mediator O
in O
the O
Israeli-Palestinian O
confict O
and O
has O
brokered O
several O
ceasefire O
deals O
and O
other O
negotiations O
in O
the O
past O
. O

Changes O
to O
Egypt O
’s O
internal O
political O
climate O
are O
known O
to O
have O
affected O
Egyptian O
government O
relations O
with O
Hamas O
over O
the O
years O
. O

It O
was O
recently O
reported O
that O
Ismail O
Haniyeh O
, O
the O
head O
of O
Hamas B-Organization
’ O
political O
Bureau O
, O
had O
a O
falling-out O
with O
the O
Egyptian O
government O
over O
his O
visit O
to O
Tehran O
to O
participate O
in O
General O
Qasem O
Soleimani O
’s O
funeral O
, O
following O
Soleimani O
’s O
assassination O
. O

In O
the O
Spark O
campaign O
, O
the O
lure O
documents O
and O
links O
point O
to O
one O
of O
two O
file O
sharing O
websites O
, O
Egnyte O
or O
Dropbox B-Malware
. O

The O
target O
is O
encouraged O
to O
download O
an O
archive O
file O
in O
a O
rar O
or O
zip O
format O
that O
contains O
an O
executable O
file O
masquerading O
as O
a O
Microsoft B-Malware
Word I-Malware
document I-Malware
. O

One O
example O
of O
a O
lure O
document O
used O
in O
the O
Spark O
campaign O
is O
a O
PDF O
file I-Malware
that O
is O
used O
to O
deliver O
the O
Spark B-Malware
backdoor I-System
to O
the O
victim O
. O

The O
document B-Malware
includes O
a O
special O
report O
allegedly O
quoted O
from O
the O
Egyptian O
newspaper O
Al-Ahram O
. O

This O
document O
reports O
that O
Ismail O
Hanieyh O
, O
the O
political O
leader O
of O
Hamas O
, O
had O
notified O
the O
Egyptian O
government O
that O
he O
will O
remain O
abroad O
after O
his O
visit O
to O
Tehran O
to O
take O
part O
in O
Soleimani O
’s O
funeral O
, O
which O
sparked O
tension O
with O
the O
Egyptian O
authorities O
. O

Haniyeh_will_remain_abroad_and_Hamas_rises_in_Gaza.pdf O
: O
5b476e05aacea9edc14f7e4bab1b724ef54915f30c39ac87503ed395feae611e O
. O

The O
target O
is O
encouraged O
to O
click O
on O
the O
link O
to O
read O
the O
entire O
article O
. O

However O
, O
the O
document B-Malware
does O
not O
link O
to O
the O
Egyptian O
Newspaper O
website O
, O
but O
instead O
to O
a O
file O
sharing O
website O
called O
Egnyte O
. O

It O
prompts O
the O
user O
to O
download O
a O
file O
that O
supposedly O
contains O
the O
full O
article O
. O

Link O
embedded O
in O
the O
PDF B-System
document I-Malware
: O
https://csaasd.egnyte.com/dd/h5s7YHzOy5 O
. O

The O
downloaded O
file O
is O
an O
archive O
file O
( O
.r23 O
) O
, O
that O
contains O
a O
Windows B-System
executable O
file O
with O
the O
same O
name O
as O
the O
PDF B-System
and O
with O
a O
fake O
Microsoft I-Malware
Word I-Malware
icon O
. O

Hanieh_will_remain_abroad_and_Hamas_steps_up_in_Gaza.r23 O
: O
e8d73a94d8ff18c7791bf4547bc4ee2d3f62082c594d3c3cf7d640f7bbd15614 O
. O

Hanieh_will_remain_abroad_and_Hamas_steps_up_in_Gaza.exe O
: O
7bb719f1c64d627ecb1f13c97dc050a7bb1441497f26578f7b2a9302adbbb128 O
. O

When O
the O
victim O
double O
clicks O
on O
the O
executable O
file O
, O
it O
unpacks O
and O
installs O
the O
Spark B-System
backdoor I-System
, O
as O
shown O
in O
the O
attack O
tree O
screenshot O
below O
. O

The O
extracted O
executable O
file O
contains O
a O
compiled O
Autoit O
script O
, O
which O
can O
be O
seen O
in O
the O
RT_RCDATA O
section O
of O
the O
file O
. O

The O
decompiled O
code O
shows O
the O
decryption O
routine O
that O
unpacks O
the O
embedded O
Spark B-Malware
backdoor I-System
. O

Once O
the O
file O
is O
unpacked O
, O
the O
backdoor O
is O
dropped O
in O
two O
different O
locations O
on O
the O
infected O
operating O
system O
: O
C:\Users\user\AppData\Roaming\Microsoft\Windows\Start O
Menu\Programs\Startup\runawy.exe O
. O

C:\Users\user\runawy.exe O
. O

In O
addition O
, O
the O
Autoit O
code O
also O
creates O
the O
following O
scheduled O
task O
for O
persistence O
: O
SCHTASKS O
/Create O
/f O
/SC O
minute O
/TN O
runawy O
/mo O
5 O
/tr O
C:\Users\<USER>\runawy.exe O
. O

Urgent_Information_Report.exe O
: O
6e896099a3ceb563f43f49a255672cfd14d88799f29617aa362ecd2128446a47 O
. O

The O
executable O
has O
a O
Microsoft B-Malware
Word I-Malware
icon O
to O
trick O
victims O
into O
believing O
they O
are O
opening O
a O
Word B-Malware
document I-Malware
. O

Once O
the O
user O
double-clicks O
on O
the O
executable O
file O
, O
the O
dropper O
drops O
a O
Word B-Malware
document I-Malware
in O
%AppData% O
and O
displays O
the O
following O
decoy O
document O
to O
the O
victim O
, O
while O
the O
dropper O
runs O
in O
the O
background O
and O
installs O
the O
backdoor O
. O

%appdata%\info.docx O
: O
2c50eedc260c82dc176447aa4116ad37112864f4e1e3e95c4817499d9f18a90d O
. O

The O
dropper O
drops O
the O
Spark B-System
backdoor I-System
binary I-System
and O
a O
shortcut B-Malware
file I-Malware
used O
to O
initiate O
persistence O
in O
the O
following O
locations O
. O

C:\Users\user\AppData\Roaming\Microsoft\Windows\Start O
Menu\Programs\Startup\Blaster.lnk O
: O
4254dc8c368cbc36c8a11035dcd0f4b05d587807fa9194d58f0ba411bfd65842 O
. O

C:\Users\user\AppData\Roaming\Blaster.exe O
: O
cf32479ed30ae959c4ec8a286bb039425d174062b26054c80572b4625646c551 O
. O

The O
Spark B-Malware
payload O
is O
a O
custom O
backdoor O
likely O
developed O
by O
the O
MoleRATs B-Organization
group I-Organization
. O

In O
addition O
to O
known O
generic O
malware I-System
( O
such O
as O
: O
njRAT B-System
, O
Poison B-System
Ivy I-System
, O
XtremeRAT B-System
) O
, O
the O
MoleRATs B-Organization
group I-Organization
has O
been O
known O
to O
develop O
its O
own O
custom O
tools O
such O
as O
DustySky B-System
, O
the O
MoleRAT O
Loader O
and O
Scote B-System
. O

We O
believe O
this O
backdoor O
is O
relatively O
new O
and O
seems O
to O
have O
appeared O
starting O
in O
the O
beginning O
of O
2019 O
. O

The O
name O
Spark O
is O
derived O
from O
the O
PDB O
path O
left O
in O
a O
few O
of O
the O
backdoor O
binaries O
: O
W:\Visual O
Studio O
2017\Spark4.2\Release\Spark4.2.pdb O
. O

The O
Spark B-Malware
backdoor I-Malware
allows O
the O
attackers O
to O
: O
Collect O
information O
about O
the O
infected O
machine O
. O

Encrypt O
the O
collected O
data O
and O
send O
it O
to O
the O
attackers B-Organization
over O
the O
HTTP O
protocol O
. O

Download O
additional O
payloads O
. O

Log O
keystrokes O
. O

Record O
audio O
using O
the O
computer O
’s O
microphone O
. O

Execute O
commands O
on O
the O
infected O
machine O
. O

The O
creators O
of O
the O
Spark B-Malware
backdoor I-Malware
use O
a O
few O
techniques O
that O
are O
intended O
to O
keep O
the O
backdoor O
under-the-radar O
, O
including O
: O
Packing O
the O
payloads O
with O
the O
Enigma O
packer O
. O

Checking O
for O
antivirus O
and O
other O
security O
products O
using O
WMI B-System
. O

Validating O
Arabic O
keyboard O
and O
language O
settings O
on O
the O
infected O
machine O
. O

All O
the O
the O
payloads O
observed O
by O
Cybereason B-Organization
in O
this O
campaign O
were O
packed O
by O
a O
powerful O
yet O
commercial O
packer O
called O
Enigma O
Packer O
. O

The O
MoleRATs B-Organization
group I-Organization
have O
been O
known O
to O
use O
this O
packer O
in O
previous O
attacks O
. O

Enigma O
packer O
artifacts O
in O
file O
metadata O
( O
SHA-256: O
b08b8fddb9dd940a8ab91c9cb29db9bb611a5c533c9489fb99e36c43b4df1eca O
) O
. O

One O
common O
evasive O
mechanism O
used O
by O
the O
Spark B-Malware
backdoor I-System
is O
its O
ability O
to O
check O
for O
installed O
security O
products O
using O
WMI O
queries O
( O
WQL O
) O
. O

If O
certain O
security O
products O
are O
installed O
, O
the O
backdoor O
does O
not O
carry O
out O
its O
malicious O
activity O
. O

Another O
evasive O
mechanism O
used O
by O
the O
backdoor B-Malware
is O
how O
it O
checks O
whether O
an O
Arabic O
keyboard O
and O
Arabic O
language O
settings O
are O
used O
on O
the O
infected O
machine O
. O

If O
Arabic O
keyboard O
and O
language O
settings O
are O
not O
found O
on O
the O
machine O
, O
the O
backdoor O
will O
not O
carry O
out O
its O
malicious O
activity O
. O

This O
check O
serves O
two O
purposes O
: O
It O
minimizes O
the O
risk O
of O
overexposure O
by O
specifically O
targeting O
Arabic O
speakers O
. O

It O
can O
thwart O
detection O
by O
automated O
analysis O
engines O
and O
sandbox O
solutions O
. O

After O
unpacking O
itself O
, O
the O
Spark B-Malware
backdoor I-Malware
creates O
a O
hidden O
window O
where O
most O
of O
the O
malicious O
activity O
is O
handled O
. O

This O
behavior O
can O
be O
detected O
using O
a O
tool O
called O
WinLister B-System
, O
which O
enumerates O
hidden O
windows O
. O

The O
name O
of O
the O
window O
is O
Spark4.2 O
. O

The O
Spark B-Malware
backdoor I-Malware
communicates O
with O
the O
C2 O
servers O
over O
the O
HTTP O
protocol O
. O

The O
data O
is O
first O
encrypted O
and O
then O
encoded O
with O
Base64 O
. O

In O
this O
instance O
, O
the O
backdoor O
posts O
the O
data O
to O
the O
domain O
Nysura.com O
( O
For O
more O
domains O
, O
please O
see O
the O
IOC O
section O
of O
this O
research O
) O
. O

It O
is O
interesting O
to O
see O
that O
the O
HTTP O
POST O
host O
header O
refers O
to O
a O
legitimate O
domain O
cnet.com O
, O
however O
, O
in O
acutality O
, O
the O
data O
is O
sent O
to O
nysura.com O
, O
as O
can O
be O
seen O
in O
the O
traffic O
screenshot O
below O
. O

The O
data O
sent O
to O
the O
C2 O
follows O
a O
structured O
pattern O
that O
uses O
a O
predefined O
keywords O
array O
, O
where O
each O
keyword O
is O
mapped O
to O
a O
certain O
subroutine O
. O

The O
keywords O
are O
comprised O
of O
the O
names O
of O
individuals O
. O

They O
are O
mostly O
Western O
names O
, O
but O
there O
were O
some O
Arabic O
names O
in O
a O
few O
of O
the O
samples O
. O

Prior O
to O
sending O
the O
data O
to O
the O
server O
, O
the O
data O
is O
encrypted O
and O
staged O
in O
an O
array O
like O
this O
: O
[27089,28618,9833,4170,25722,19977,2369,21426,3435,7442,30146,21719,16140,16280,16688,22550,19867,194,3298] O
. O

The O
data O
is O
then O
encoded O
with O
Base64 O
: O
" O
WzI3MDg5LDI4NjE4LDk4MzMsNDE3MCwyNTcyMiwxOTk3NywyMzY5LDIxNDI2LDM0MzUsNzQ0MiwzMDE0NiwyMTcxOSwxNjE0MCwxNjI4MCwxNjY4OCwyMjU1MCwxOTg2NywxOTQsMzI5OF0= O
" O
. O

The O
Base64-encoded O
data O
is O
inserted O
into O
the O
following O
json O
object O
, O
which O
contains O
the O
individual O
names O
. O

Lastly O
, O
the O
entire O
json O
object O
is O
encoded O
with O
Base64 O
and O
undergoes O
another O
stage O
of O
encryption O
, O
and O
then O
sent O
to O
the O
server O
: O
" O
ZjRTc1dTTU9nVW5FaXM3bGgvbU90MTlVMHFkb1c5SFFuRXhhSVR5YytIQkZremk3bk5wY21BUEZRYitJenA1cnlJY1lxREJJZ1RrL0N4UzZWcVVQM0pTUWFISlhKWG8wN1BxWE1hYThHSUdEVnBFakYrNlp1bXBvdUZMRFNYQVhxYk9tSElWYTFOTlpJK0hFVVBmTG9CQUV3VCtqQ2FCVUE1aHQ2SzllSHREMUpOdkdBUXZ3TWgyLzhtVHpha2I0TE81ZlpURTQyUmVjdFY1M0ZpemlRR1FLL1gzNE9mcU0zR0JqQ1ZnN1hCSmFGaC94RHBDMkNBRmZaSTVoVlhsaTBtQW5SR3N5QzVRY2lMNkpZVFJuRTQrUzBjdjU4SjY4ejRCL2FNbW9IakRheHdQd1RPUElkOHNDbDRVbmp2ZDM0ZVZlZTB1QVA0UHo0YllyVHRMZVRnPT0= O
" O
. O

Using O
names O
as O
keywords O
is O
an O
identical O
technique O
to O
that O
of O
the O
data O
structure O
logic O
previously O
documented O
by O
360 B-Organization
’s O
blog O
post O
. O

This O
post O
discusses O
an O
earlier O
variant O
of O
the O
backdoor O
attributed O
to O
the O
MoleRATs B-Organization
group I-Organization
. O

Using O
other O
individuals O
names O
for O
C2 O
communication O
has O
also O
been O
done O
by O
the O
two O
other O
Gaza B-Organization
Cybergang I-Organization
groups I-Organization
: O
Gaza B-Organization
Cybergang I-Organization
Group I-Organization
2 O
with O
the O
Micropsia B-Malware
backdoor I-System
: O
In O
this O
instance O
, O
the O
C2 O
communication O
implemented O
by O
the O
Micropsia B-Malware
backdoor I-System
also O
used O
specific O
names O
for O
different O
C2 O
commands O
. O

Gaza B-Organization
Cybergang I-Organization
Group I-Organization
3 O
in O
Operation O
Parliament O
: O
In O
this O
instance O
, O
the O
malware O
also O
used O
people O
’s O
names O
for O
C2 O
communication O
to O
send O
and O
receive O
commands O
from O
the O
server O
. O

Based O
on O
the O
similarity O
of O
the O
naming O
convention O
and O
data O
format O
, O
we O
believe O
the O
Spark B-Malware
backdoor I-Malware
could O
be O
an O
evolution O
of O
the O
backdoor O
mentioned O
in O
Operation O
Parliament O
, O
or O
at O
least O
inspired O
by O
the O
malware O
. O

The O
Spark O
campaign O
detailed O
in O
this O
blog O
demonstrates O
how O
the O
tense O
geopolitical O
climate O
in O
the O
Middle O
East O
is O
used O
by O
threat B-Organization
actors O
to O
lure O
victims O
and O
infect O
them O
with O
the O
Spark B-Malware
backdoor I-System
for O
cyber O
espionage O
purposes O
. O

The O
names O
of O
the O
files O
and O
decoy O
content O
seem O
to O
be O
carefully O
crafted O
, O
often O
referencing O
controversial O
and O
topical O
political O
issues O
. O

Cybereason B-Organization
estimates O
that O
the O
files O
are O
specifically O
meant O
to O
lure O
and O
appeal O
to O
victims O
from O
the O
Middle O
East O
, O
especially O
towards O
individuals O
and O
entities O
in O
the O
Palestinian O
territories O
likely O
related O
to O
the O
Palestinian O
government O
or O
the O
Fatah B-Organization
movement O
. O

The O
techniques O
, O
tools O
, O
and O
procedures O
used O
in O
this O
campaign O
bear O
great O
resemblance O
to O
previous O
attacks O
attributed O
to O
the O
MoleRATs B-Organization
Group I-Organization
( O
aka O
Gaza B-Organization
Cybergang I-Organization
Group I-Organization
) O
, O
an O
Arabic-speaking O
, O
politically O
motivated O
group O
that O
has O
operated O
in O
the O
Middle O
East O
since O
2012 O
. O

Our O
research O
demonstrates O
the O
efforts O
used O
by O
attackers B-Organization
to O
reduce O
the O
risk O
of O
detection O
of O
the O
Spark B-Malware
backdoor I-Malware
by O
various O
security O
products O
. O

The O
backdoor O
checks O
for O
the O
existence O
of O
antivirus O
and O
firewall O
products O
before O
it O
initiates O
its O
malicious O
activity O
. O

Importantly O
, O
the O
backdoor O
simply O
will O
not O
reveal O
its O
malicious O
nature O
unless O
Arabic O
language O
keyboard O
and O
settings O
are O
found O
on O
the O
infected O
machine O
. O

This O
shows O
how O
the O
attackers B-Organization
use O
this O
backdoor O
in O
a O
surgical O
way O
to O
exclusively O
attack O
specific O
targets O
. O

In O
addition O
, O
analysis O
of O
these O
backdoor O
delivery O
methods O
also O
highlights O
a O
trend O
by O
many O
threat B-Organization
actors O
where O
they O
use O
legitimate O
storage O
platforms O
to O
deliver O
the O
initial O
stages O
of O
the O
attack O
. O

Reviving O
MuddyC3 O
Used O
by O
MuddyWater B-Organization
( O
IRAN O
) O
APT O
. O

MuddyWater B-Organization
is O
a O
well-known O
threat B-Organization
actor O
group O
founded O
by O
Iran O
. O

“ O
that O
has O
been O
active O
since O
2017 O
. O

They O
target O
groups O
across O
Middle O
East O
and O
Central O
Asia O
, O
primarily O
using O
spear B-Vulnerability
phishing I-Vulnerability
emails I-Vulnerability
with O
malicious O
attachments O
. O

Most O
recently O
they O
were O
connected O
to O
a O
campaign O
in O
March O
that O
targeted O
” O
organizations O
in O
Turkey O
, O
Pakistan O
, O
and O
Tajikistan O
. O

MuddyWater O
attacks O
are O
characterized O
by O
the O
use O
of O
a O
slowly O
evolving O
PowerShell-based B-System
first O
stage I-System
backdoor O
we O
call O
“ O
POWERSTATS B-System
” O
. O

Despite O
broad O
scrutiny O
and O
reports O
on O
MuddyWater O
attacks O
, O
the O
activity O
continues O
with O
only O
incremental O
changes O
to O
the O
tools O
and O
techniques O
. O

In O
June O
26 O
2019 O
a O
group O
called O
“ O
Green O
Leakers O
” O
on O
telegram O
published O
screenshots O
of O
the O
C2 O
admin O
panel O
as O
you O
can O
see O
below O
along O
with O
screenshot O
of O
the O
muddyc3 O
c2 O
source O
code O
. O

they O
announced O
that O
they O
are O
selling O
all O
the O
leaked O
tools O
for O
0.5BTC O
. O

At O
that O
time O
i O
got O
the O
source O
code O
from O
github O
, O
so O
i O
tried O
the O
code O
to O
find O
that O
the O
core O
of O
the O
c2 O
which O
is O
powershell O
payload O
is O
messing O
( O
the O
leaker O
didn’t O
include O
the O
payload O
in O
order O
to O
by O
all O
the O
tools O
) O
. O

so O
i O
didn’t O
have O
time O
to O
reverse O
engineer O
the O
source O
code O
and O
i O
left O
it O
. O

last O
week O
i O
got O
3 O
days O
off O
from O
my O
work O
( O
working O
in O
SOC O
will O
keep O
you O
for O
ever O
busy O
) O
so O
i O
started O
analyzing O
the O
code O
which O
will O
be O
discussed O
below O
and O
i O
was O
able O
to O
understand O
how O
it O
works O
in O
order O
to O
create O
the O
messing O
powershell O
payload O
and O
make O
the O
c2 O
come O
to O
life O
. O

I O
didn’t O
just O
revive O
the O
C2 O
but O
also O
added O
more O
advanced O
functionality O
which O
will O
be O
released O
as O
separate O
tool O
soon O
. O

Lets O
start O
by O
giving O
a O
summary O
about O
the O
muddyc3 O
tool O
: O
Coded O
with O
python2.7 O
. O

works O
as O
C2 O
server O
that O
serve O
a O
powershell O
agent O
script O
when O
requested O
. O

i O
didn’t O
find O
any O
function O
to O
encrypt O
the O
traffic O
between O
the O
the O
agent O
and O
the O
C2 O
but O
there O
are O
variables O
with O
name O
private_key O
, O
public_key O
so O
i O
suspect O
the O
functions O
removed O
. O

its O
make O
use O
of O
HTA B-System
and O
bas64 O
encoded O
powershell O
code O
to O
bypass O
the O
AV O
( O
right O
now O
AV O
can O
catch O
HTA O
) O
. O

It O
use O
threading O
so O
many O
agent O
can O
connect O
and O
controlled O
at O
the O
same O
time O
. O

the O
agent O
must O
collect O
information O
about O
the O
system O
when O
it O
first O
start O
then O
report O
it O
to O
the O
C2 O
. O

there O
is O
template O
for O
agent O
which O
will O
be O
filled O
with O
ip O
and O
port O
when O
the O
C2 O
run O
. O

include O
functions O
but O
not O
all O
implemented O
in O
the O
initial O
POC O
: O
upload O
, O
download O
, O
load O
modules O
, O
get O
screenshot O
. O

The O
initial O
powershell O
agent O
POC O
i O
created O
can O
bypass O
the O
AV O
including O
Kaspersky B-Organization
, O
Trendmicro O
. O

Now O
we O
dig O
deep O
in O
the O
C2 O
to O
explain O
how O
it O
work O
and O
how O
i O
created O
the O
agent O
based O
on O
the O
function O
available O
in O
the O
C2 O
. O

C2 O
interface O
: O
simple O
CLI O
interface O
that O
ask O
when O
started O
for O
IP O
,Port O
and O
proxy O
configuration O
to O
generate O
the O
initial O
payloads O
. O

The O
Nitro O
Attacks O
. O

This O
document O
discusses O
a O
recent O
targeted O
attack O
campaign O
directed O
primarily O
at O
private O
companies O
involved O
in O
the O
research O
, O
development O
, O
and O
manufacture O
of O
chemicals O
and O
advanced O
materials O
. O

The O
goal O
of O
the O
attackers B-Organization
appears O
to O
be O
to O
collect O
intellectual O
property O
such O
as O
design O
documents O
, O
formulas O
, O
and O
manufacturing O
processes O
. O

In O
addition O
, O
the O
same O
attackers B-Organization
appear O
to O
have O
a O
lengthy O
operation O
history O
including O
attacks O
on O
other O
industries O
and O
organizations O
. O

Attacks O
on O
the O
chemical O
industry O
are O
merely O
their O
latest O
attack O
wave O
. O

As O
part O
of O
our O
investigations O
, O
we O
were O
also O
able O
to O
identify O
and O
contact O
one O
of O
the O
attackers B-Organization
to O
try O
and O
gain O
insights O
into O
the O
motivations O
behind O
these O
attacks O
. O

As O
the O
pattern O
of O
chemical O
industry O
targets O
emerged O
, O
we O
internally O
code-named O
the O
attack O
campaign O
Nitro O
. O

The O
attack O
wave O
started O
in O
late O
July O
2011 O
and O
continued O
into O
midSeptember O
2011 O
. O

However O
, O
artifacts O
of O
the O
attack O
wave O
such O
as O
Command O
and O
Control O
( O
C&C O
) O
servers O
are O
also O
used O
as O
early O
as O
April O
2011 O
and O
against O
targets O
outside O
the O
chemical O
industry O
. O

The O
purpose O
of O
the O
attacks O
appears O
to O
be O
industrial O
espionage O
, O
collecting O
intellectual O
property O
for O
competitive O
advantage O
. O

The O
attackers B-Organization
first O
researched O
desired O
targets O
and O
then O
sent O
an O
email O
specifically O
to O
the O
target O
. O

Each O
organization O
typically O
only O
saw O
a O
handful O
of O
employees O
at O
the O
receiving O
end O
of O
these O
emails B-Vulnerability
. O

However O
, O
in O
one O
organization O
almost O
500 O
recipients O
received O
a O
mail O
, O
while O
in O
two O
other O
organizations O
, O
more O
than O
100 O
were O
selected O
. O

While O
the O
attackers B-Organization
used O
different O
pretexts O
when O
sending O
these O
malicious O
emails I-Vulnerability
, O
two O
methodologies O
stood O
out O
. O

First O
, O
when O
a O
specific O
recipient O
was O
targeted O
, O
the O
mails O
often O
purported O
to O
be O
meeting O
invitations O
from O
established O
business O
partners O
. O

Secondly O
, O
when O
the O
emails B-Vulnerability
were O
being O
sent O
to O
a O
broad O
set O
of O
recipients O
, O
the O
mails O
purported O
to O
be O
a O
necessary O
security O
update O
. O

The O
emails B-Vulnerability
then O
contained O
an O
attachment O
that O
was O
either O
an O
executable O
that O
appeared O
to O
be O
a O
text O
file O
based O
on O
the O
file O
name O
and O
icon O
, O
or O
a O
password-protected O
archive O
containing O
an O
executable O
file O
with O
the O
password O
provided O
in O
the O
email O
. O

In O
both O
cases O
, O
the O
executable O
file I-Malware
was O
a O
self-extracting B-System
executable O
containing O
PoisonIvy B-System
, O
a O
common O
backdoor O
Trojan I-System
developed O
by O
a O
Chinese O
speaker O
. O

When O
the O
recipient O
attempted O
to O
open O
the O
attachment O
, O
they O
would O
inadvertently O
execute O
the O
file O
, O
causing O
PoisonIvy O
to O
be O
installed O
. O

Once O
PoisonIvy O
was O
installed O
, O
it O
contacted O
a O
C&C O
server O
on O
TCP O
port O
80 O
using O
an O
encrypted O
communication O
protocol O
. O

Using O
the O
C&C O
server O
, O
the O
attackers O
then O
instructed O
the O
compromised O
computer O
to O
provide O
the O
infected O
computer O
’s O
IP O
address O
, O
the O
names O
of O
all O
other O
computers O
in O
the O
workgroup O
or O
domain O
, O
and O
dumps O
of O
Windows O
cached O
password O
hashes O
. O

By O
using O
access O
to O
additional O
computers O
through O
the O
currently O
logged O
on O
user O
or O
cracked O
passwords O
through O
dumped O
hashes O
, O
the O
attackers O
then O
began O
traversing O
the O
network O
infecting O
additional O
computers O
. O

Typically O
, O
their O
primary O
goal O
is O
to O
obtain O
domain O
administrator O
credentials O
and/or O
gain O
access O
to O
a O
system O
storing O
intellectual O
property O
. O

Domain O
administrator O
credentials O
make O
it O
easier O
for O
the O
attacker O
to O
find O
servers O
hosting O
the O
desired O
intellectual O
property O
and O
gain O
access O
to O
the O
sensitive O
materials O
. O

The O
attackers B-Organization
may O
have O
also O
downloaded O
and O
installed O
additional O
tools O
to O
penetrate O
the O
network O
further O
. O

While O
the O
behavior O
of O
the O
attackers B-Organization
differs O
slightly O
in O
each O
compromise O
, O
generally O
once O
the O
attackers B-Organization
have O
identified O
the O
desired O
intellectual O
property O
, O
they O
copy O
the O
content O
to O
archives O
on O
internal O
systems O
they O
use O
as O
internal O
staging O
servers O
. O

This O
content O
is O
then O
uploaded O
to O
a O
remote O
site O
outside O
of O
the O
compromised O
organization O
completing O
the O
attack O
. O

The O
majority O
of O
infected O
machines O
are O
located O
in O
the O
US O
, O
Bangladesh O
and O
the O
UK O
; O
however O
, O
overall O
there O
is O
wide O
geographical O
spread O
of O
infections O
. O

As O
mentioned O
above O
, O
the O
threat O
used O
to O
compromise O
the O
targeted O
networks O
is O
Poison B-System
Ivy I-System
, O
a O
Remote B-System
Access I-System
Tool I-System
( O
RAT B-System
) O
. O

This O
application O
is O
freely O
available O
from O
poisonivy-rat.com O
. O

It O
comes O
fully O
loaded O
with O
a O
number O
of O
plug-ins O
to O
give O
an O
attacker O
complete O
control O
of O
the O
compromised O
computer O
. O

The O
method O
of O
delivery O
has O
changed O
over O
time O
as O
the O
attackers B-Organization
have O
changed O
targets O
. O

Older O
attacks O
involved O
a O
self-extracting O
archive O
with O
a O
suggestive O
name O
, O
for O
example O
: O
“ O
Human O
right O
report O
of O
north O
Africa O
under O
the O
war O
. O

scr O
” O
. O

The O
most O
recent O
attacks O
focusing O
on O
the O
chemical O
industry O
are O
using O
password-protected O
7zip O
files O
which O
, O
when O
extracted O
, O
contain O
a O
self-extracting B-System
executable O
. O

The O
password O
to O
extract O
the O
7zip O
file O
is O
included O
in O
the O
email O
. O

This O
extra O
stage O
is O
used O
to O
prevent O
automated O
systems O
from O
extracting O
the O
self-extracting O
archive O
. O

Some O
example O
file O
names O
using O
this O
technique O
include O
: O
AntiVirus_update_package.7z O
, O
acquisition.7z O
, O
offer.7z O
, O
update_flashplayer10ax.7z O
. O

When O
the O
self-extracting O
archive O
file I-Malware
is O
executed O
, O
it O
will O
drop O
two O
files O
. O

Examples O
of O
file O
names O
that O
are O
used O
include O
: O
%Temp%\happiness.txt O
, O
%Temp%\xxxx.exe O
. O

The O
executable O
file O
, O
xxxx.exe O
in O
this O
case O
, O
is O
then O
executed O
. O

The O
second O
file O
, O
happiness.txt O
, O
contains O
custom O
code O
in O
binary O
format O
that O
is O
encrypted O
and O
used O
by O
xxxx.exe O
. O

The O
xxxx.exe O
file O
copies O
happiness.txt O
to O
C:\PROGRAM O
FILES\common O
files\ODBC\ODUBC.DLL O
and O
to O
C:\WINDOWS\system32\jql.sys O
. O

It O
then O
loads O
the O
contents O
of O
the O
encrypted O
file O
and O
injects O
it O
into O
the O
explorer.exe O
and O
iexplore.exe O
processes O
. O

The O
injected O
code O
copies O
xxxx.exe O
to O
%System%\winsys.exe O
and O
connects O
to O
the O
Command O
and O
Control O
( O
C&C O
) O
server O
on O
TCP O
port O
80 O
. O

The O
communication O
with O
the O
server O
is O
a O
handshake O
using O
an O
encryption O
algorithm O
( O
Camellia O
) O
. O

Once O
the O
Trojan O
establishes O
the O
server O
’s O
authenticity O
, O
it O
expects O
a O
variable-size O
block O
of O
binary O
code O
that O
is O
read O
from O
the O
server O
straight O
into O
the O
virtual O
space O
for O
iexplore.exe O
and O
then O
executed O
. O

When O
executed O
, O
the O
Poison B-System
Ivy I-System
threat O
, O
or O
Backdoor.Odivy O
, O
connects O
to O
a O
command O
and O
control O
( O
C&C O
) O
server O
over O
TCP O
port O
80 O
. O

A O
number O
of O
different O
C&C O
domains O
and O
IP O
addresses O
were O
identified O
. O

The O
majority O
of O
samples O
connect O
to O
a O
domain O
; O
however O
one O
subset O
of O
samples O
connected O
directly O
to O
the O
IP O
address O
204.74.215.58 O
, O
which O
belonged O
to O
the O
Chinese O
QQ O
user O
mentioned O
previously O
and O
was O
also O
associated O
with O
antivirus-groups.com O
. O

pr[REMOVED].noIP O
. O

org O
: O
173.252.207.71 O
, O
173.252.205.36 O
, O
173.252.205.37 O
, O
173.252.205.64 O
. O

antivirus-groups.com O
: O
74.82.166.205 O
, O
204.74.215.58 O
. O

domain.rm6.org O
: O
216.131.95.22 O
, O
222.255.28.27 O
. O

anti-virus.sytes.net O
: O
173.252.205.36 O
, O
173.252.205.37 O
, O
173.252.205.64 O
. O

Several O
other O
hacker B-Organization
groups I-Organization
have O
also O
begun O
targeting O
some O
of O
the O
same O
chemical B-Organization
companies I-Organization
in O
this O
time O
period O
. O

Attackers B-Organization
are O
sending O
malicious O
PDF O
and O
DOC O
files I-Malware
, O
which O
use O
exploits O
to O
drop O
variants O
of O
Backdoor.Sogu O
. O

This O
particular O
threat O
was O
also O
used O
by O
hackers O
to O
compromise O
a O
Korean O
social O
network O
site O
to O
steal O
records O
of O
35 O
million O
users O
. O

Determining O
if O
the O
two O
groups O
are O
related O
is O
difficult O
, O
but O
any O
relationship O
appears O
unlikely O
. O

The O
attackers B-Organization
described O
in O
this O
document O
use O
a O
very O
basic O
delivery O
platform O
; O
compressed O
self-extracting B-System
archives O
sometimes O
sent O
to O
a O
large O
number O
of O
recipients O
. O

The O
Sogu O
gang I-Organization
, O
in O
contrast O
, O
use O
PDF B-System
and O
DOC O
files I-System
in O
very O
tailored O
, O
targeted O
emails B-Vulnerability
. O

The O
Sogu O
gang I-Organization
use O
a O
custom O
developed O
threat O
– O
Backdoor.Sogu O
, O
whereas O
the O
group O
described O
in O
this O
document O
use O
an O
off O
the O
shelf O
threat O
– O
Poison B-System
Ivy I-System
. O

While O
the O
number O
of O
Sogu O
targets O
is O
currently O
small O
relative O
to O
the O
Poison B-System
Ivy O
attacks O
, O
we O
continue O
to O
monitor O
their O
activities O
. O

Numerous O
targeted O
attack O
campaigns O
are O
occurring O
every O
week O
. O

However O
, O
relative O
to O
the O
total O
number O
of O
attacks O
, O
few O
are O
fully O
disclosed O
. O

These O
attacks O
are O
primarily O
targeting O
private O
industry O
in O
search O
of O
key O
intellectual O
property O
for O
competitive O
advantage O
, O
military B-Organization
institutions I-Organization
, O
and O
governmental B-Organization
organizations I-Organization
often O
in O
search O
of O
documents O
related O
to O
current O
political O
events O
and O
human O
rights O
organizations O
. O

This O
attack O
campaign O
focused O
on O
the O
chemical B-Organization
sector I-Organization
with O
the O
goal O
of O
obtaining O
sensitive O
documents O
such O
as O
proprietary O
designs O
, O
formulas O
, O
and O
manufacturing O
processes O
. O

Outlaw B-Organization
Updates O
Kit B-Organization
to O
Kill O
Older O
Miner O
Versions O
, O
Targets O
More O
Systems O
. O

As O
we O
’ve O
observed O
with O
cybercriminal O
groups I-Organization
that O
aim O
to O
maximize O
profits O
for O
every O
campaign O
, O
silence O
doesn’t O
necessarily O
mean O
inactivity O
. O

It O
appears O
hacking B-Organization
group O
Outlaw B-Organization
, O
which O
has O
been O
silent O
for O
the O
past O
few O
months O
, O
was O
simply O
developing O
their O
toolkit O
for O
illicit O
income O
sources O
. O

While O
they O
have O
been O
quiet O
since O
our O
June O
analysis O
, O
we O
observed O
an O
increase O
in O
the O
group B-Organization
’s O
activities O
in O
December O
, O
with O
updates O
on O
the O
kits O
’ O
capabilities O
reminiscent O
of O
their O
previous O
attacks O
. O

The O
updates O
expanded O
scanner O
parameters O
and O
targets O
, O
looped O
execution O
of O
files O
via O
error O
messages O
, O
improved O
evasion O
techniques O
for O
scanning O
activities O
, O
and O
improved O
mining O
profits O
by O
killing O
off O
both O
the O
competition O
and O
their O
own O
previous O
miners O
. O

We O
analyzed O
the O
kits O
, O
which O
were O
designed O
to O
steal O
information O
from O
the O
automotive O
and O
finance O
industries O
, O
launch O
subsequent O
attacks O
on O
already O
compromised O
systems O
, O
and O
( O
possibly O
) O
sell O
stolen O
information O
. O

Comparing O
this O
development O
to O
their O
previous O
attacks O
, O
we O
think O
Outlaw B-Organization
may O
be O
aiming O
to O
go O
after O
enterprises O
that O
have O
yet O
to O
update O
their O
systems O
, O
assessing O
security O
and O
changes O
with O
their O
previously O
infected O
hosts O
, O
finding O
new O
and O
old O
targets O
, O
and O
possibly O
testing O
their O
updates O
in O
the O
wild O
. O

We O
will O
continue O
to O
observe O
the O
group B-Organization
’s O
activities O
as O
they O
target O
industries O
from O
the O
United O
States O
and O
Europe O
. O

Based O
on O
the O
samples O
we O
collected O
and O
traced O
to O
456 O
distinct O
IPs O
, O
we O
expect O
the O
group O
to O
be O
more O
active O
in O
the O
coming O
months O
as O
we O
observed O
changes O
on O
the O
versions O
we O
acquired O
. O

These O
new O
samples O
targeted O
Linux- O
and O
Unix-based O
operating O
systems O
, O
vulnerable O
servers O
, O
and O
internet O
of O
things O
( O
IoT O
) O
devices O
by O
exploiting O
known O
vulnerabilities O
with O
available B-Vulnerability
exploits I-Vulnerability
. O

This O
time O
, O
the O
group O
explored O
unpatched O
systems O
vulnerable O
to O
CVE-2016-8655 O
and O
Dirty O
COW O
exploit O
( O
CVE-2016-5195 O
) O
as O
attack O
vectors O
. O

Files O
using O
simple O
PHP-based O
web B-System
shells I-System
were O
also O
used O
to O
attack O
systems O
with O
weak O
SSH O
and O
Telnet O
credentials O
. O

While O
no O
phishing- O
or O
social O
engineering-initiated O
routines O
were O
observed O
in O
this O
campaign O
, O
we O
found O
multiple O
attacks O
over O
the O
network O
that O
are O
considered O
“ O
loud. O
” O
These O
involved O
large-scale O
scanning O
operations O
of O
IP O
ranges O
intentionally O
launched O
from O
the O
command O
and O
control O
( O
C&C O
) O
server O
. O

The O
honeynet O
graphs O
, O
which O
show O
activity O
peaks O
associated O
with O
specific O
actions O
, O
also O
suggest O
that O
the O
scans O
were O
timed O
. O

From O
the O
sample O
we O
analyzed O
, O
attacks O
started O
from O
one O
virtual O
private O
server O
( O
VPS O
) O
that O
searches O
for O
a O
vulnerable O
machine O
to O
compromise O
( O
previous O
techniques O
used O
malicious O
URLs O
or O
infecting O
legitimate O
websites O
for O
bot O
propagation O
) O
. O

Once O
infected O
, O
the O
C&C O
commands O
for O
the O
infected O
system O
launches O
a O
loud O
scanning O
activity O
and O
spreads O
the O
botnet O
by O
sending O
a O
“ O
whole O
kit O
” O
of O
binary O
files O
at O
once O
with O
naming O
conventions O
same O
as O
the O
ones O
already O
in O
the O
targeted O
host O
, O
likely O
banking O
on O
breaking O
through O
via O
“ O
security O
through O
obscurity. O
” O
They O
attempted O
to O
evade O
traffic O
inspection O
by O
encoding O
the O
code O
for O
the O
scanner O
with O
base-64 O
. O

The O
zombie O
host O
initiates O
the O
scan O
— O
another O
routine O
from O
previous O
campaigns O
— O
but O
updated O
with O
a O
larger O
set O
of O
parameters O
and O
programmed O
to O
run O
in O
the O
background O
. O

The O
kit O
we O
found O
is O
in O
tgz O
format O
, O
though O
we O
have O
observed O
some O
samples O
disguised O
as O
png O
or O
jpg O
. O

While O
previous O
routines O
took O
advantage O
of O
competing O
miners O
’ O
activities O
and O
unrelated O
components O
to O
hijack O
the O
profit O
, O
the O
latest O
version O
of O
the O
code O
attempts O
to O
remove O
all O
related O
files O
and O
codes O
from O
previous O
infections O
( O
including O
their O
own O
to O
make O
sure O
the O
running O
components O
are O
updated O
, O
as O
well O
as O
those O
from O
other O
cybercriminals O
to O
maximize O
the O
resources O
of O
the O
zombie O
host O
) O
and O
creates O
a O
new O
working O
directory O
/tmp/.X19-unix O
to O
move O
the O
kit O
and O
extract O
the O
files O
. O

The O
tsm O
binary O
then O
runs O
in O
the O
background O
, O
forwarding O
a O
series O
of O
error O
messages O
to O
/dev/null O
to O
keep O
the O
code O
running O
, O
ensuring O
the O
continuous O
execution O
of O
the O
code O
referenced O
with O
a O
set O
of O
parameters O
/tmp/up.txt O
. O

The O
script O
then O
waits O
20 O
minutes O
before O
it O
runs O
the O
wrapper O
script O
initall O
: O
2e2c9d08c7c955f6ce5e27e70b0ec78a888c276d71a72daa0ef9e3e40f019a1a O
initall O
. O

Another O
variant O
executes O
a O
set O
of O
commands O
once O
a O
system O
is O
successfully O
compromised O
. O

Most O
of O
these O
commands O
are O
related O
to O
gathering O
information O
from O
the O
infected O
machine O
( O
number O
of O
CPU O
cores O
, O
users O
, O
scheduled O
tasks O
, O
running O
processes O
, O
OS O
installed O
, O
and O
CPU O
and O
memory O
information O
) O
via O
the O
dota3 O
payload O
, O
as O
well O
as O
changing O
the O
password O
to O
a O
random O
string O
also O
stored O
in O
/tmp/up.txt O
. O

In O
a O
previous O
execution O
( O
published O
in O
June O
2019 O
) O
, O
we O
observed O
that O
dota2 B-Organization
had O
its O
own O
folder O
but O
it O
was O
hardly O
executed O
. O

Running O
the O
script O
removes O
the O
remaining O
files O
and O
scripts O
from O
previous O
attacks O
, O
keeping O
a O
low O
profile O
to O
evade O
detection O
. O

If O
the O
system O
has O
been O
previously O
infected O
with O
a O
cryptominer O
, O
it O
also O
attempts O
to O
kill O
the O
running O
miner O
and O
all O
its O
related O
activities O
. O

Based O
on O
a O
bashtemp O
directory O
of O
the O
latest O
sample O
we O
found O
, O
there O
are O
other O
compiled O
ELF O
scripts O
, O
named O
init O
and O
init2 B-Malware
, O
that O
loops O
the O
kit O
to O
keep O
running O
: O
0c458dfe0a2a01ab300c857fdc3373b75fbb8ccfa23d16eff0d6ab888a1a28f6 O
init O
. O

93ce211a71867017723cd78969aa4cac9d21c3d8f72c96ee3e1b2712c0eea494 O
init2 O
. O

Both O
init O
and O
init2 B-Malware
scripts O
make O
sure O
all O
other O
running O
mining O
services O
are O
killed O
, O
and O
that O
all O
the O
files O
in O
the O
working O
directory O
are O
executed O
by O
giving O
777 O
permissions O
. O

We O
also O
found O
the O
init0 O
script O
running O
; O
the O
script O
cleans O
out O
all O
miners O
regardless O
of O
its O
origin O
. O

It O
then O
resets O
cron O
and O
removes O
possible O
cache O
files O
from O
other O
programs O
, O
starts O
scripts O
and O
binaries O
a O
, O
init0 O
, O
and O
start O
, O
and O
sets O
the O
persistence O
by O
modifying O
the O
crontab O
. O

The O
a O
binary B-Malware
is O
a O
script O
wrapper O
to O
start O
run O
, O
a O
Perl-obfuscated O
script O
for O
installation O
of O
a O
Shellbot O
to O
gain O
control O
of O
the O
infected O
system O
. O

The O
Shellbot O
disguises O
itself O
as O
a O
process O
named O
rsync O
, O
commonly O
the O
binary O
seen O
on O
many O
Unix- O
and O
Linux-based O
systems O
to O
automatically O
run O
for O
backup O
and O
synchronization O
. O

This O
allows O
the O
malicious O
activity O
to O
evade O
detection O
. O

The O
Shellbot B-Malware
script I-Malware
is O
added O
to O
run O
after O
the O
victim O
’s O
system O
reboots O
, O
and O
scripts O
/a/upd O
, O
/b/sync/ O
, O
and O
/c/aptitude/ O
are O
added O
to O
the O
crontab O
. O

However O
, O
while O
we O
observed O
the O
presence O
of O
the O
codes O
, O
the O
functions O
of O
upd O
, O
sync O
and O
aptitude O
were O
disabled O
in O
the O
kits O
’ O
latest O
version O
. O

It O
remains O
unclear O
whether O
these O
are O
leftover O
code O
from O
the O
previous O
versions O
or O
their O
particular O
purposes O
were O
served O
. O

Shellbot B-Organization
is O
also O
used O
to O
control O
the O
botnet O
, O
with O
a O
command O
that O
is O
sent O
and O
run O
from O
the O
C&C O
to O
determine O
if O
there O
is O
a O
code O
execution O
in O
the O
shell O
, O
the O
hostname O
, O
and O
its O
architecture O
. O

All O
results O
and O
system O
information O
collected O
from O
the O
infected O
system O
are O
stored O
locally O
in O
the O
device O
for O
a O
period O
before O
Outlaw B-Organization
retrieves O
them O
via O
the O
C&C O
. O

Since O
discovering O
the O
operations O
of O
this O
group O
in O
2018 O
, O
Outlaw B-Organization
continues O
to O
use O
scripts O
, O
codes O
, O
and O
commands O
that O
have O
been O
previously O
used O
and O
deployed O
. O

These O
routines O
are O
indicative O
of O
the O
group B-Organization
’s O
aim O
to O
get O
quantitative O
returns O
through O
varied O
cybercriminal O
profit O
streams O
. O

This O
was O
also O
reinforced O
by O
their O
naming O
conventions O
, O
wherein O
different O
versions O
are O
simply O
named O
after O
the O
code O
iterations O
, O
following O
a O
specific O
format O
regardless O
of O
the O
actual O
function O
of O
the O
code O
. O

Trojan.SH.MALXMR.UWEJP B-Organization
: O
1800de5f0fb7c5ef3c0d9787260ed61bc324d861bc92d9673d4737d1421972aa O
. O

Backdoor.SH.SHELLBOT.AA O
: O
b68bd3a54622792200b931ee5eebf860acf8b24f4b338b5080193573a81c747d O
. O

Trojan.Linux.SSHBRUTE.B B-Organization
: O
620635aa9685249c87ead1bb0ad25b096714a0073cfd38a615c5eb63c3761976 O
. O

Coinminer.Linux.MALXMR.SMDSL32 O
: O
fc57bd66c27066104cd6f8962cd463a5dfc05fa59b76b6958cddd3542dfe6a9a B-Malware
. O

Coinminer.Linux.MALXMR.SMDSL64 B-Organization
: O
649280bd4c5168009c1cff30e5e1628bcf300122b49d339e3ea3f3b6ff8f9a79 O
. O

Actors O
Still O
Exploiting O
SharePoint O
Vulnerability B-Vulnerability
to O
Attack O
Middle O
East O
Government O
Organizations O
. O

On O
September O
10 O
, O
2019 O
, O
we O
observed O
unknown O
threat B-Organization
actors O
exploiting O
a O
vulnerability O
in O
SharePoint O
described O
in O
CVE-2019-0604 O
to O
install O
several O
webshells O
on O
the O
website O
of O
a O
Middle O
East O
government B-Organization
organization I-Organization
. O

One O
of O
these O
webshells O
is O
the O
open O
source O
AntSword O
webshell O
freely O
available O
on O
Github O
, O
which O
is O
remarkably O
similar O
to O
the O
infamous O
China O
Chopper I-Malware
webshell O
. O

On O
January O
10 O
, O
2020 O
, O
we O
used O
Shodan O
to O
search O
for O
Internet O
accessible O
servers O
running O
versions O
of O
SharePoint O
vulnerable O
to O
CVE-2019-0604 O
. O

While O
admittedly O
the O
version O
numbers O
provided O
by O
SharePoint O
within O
HTTP O
responses O
do O
not O
always O
provide O
the O
precise O
SharePoint O
version O
number O
, O
we O
decided O
to O
use O
it O
to O
check O
if O
it O
was O
less O
than O
the O
version O
numbers O
of O
the O
patched O
SharePoint O
versions O
from O
the O
Microsoft O
advisory O
. O

We O
performed O
this O
comparison O
and O
found O
28,881 O
servers O
that O
advertised O
a O
vulnerable O
version O
of O
SharePoint O
. O

We O
did O
not O
actively O
check O
each O
server O
to O
verify O
if O
they O
were O
indeed O
vulnerable O
, O
so O
it O
is O
possible O
that O
many O
of O
these O
public-facing O
SharePoint O
servers O
were O
not O
vulnerable O
or O
since O
patched O
. O

Regardless O
, O
the O
sheer O
number O
of O
servers O
and O
publicly O
available O
exploit O
code O
suggests O
that O
CVE-2019-0604 O
is O
still O
a O
major O
attack O
vector O
. O

Using O
this O
collection O
of O
webshells O
, O
the O
actors B-Organization
moved O
laterally O
to O
other O
systems O
on O
the O
network O
by O
dumping O
credentials O
with O
a O
variant O
of O
the O
notorious O
Mimikatz B-System
tool O
and O
using O
Impacket B-System
’s I-System
atexec I-System
tool O
to O
use O
dumped O
credentials O
to O
run O
commands O
on O
other O
systems O
. O

On O
September O
19 O
, O
2019 O
, O
we O
observed O
the O
same O
exact O
Mimikatz O
variant O
uploaded O
to O
a O
webshell O
hosted O
at O
another O
government B-Organization
organization I-Organization
in O
a O
second O
country O
in O
the O
Middle O
East O
. O

The O
Mimikatz B-System
variant O
uploaded O
to O
these O
two O
organizations O
is O
unique O
, O
as O
it O
involves O
a O
seemingly O
custom O
loader O
application O
written O
in O
.NET O
. O

Therefore O
, O
we O
believe O
that O
the O
same O
threat B-Organization
group I-Organization
is O
behind O
both O
intrusions O
. O

Back O
in O
April O
2019 O
, O
we O
first O
observed O
the O
Emissary B-Organization
Panda I-Organization
threat O
group I-Organization
exploiting O
CVE-2019-0604 O
to O
install O
webshells O
on O
SharePoint O
servers O
at O
government B-Organization
organizations I-Organization
in O
two O
Middle O
Eastern O
countries O
. O

Fast O
forward O
five O
months O
to O
the O
current O
attacks O
and O
we O
see O
exploitation O
of O
the O
same O
vulnerability O
at O
government B-Organization
organizations I-Organization
in O
two O
different O
countries O
compared O
to O
the O
April O
attacks O
. O

We O
do O
not O
have O
any O
strong O
ties O
to O
connect O
the O
current O
attacks O
exploiting O
this O
vulnerability O
in O
SharePoint O
with O
the O
Emissary B-Organization
Panda O
attacks O
carried O
out O
in O
April O
. O

The O
overlaps O
between O
these O
two O
sets O
of O
attacks O
include O
exploitation O
of O
a O
common O
vulnerability O
, O
similar O
toolset O
and O
a O
shared O
government O
victimology O
, O
but O
no O
strong O
pivot O
points O
to O
connect O
these O
attack O
campaigns O
together O
. O

The O
exploitation O
of O
this O
vulnerability O
is O
not O
unique O
to O
Emissary B-Organization
Panda I-Organization
, O
as O
multiple O
threat B-Organization
groups I-Organization
are O
using O
this O
vulnerability O
to O
exploit O
SharePoint O
servers O
to O
gain O
initial O
access O
to O
targeted O
networks O
. O

We O
would O
like O
to O
acknowledge O
the O
possibility O
of O
an O
overlap O
in O
the O
AntSword O
webshell O
, O
as O
we O
stated O
that O
Emissary B-Organization
Panda I-Organization
used O
China B-System
Chopper I-System
in O
the O
April O
attacks O
and O
AntSword O
and O
China O
Chopper I-Malware
webshells O
are O
incredibly O
similar O
. O

However O
, O
at O
this O
time O
we O
do O
not O
believe O
the O
April O
attacks O
used O
AntSword O
based O
on O
artifacts O
analyzed O
on O
the O
SharePoint O
server O
, O
specifically O
none O
of O
the O
IIS O
logs O
in O
the O
April O
attacks O
used O
the O
AntSword O
User-Agent O
in O
requests O
to O
the O
webshell O
that O
were O
observed O
in O
the O
current O
attacks O
. O

Palo B-Organization
Alto I-Organization
Networks I-Organization
customers I-Organization
are O
protected O
from O
the O
threat O
described O
in O
this O
blog O
through O
Threat O
Prevention O
signatures O
for O
the O
exploits O
and O
C2 O
traffic O
as O
well O
as O
through O
WildFire B-Organization
. O

More O
details O
on O
this O
protection O
is O
available O
in O
the O
conclusion O
of O
the O
report O
. O

On O
September O
10 O
, O
2019 O
, O
we O
observed O
an O
HTTP O
POST O
request O
to O
the O
following O
URL O
that O
we O
believe O
was O
the O
exploitation O
of O
CVE-2019-0604 O
in O
a O
publicly O
facing O
SharePoint O
server O
( O
T1190 O
) O
: O
/_layouts/15/picker.aspx O
. O

The O
command O
uses O
the O
echo O
command I-System
to O
write O
a O
large O
chunk O
of O
base64 O
encoded O
data O
to O
a O
text O
file O
named O
cmd.txt O
. O

The O
command O
then O
uses O
the O
certutil O
application O
to O
convert O
the O
base64 O
encoded O
data O
( O
T1132 O
) O
in O
the O
cmd.txt O
file O
to O
c.aspx O
in O
three O
different O
SharePoint O
related O
folders O
. O

The O
result O
of O
this O
entire O
command O
saves O
a O
variant O
of O
the O
Awen O
asp.net O
webshell O
( O
T1100 O
) O
to O
the O
SharePoint O
server O
to O
further O
interact O
with O
the O
compromise O
server O
. O

The O
Awen O
webshell O
deployed O
in O
the O
exploitation O
of O
this O
SharePoint O
vulnerability O
had O
a O
SHA256 O
hash O
of O
5d4628d4dd89f31236f8c56686925cbb1a9b4832f81c95a4300e64948afede21 O
. O

Just O
40 O
seconds O
after O
the O
suspected O
exploitation O
of O
CVE-2019-0604 O
, O
we O
observed O
the O
first O
HTTP O
GET O
request O
to O
a O
webshell O
at O
c.aspx O
, O
which O
is O
a O
modified O
version O
of O
the O
freely O
available O
awen O
asp.net O
webshell O
. O

We O
believe O
this O
HTTP O
GET O
request O
was O
the O
actor O
visiting O
the O
webshell O
after O
exploitation O
and O
prior O
to O
executing O
commands O
. O

The O
actor B-Organization
uses O
the O
Awen O
webshell O
to O
run O
various O
commands O
to O
do O
an O
initial O
discovery O
on O
the O
system O
and O
network O
, O
including O
user O
accounts O
( O
T1033 O
and O
T1087 O
) O
, O
files O
and O
folders O
( O
T1083 O
) O
, O
privileged O
groups O
( O
T1069 O
) O
, O
remote O
systems O
( O
T1018 O
) O
and O
network O
configuration O
( O
T1016 O
) O
. O

Table O
1 O
not O
only O
shows O
the O
commands O
used O
for O
discovery O
, O
but O
also O
the O
commands O
used O
to O
deploy O
another O
webshell O
to O
the O
server O
using O
the O
echo O
command O
to O
write O
base64 O
encoded O
data O
to O
a.txt O
and O
using O
the O
certutil O
application O
to O
decode O
and O
save O
to O
bitreeview.aspx O
. O

The O
webshell O
named O
bitreeview.aspx O
was O
saved O
to O
a O
folder O
within O
the O
SharePoint O
server O
’s O
install O
path O
. O

The O
bitreeview.aspx O
file O
is O
a O
variant O
of O
the O
AntSword O
webshell O
that O
has O
undeniably O
similar O
traits O
as O
the O
infamous O
China O
Chopper I-Malware
webshell O
. O

After O
installing O
this O
AntSword O
webshell O
, O
the O
actor O
no O
longer O
uses O
the O
Awen O
webshell O
and O
issues O
the O
first O
command O
to O
AntSword O
35 O
seconds O
after O
the O
last O
command O
issued O
to O
the O
Awen O
webshell O
. O

AntSword O
is O
a O
modular O
webshell O
that O
involves O
a O
very O
simple O
webshell O
that O
the O
actor O
would O
deploy O
to O
the O
compromised O
server O
and O
a O
client O
application O
referred O
to O
as O
the O
AntSword O
Shell O
Manager O
. O

The O
use O
of O
the O
client O
application O
differs O
from O
many O
other O
webshells O
that O
the O
actor O
would O
interact O
with O
in O
a O
browser O
window O
. O

The O
actor B-Organization
would O
use O
the O
AntSword O
Shell I-System
Manager I-System
to O
interact O
with O
the O
AntSword O
webshell O
on O
the O
compromised O
server O
, O
as O
the O
Shell B-System
Manager I-System
sends O
the O
appropriate O
script O
to O
the O
webshell O
that O
will O
execute O
to O
carry O
out O
the O
desired O
action O
. O

To O
provide O
a O
sense O
of O
the O
limited O
functionality O
within O
the O
webshell O
itself O
, O
the O
bitreeview.aspx O
AntSword O
webshell O
deployed O
in O
this O
attack O
( O
SHA256: O
15ecb6ac6c637b58b2114e6b21b5b18b0c9f5341ee74b428b70e17e64b7da55e O
) O
was O
only O
162 O
bytes O
. O

AntSword O
webshell O
has O
no O
functionality O
other O
than O
running O
a O
script O
provided O
by O
the O
AntSword O
Shell O
Manager O
, O
specifically O
within O
a O
field O
named O
Darr1R1ng O
of O
an O
HTTP O
POST O
request O
. O

The O
code O
above O
also O
tells O
us O
the O
actors B-Organization
had O
created O
their O
own O
custom O
“ O
encoder O
” O
within O
the O
AntSword O
Shell O
Manager O
to O
be O
able O
to O
interact O
with O
the O
code O
above O
, O
which O
we O
will O
discuss O
in O
detail O
in O
the O
next O
section O
. O

In O
addition O
to O
the O
Mimikatz B-System
tool I-System
, O
the O
actor O
uploaded O
other O
tools O
to O
the O
webshell O
hosted O
at O
this O
second O
organization O
. O

es.exe O
: O
Mimikatz B-System
with O
custom O
loader O
, O
da53dcaeede03413ba02802c4be10883c4c28d3d28dee11734f048b90eb3d304 O
. O

Rar.exe O
: O
Legitimate O
WinRAR O
, O
26d9212ec8dbca45383eb95ec53c05357851bd7529fa0761d649f62e90c4e9fd O
. O

atec.exe O
: O
Compiled O
Impacket O
atexec O
tool O
, O
a4aca75bcc8f18b8a2316fd67a7e545c59b871d32de0b325f56d22584038fa10 O
. O

dmp.exe O
: O
Dumpert O
tool O
, O
e4e05c9a216c2f2b3925293503b5d5a892c33db2f6ea58753f032b80608c3f2e O
. O

One O
of O
the O
tools O
seen O
above O
that O
caught O
our O
interest O
was O
the O
Dumpert O
tool O
, O
which O
is O
freely O
available O
on O
Outflanknl O
’s O
GitHub O
repository O
. O

The O
author O
of O
Dumpert O
describes O
the O
tool O
as O
an O
LSASS O
dumping O
tool O
that O
uses O
direct O
system O
calls O
and O
API O
unhooking O
to O
evade O
antivirus O
and O
EDR O
solutions O
. O

Dumpert O
is O
a O
relatively O
new O
tool O
with O
its O
initial O
commit O
to O
GitHub O
occurring O
on O
June O
17 O
, O
2019 O
. O

While O
the O
Dumpert O
tool O
is O
meant O
to O
help O
red O
teams O
emulate O
an O
adversary O
, O
we O
had O
not O
seen O
this O
tool O
used O
by O
threat B-Organization
actors O
until O
it O
was O
uploaded O
to O
this O
related O
webshell O
on O
September O
23 O
, O
2019 O
. O

Threat O
actors O
continue O
to O
exploit O
the O
CVE-2019-0604 B-Vulnerability
vulnerability I-Vulnerability
to O
compromise O
SharePoint O
servers O
, O
which O
is O
a O
vulnerability O
that O
Microsoft O
released O
a O
patch O
for O
in O
March O
2019 O
. O

We O
observed O
actors O
installing O
webshells O
to O
the O
SharePoint O
server O
that O
they O
use O
to O
run O
commands O
and O
upload O
additional O
tools O
to O
in O
order O
to O
dump O
credentials O
and O
move O
laterally O
to O
other O
systems O
on O
the O
network O
. O

We O
were O
also O
able O
to O
find O
a O
related O
webshell O
based O
on O
the O
threat B-Organization
group O
’s O
tool O
reuse O
, O
specifically O
a O
custom O
Mimikatz I-System
sample I-System
. O

Thanks O
to O
this O
tool O
reuse O
, O
we O
found O
the O
threat B-Organization
group O
uploading O
a O
credential O
dumping O
tool O
called O
Dumpert O
that O
we O
had O
not O
seen O
used O
in O
prior O
incidents O
involving O
the O
exploitation O
of O
CVE-2019-0604 O
. O

Digital O
Attack O
on O
German O
Parliament: O
Investigative O
Report O
on O
the O
Hack O
of O
the O
Left O
Party O
Infrastructure O
in O
Bundestag O
. O

Two O
suspicious O
artifacts O
have O
been O
retrieved O
from O
two O
separate O
servers O
within O
the O
Die O
Linke O
infrastructure O
. O

One O
is O
an O
open O
source O
utility O
used O
to O
remotely O
issue O
commands O
on O
a O
Windows O
host O
from O
a O
Linux O
host O
. O

The O
other O
is O
a O
custom O
utility O
which O
, O
despite O
its O
large O
size O
, O
has O
limited O
functionality O
and O
acts O
as O
a O
tunnel O
, O
possibly O
used O
by O
the O
attackers B-Organization
to O
maintain O
persistence O
within O
the O
compromised O
network O
. O

Attributes O
of O
one O
of O
the O
artifacts O
and O
intelligence O
gathered O
on O
the O
infrastructure O
operated O
by O
the O
attackers B-Organization
suggest O
that O
the O
attack O
was O
perpetrated O
by O
a O
state-sponsored O
group O
known O
as O
Sofacy B-Organization
( O
or O
APT28 B-Organization
) O
. O

Previous O
work O
published O
by O
security O
vendor O
FireEye B-Organization
in O
October O
2014 O
suggests O
the O
group O
might O
be O
of O
Russian O
origin O
. O

The O
first O
artifact O
– O
identified O
across O
this O
report O
as O
Artifact O
#1 O
– O
has O
the O
following O
attributes O
: O
Name O
winexesvc.exe O
Size O
23552 O
MD5 O
77e7fb6b56c3ece4ef4e93b6dc608be0 O
SHA1 O
f46f84e53263a33e266aae520cb2c1bd0a73354e O
SHA256 O
5130f600cd9a9cdc82d4bad938b20cbd2f699aadb76e7f3f1a93602330d9997d O
. O

The O
second O
artifact O
– O
identified O
across O
this O
report O
as O
Artifact O
#2 O
– O
-has O
the O
following O
attributes O
: O
Name O
svchost.exe O
Size O
1062912 O
MD5 O
5e70a5c47c6b59dae7faf0f2d62b28b3 O
SHA1 O
cdeea936331fcdd8158c876e9d23539f8976c305 O
SHA256 O
730a0e3daf0b54f065bdd2ca427fbe10e8d4e28646a5dc40cbcfb15e1702ed9a O
Compile O
Time O
2015-04-22 O
10:49:54 O
. O

Artifact O
#1 O
was O
retrieved O
from O
a O
File O
Server O
operated O
by O
Die O
Linke O
. O

The O
file O
is O
a O
64bit-compatible O
compiled O
binary O
of O
the O
open O
source O
utility O
Winexe O
. O

Winexe O
is O
software O
similar O
to O
the O
more O
popular O
PSExec O
and O
is O
designed O
to O
allow O
system O
administrators O
to O
execute O
commands O
on O
remote O
servers O
. O

While O
commercial O
solutions O
like O
Symantec B-Organization
pcAnywhere O
provide O
a O
larger O
feature-set O
, O
Winexe O
is O
lightweight O
, O
and O
doesn’t O
require O
any O
installation O
or O
configuration O
. O

One O
of O
the O
reasons O
Winexe O
is O
preferred O
over O
PSExec O
, O
is O
that O
it O
provides O
a O
Linux O
client O
, O
while O
PSExec O
doesn’t O
. O

Attackers B-Organization
are O
making O
growing O
use O
of O
utilities O
like O
Winexe O
and O
PSExec B-System
to O
perform O
lateral O
movement O
across O
compromised O
networks O
. O

Besides O
providing O
the O
ability O
to O
execute O
arbitrary O
commands O
on O
the O
target O
system O
, O
these O
utilities O
normally O
don’t O
raise O
suspicion O
as O
they O
are O
commonly O
whitelisted O
by O
Antivirus B-Organization
and O
other O
commercial O
security O
software O
. O

Winexe O
acts O
as O
a O
Windows O
service O
that O
can O
be O
configured O
to O
automatically O
start O
at O
boot O
and O
silently O
wait O
for O
incoming O
commands O
over O
a O
named O
pipe O
. O

Named O
pipes O
are O
a O
Windows O
inter-process O
communication O
method O
. O

Through O
named O
pipes O
, O
processes O
are O
able O
to O
communicate O
and O
exchange O
data O
even O
over O
a O
network O
. O

In O
the O
case O
of O
Artifact O
#1 O
, O
the O
name O
of O
the O
pipe O
is O
ahexec O
, O
computers O
over O
the O
network O
could O
access O
the O
pipe O
server O
by O
simply O
opening O
a O
file O
handle O
on O
\ServerNamepipeahexec O
. O

Once O
connected O
to O
the O
pipe O
, O
a O
user O
or O
a O
program O
can O
easily O
provide O
information O
required O
to O
execute O
command O
( O
just O
as O
they O
would O
normally O
through O
a O
command-line O
) O
. O

The O
provided O
information O
is O
then O
passed O
to O
a O
CreateProcessAsUserA O
call O
and O
the O
specified O
command O
is O
executed O
. O

Once O
inside O
the O
network O
, O
Artifact O
#1 O
can O
be O
enough O
for O
the O
attacker O
to O
download O
or O
create O
additional O
scripts O
, O
execute O
commands O
and O
exfiltrate O
data O
( O
for O
example O
, O
simply O
through O
ftp O
) O
. O

It O
is O
plausible O
that O
Artifact O
#1 O
could O
be O
present O
on O
other O
servers O
under O
different O
names O
, O
although O
it O
is O
also O
likely O
that O
the O
attacker O
only O
left O
it O
on O
servers O
to O
which O
they O
required O
maintainenance O
of O
persistent O
access O
. O

Artifact O
#2 O
was O
recovered O
from O
the O
Admin O
Controller O
operated O
by O
Die O
Linke O
. O

This O
is O
custom O
malware O
, O
which O
despite O
large O
file O
size O
( O
1,1 O
MB O
) O
, O
provides O
limited O
functionality O
. O

Artifact O
#2 O
operates O
as O
a O
backchannel O
for O
the O
attacker O
to O
maintain O
a O
foothold O
inside O
the O
compromised O
network O
. O

The O
properties O
of O
the O
artifact O
show O
that O
the O
same O
authors O
of O
the O
malware O
seem O
to O
have O
called O
it O
Xtunnel O
. O

As O
the O
same O
name O
suggests O
, O
the O
artifact O
appears O
in O
fact O
to O
act O
as O
a O
tunnel O
for O
the O
attacker O
to O
remotely O
access O
the O
internal O
network O
and O
maintain O
persistence O
. O

After O
initialization O
, O
the O
artifact O
will O
attempt O
to O
establish O
a O
connection O
by O
creating O
a O
socket O
. O

In O
case O
of O
failure O
, O
it O
will O
sleep O
for O
three O
seconds O
and O
try O
again O
. O

The O
authors O
of O
the O
malware O
didn’t O
appear O
to O
have O
spent O
any O
effort O
in O
concealing O
indicators O
or O
obfuscating O
code O
– O
the O
IP O
address O
with O
which O
it O
tries O
to O
communicate O
is O
hardcoded O
in O
clear-text O
inside O
the O
binary O
. O

We O
can O
observe O
below O
, O
the O
procedure O
through O
which O
the O
artifact O
attempts O
to O
establish O
a O
connection O
with O
the O
IP O
address O
176.31.112.10 O
. O

This O
specific O
IP O
address O
is O
a O
critical O
piece O
of O
information O
that O
enables O
us O
to O
connect O
this O
attack O
to O
a O
spree O
of O
previous O
targeted O
campaigns O
. O

The O
details O
of O
this O
attribution O
is O
explained O
in O
a O
dedicated O
section O
below O
. O

We O
will O
refer O
to O
this O
IP O
address O
as O
Command O
& O
Control O
( O
or O
C&C O
) O
. O

If O
the O
argument O
-SSL O
is O
given O
through O
command-line O
to O
the O
artifact O
, O
these O
beacons O
will O
be O
encapsulated O
in O
an O
SSL O
connection O
and O
a O
proper O
TLS O
handshake O
will O
be O
initiated O
with O
the O
C&C O
. O

Interestingly O
, O
the O
artifact O
bundles O
a O
copy O
of O
OpenSSL O
1.0.1e O
, O
from O
February O
2013 O
, O
which O
causes O
the O
unusually O
large O
size O
of O
the O
binary O
. O

More O
importantly O
, O
the O
Command O
& O
Control O
server O
( O
176.31.112.10 O
) O
also O
appears O
to O
be O
using O
an O
outdated O
version O
of O
OpenSSL O
and O
be O
vulnerable O
to O
Heartbleed O
attacks O
. O

While O
unlikely O
, O
it O
is O
worth O
considering O
that O
the O
same O
C&C O
server O
might O
have O
been O
the O
subject O
of O
3rd-party O
attacks O
due O
to O
this O
vulnerability O
. O

If O
connections O
to O
the O
C&C O
are O
blocked O
or O
terminated O
through O
a O
firewall O
, O
the O
artifact O
will O
be O
inhibited O
, O
as O
it O
doesn’t O
seem O
to O
have O
any O
fallback O
protocol O
. O

Additionally O
, O
since O
it O
does O
not O
execute O
any O
other O
functionality O
autonomously O
, O
it O
would O
no O
longer O
be O
a O
direct O
threat O
. O

While O
attribution O
of O
malware O
attacks O
is O
rarely O
simple O
or O
conclusive O
, O
during O
the O
course O
of O
this O
investigation O
I O
uncovered O
evidence O
that O
suggests O
the O
attacker O
might O
be O
affiliated O
with O
the O
state-sponsored O
group O
known O
as O
Sofacy B-Organization
Group I-Organization
( O
also O
known O
as O
APT28 B-Organization
or O
Operation B-Organization
Pawn I-Organization
Storm I-Organization
) O
. O

Although O
we O
are O
unable O
to O
provide O
details O
in O
support O
of O
such O
attribution O
, O
previous O
work O
by O
security O
vendor O
FireEye B-Organization
suggests O
the O
group O
might O
be O
of O
Russian O
origin O
, O
however O
no O
evidence O
allows O
to O
tie O
the O
attacks O
to O
governments O
of O
any O
particular O
country O
. O

Sofacy B-Organization
is O
a O
group O
dedicated O
to O
the O
compromise O
of O
high-profile O
targets O
and O
the O
theft O
of O
confidential O
information O
. O

They O
appear O
to O
have O
been O
active O
since O
2006 O
. O

They O
are O
believed O
to O
have O
successfully O
attacked O
the O
Ministries O
of O
Internal O
and O
Foreign O
Affairs O
of O
several O
ex-Soviet O
countries O
, O
as O
well O
as O
Eastern O
European O
governments O
and O
military B-Organization
institutions I-Organization
, O
and O
NATO O
and O
the O
White O
House I-Organization
. O

Sofacy B-Organization
is O
known O
for O
making O
extensive O
use O
of O
phishing O
attacks O
to O
lure O
targets O
into O
revealing O
their O
credentials O
via O
realistic O
reconstruction O
of O
internal O
systems O
, O
such O
as O
webmails O
, O
as O
employed O
against O
the O
Georgian O
Ministry O
of O
Internal O
Affairs O
in O
the O
infamous O
attacks O
that O
preceded O
the O
Georgian O
invasion O
of O
2008 O
. O

While O
Sofacy B-Organization
is O
also O
known O
to O
use O
of O
custom O
exploit O
frameworks O
and O
spear-phishing B-Vulnerability
attacks O
, O
it O
is O
possible O
in O
this O
case O
that O
they O
managed O
to O
obtain O
privileged O
credentials O
of O
network O
administrators O
within O
the O
Bundestag O
through O
the O
use O
of O
a O
phishing O
attack O
, O
which O
then O
allowed O
them O
to O
navigate O
through O
the O
network O
and O
gain O
access O
to O
more O
data O
. O

It O
is O
worth O
noting O
that O
shortly O
before O
the O
attack O
, O
security B-Organization
vendors I-Organization
reported O
the O
use O
of O
0-day B-Vulnerability
exploits I-Vulnerability
in O
Flash O
Player I-Vulnerability
and O
Microsoft O
Windows O
by O
the O
same O
threat B-Organization
actor O
. O

During O
investigation O
of O
the O
Command O
& O
Control O
server O
( O
with O
IP O
176.31.112.10 O
hardcoded O
in O
Artifact O
#2 O
) O
, O
we O
managed O
to O
identify O
some O
operational O
mistakes O
made O
by O
the O
attackers B-Organization
, O
allowing O
us O
to O
connect O
the O
incident O
with O
attacks O
previously O
associated O
with O
the O
Sofacy B-Organization
Group I-Organization
. O

The O
address O
, O
176.31.112.10 O
, O
is O
a O
dedicated O
server O
provided O
by O
the O
French O
OVH O
hosting O
company O
, O
but O
is O
apparently O
operated O
by O
an O
offshore O
secure O
hosting O
company O
called O
CrookServers.com O
. O

By O
researching O
historical O
data O
relevant O
to O
C&C O
176.31.112.10 O
, O
we O
discovered O
that O
on O
February O
16th O
2015 O
, O
the O
server O
was O
sharing O
an O
SSL O
certificate O
with O
another O
IP O
address O
allocated O
to O
CrookServers O
and O
also O
hosted O
at O
OVH O
: O
213.251.187.145 O
. O

The O
recovered O
shared O
SSL B-System
certificate I-System
, O
obtained O
by O
a O
public O
internet-wide O
scanning O
initiative O
, O
at O
the O
time O
had O
the O
following O
attributes O
: O
MD5 O
b84b66bcdecd4b4529014619ed649d76 O
SHA1 O
fef1725ad72e4ef0432f8cb0cb73bf7ead339a7c O
Algorithm O
sha1 O
With O
RSA O
Encryption O
. O

As O
shown O
, O
the O
certificate O
uses O
mail.mfa.gov.ua O
as O
a O
Common O
Name O
. O

This O
suggests O
that O
this O
certificate O
might O
have O
been O
previously O
used O
for O
a O
similar O
attack O
against O
the O
Ukrainian O
Ministry O
of O
Foreign O
Affairs O
, O
or O
associated O
targets O
, O
although O
there O
is O
no O
documentation O
of O
such O
attack O
available O
to O
the O
public O
. O

More O
importantly O
, O
the O
IP O
address O
this O
certificate O
was O
shared O
with O
213.251.187.145 O
was O
previously O
identified O
as O
used O
by O
Sofacy B-Organization
Group I-Organization
for O
phishing O
attacks O
against O
Albanian O
government B-Organization
institutions I-Organization
by O
registering O
the O
domain O
qov.al O
and O
creating O
realistic O
subdomains O
to O
lure O
victims O
into O
visiting O
. O

The O
domain O
was O
active O
on O
the O
IP O
213.251.187.145 O
from O
July O
2014 O
up O
until O
March O
2015 O
. O

These O
attacks O
against O
Albanian O
government B-Organization
institutions I-Organization
by O
the O
Sofacy B-Organization
Group I-Organization
were O
documented O
and O
reported O
by O
consultancy B-Organization
corporate O
PwC B-Organization
in O
December O
2014 O
. O

It O
is O
worth O
noting O
that O
this O
server O
also O
seems O
to O
be O
operated O
by O
CrookServers O
, O
since O
among O
other O
domains O
, O
454-reverse.crookservers.net O
resolved O
to O
the O
same O
IP O
address O
. O

While O
the O
evidence O
presented O
strongly O
suggests O
a O
connection O
with O
the O
Sofacy B-Organization
Group I-Organization
, O
the O
artifacts O
( O
in O
particular O
Artifact O
#2 O
) O
are O
not O
publicly O
recognized O
to O
be O
part O
of O
the O
more O
traditional O
arsenal O
of O
these O
attackers B-Organization
. O

Nevertheless O
, O
on O
May O
12th O
2015 O
( O
a O
few O
weeks O
after O
the O
attack O
against O
Bundestag O
appears O
to O
have O
started O
) O
the O
American O
security O
firm O
root9B O
released O
a O
report O
containing O
details O
on O
malware O
samples O
very O
similar O
to O
Artifact O
#2 O
. O

The O
report O
also O
includes O
a O
mention O
of O
the O
same O
IP O
address O
used O
as O
Command O
& O
Control O
server O
in O
the O
attack O
against O
Bundestag O
( O
176.31.112.10 O
) O
. O

While O
the O
report O
appears O
to O
contain O
numerous O
inaccuracies O
, O
some O
of O
the O
indicators O
of O
compromises O
are O
legitimate O
and O
appear O
to O
be O
correctly O
attributed O
to O
Sofacy B-Organization
. O

A O
Slice O
of O
2017 O
Sofacy B-Organization
Activity O
. O

Sofacy B-Organization
, O
also O
known O
as O
APT28 B-Organization
, O
Fancy B-Organization
Bear I-Organization
, O
and O
Tsar B-Organization
Team I-Organization
, O
is O
a O
highly O
active O
and O
prolific O
APT O
. O

From O
their O
high O
volume O
0day O
deployment O
to O
their O
innovative O
and O
broad O
malware O
set O
, O
Sofacy B-Organization
is O
one O
of O
the O
top O
groups O
that O
we O
monitor O
, O
report O
, O
and O
protect O
against O
. O

2017 O
was O
not O
any O
different O
in O
this O
regard O
. O

Our O
private O
reports O
subscription O
customers O
receive O
a O
steady O
stream O
of O
YARA O
, O
IOC O
, O
and O
reports O
on O
Sofacy B-Organization
, O
our O
most O
reported O
APT O
for O
the O
year O
. O

This O
high O
level O
of O
cyber-espionage O
activity O
goes O
back O
years O
. O

In O
2011-2012 O
, O
the O
group B-Organization
used O
a O
relatively O
tiny O
implant O
( O
known O
as O
“ O
Sofacy B-Organization
” O
or O
SOURFACE B-Organization
) O
as O
their O
first O
stage O
malware O
, O
which O
at O
the O
time O
had O
similarities O
with O
the O
old O
Miniduke B-System
implants O
. O

This O
made O
us O
believe O
the O
two O
groups O
were O
connected O
, O
although O
it O
looks O
they O
split O
ways O
at O
a O
certain O
point O
, O
with O
the O
original O
Miniduke B-Organization
group I-Organization
switching O
to O
the O
CosmicDuke B-Malware
implant O
in O
2014 O
. O

The O
division B-Organization
in O
malware O
was O
consistent O
and O
definitive O
at O
that O
point O
. O

In O
2013 O
, O
the O
Sofacy B-Organization
group I-Organization
expanded O
their O
arsenal O
and O
added O
more O
backdoors O
and O
tools O
, O
including O
CORESHELL B-System
, O
SPLM B-System
( O
aka O
Xagent B-System
, O
aka O
CHOPSTICK B-System
) O
, O
JHUHUGIT B-System
( O
which O
is O
built O
with O
code O
from O
the O
Carberp B-System
sources O
) O
, O
AZZY B-System
( O
aka O
ADVSTORESHELL B-System
, O
NETUI B-System
, O
EVILTOSS B-System
, O
and O
spans B-System
across O
4-5 O
generations I-System
) O
and O
a O
few O
others O
. O

We O
’ve O
seen O
quite O
a O
few O
versions O
of O
these O
implants O
, O
which O
were O
relatively O
widespread O
at O
some O
point O
or O
still O
are O
. O

In O
2015 O
we O
noticed O
another O
wave O
of O
attacks O
which O
took O
advantage O
of O
a O
new O
release O
of O
the O
AZZY B-System
implant I-Malware
, O
largely O
undetected O
by O
antivirus O
products O
. O

The O
new O
wave O
of O
attacks O
included O
a O
new O
generation O
of O
USB O
stealers O
deployed O
by O
Sofacy B-Organization
, O
with O
initial O
versions O
dating O
to O
February O
2015 O
. O

It O
appeared O
to O
be O
geared O
exclusively O
towards O
high O
profile O
targets O
. O

Sofacy B-Organization
’s O
reported O
presence O
in O
the O
DNC O
network O
alongside O
APT29 B-Organization
brought O
possibly O
the O
highest O
level O
of O
public O
attention O
to O
the O
group B-Organization
’s O
activities O
in O
2016 O
, O
especially O
when O
data O
from O
the O
compromise O
was O
leaked O
and O
“ O
weaponized O
” O
. O

And O
later O
2016 O
, O
their O
focus O
turned O
towards O
the O
Olympics O
’ O
and O
the O
World O
Anti-Doping O
Agency O
( O
WADA O
) O
and O
Court O
of O
Arbitration O
for O
Sports O
( O
CAS O
) O
, O
when O
individuals O
and O
servers O
in O
these O
organizations O
were O
phished O
and O
compromised O
. O

In O
a O
similar O
vein O
with O
past O
CyberBerkut O
activity O
, O
attackers B-Organization
hid O
behind O
anonymous B-Organization
activist O
groups O
like O
“ O
anonpoland O
” O
, O
and O
data O
from O
victimized O
organizations O
were O
similarly O
leaked O
and O
“ O
weaponized O
” O
. O

This O
write-up O
will O
survey O
notables O
in O
the O
past O
year O
of O
2017 O
Sofacy O
activity O
, O
including O
their O
targeting O
, O
technology O
, O
and O
notes O
on O
their O
infrastructure O
. O

No O
one O
research O
group O
has O
100% O
global O
visibility O
, O
and O
our O
collected O
data O
is O
presented O
accordingly O
. O

Here O
, O
external O
APT28 B-Organization
reports O
on O
2017 O
Darkhotel-style O
activity O
in O
Europe O
and O
Dealer O
’s O
Choice O
spearphishing B-Vulnerability
are O
of O
interest O
. O

From O
where O
we O
sit O
, O
2017 O
Sofacy B-Organization
activity O
starts O
with O
a O
heavy O
focus O
on O
NATO O
and O
Ukrainian O
partners O
, O
coinciding O
with O
lighter O
interest O
in O
Central O
Asian O
targets O
, O
and O
finishing O
the O
second O
half O
of O
the O
year O
with O
a O
heavy O
focus O
on O
Central O
Asian O
targets O
and O
some O
shift O
further O
East O
. O

Sofacy B-Organization
kicked O
off O
the O
year O
deploying O
two O
0day O
in O
a O
spearphish B-Vulnerability
document I-Malware
, O
both O
a O
Microsoft O
Office O
encapsulated O
postscript O
type O
confusion O
exploit O
( O
abusing B-Vulnerability
CVE-2017-0262 B-Vulnerability
) O
and O
an O
escalation O
of O
privilege O
use-after-free B-Vulnerability
exploit I-Vulnerability
( O
abusing B-Vulnerability
CVE-2017-0263 B-Vulnerability
) O
. O

The O
group B-Organization
attempted O
to O
deploy O
this O
spearphish B-Vulnerability
attachment I-Vulnerability
to O
push O
a O
small O
30kb O
backdoor O
known O
as O
GAMEFISH B-Organization
to O
targets O
in O
Europe O
at O
the O
beginning O
of O
2017 O
. O

They O
took O
advantage O
of O
the O
Syrian O
military O
conflict O
for O
thematic O
content O
and O
file O
naming O
“ O
Trump O
’s_Attack_on_Syria_English.docx O
” O
. O

Again O
, O
this O
deployment O
was O
likely O
a O
part O
of O
their O
focus O
on O
NATO O
targets O
. O

Meanwhile O
in O
early-to-mid O
2017 O
, O
SPLM B-Organization
/ O
CHOPSTICK B-System
/ O
XAgent O
detections O
in O
Central O
Asia O
provided O
a O
glimpse O
into O
ongoing O
focus O
on O
ex-Soviet O
republics O
in O
Central O
Asia O
. O

These O
particular O
detections O
are O
interesting O
because O
they O
indicate O
an O
attempted O
selective O
2nd O
stage O
deployment O
of O
a O
backdoor O
maintaining O
filestealer O
, O
keylogger B-System
, O
and O
remoteshell O
functionality O
to O
a O
system O
of O
interest O
. O

As O
the O
latest O
revision O
of O
the O
backdoor O
, O
portions O
of O
SPLM O
didn’t O
match O
previous O
reports O
on O
SPLM O
/ O
XAgent O
while O
other O
similarities O
were O
maintained O
. O

SPLM O
64-bit O
modules O
already O
appeared O
to O
be O
at O
version O
4 O
of O
the O
software O
by O
May O
of O
the O
year O
. O

Targeting O
profiles O
included O
defense O
related O
commercial O
and O
military B-Organization
organizations I-Organization
, O
and O
telecommunications O
. O

Since O
mid-November O
2015 O
, O
the O
threat B-Organization
actor O
referred O
to O
as O
“ O
Sofacy B-Organization
” O
or O
“ O
APT28 B-Organization
” O
has O
been O
utilizing O
a O
unique O
payload O
and O
delivery O
mechanism O
written O
in O
Delphi O
and O
AutoIT O
. O

We O
collectively O
refer O
to O
this O
package O
and O
related O
activity O
as O
“ O
Zebrocy B-Organization
” O
and O
had O
written O
a O
few O
reports O
on O
its O
usage O
and O
development O
by O
June O
2017 O
– O
Sofacy B-Organization
developers O
modified O
and O
redeployed O
incremented O
versions O
of O
the O
malware O
. O

The O
Zebrocy B-Organization
chain O
follows O
a O
pattern O
: O
spearphish B-Vulnerability
attachment I-Vulnerability
-> O
compiled O
Autoit O
script O
( O
downloader B-System
) O
-> O
Zebrocy B-System
payload O
. O

In O
some O
deployments O
, O
we O
observed O
Sofacy B-Organization
actively O
developing O
and O
deploying O
a O
new O
package O
to O
a O
much O
smaller O
, O
specific O
subset O
of O
targets O
within O
the O
broader O
set O
. O

Targeting O
profiles O
, O
spearphish B-Vulnerability
filenames O
, O
and O
lures O
carry O
thematic O
content O
related O
to O
visa O
applications O
and O
scanned O
images O
, O
border O
control O
administration O
, O
and O
various O
administrative O
notes O
. O

Targeting O
appears O
to O
be O
widely O
spread O
across O
the O
Middle O
East O
, O
Europe O
, O
and O
Asia O
. O

We O
identified O
new O
MSIL B-Malware
components O
deployed O
by O
Zebrocy B-Organization
. O

While O
recent O
Zebrocy B-Organization
versioning O
was O
7.1 O
, O
some O
of O
the O
related O
Zebrocy O
modules O
that O
drop O
file-stealing O
MSIL B-Malware
modules O
we O
call O
Covfacy O
were O
v7.0 O
. O

The O
components O
were O
an O
unexpected O
inclusion O
in O
this O
particular O
toolset O
. O

For O
example O
, O
one O
sent O
out O
to O
a O
handful O
of O
countries O
identifies O
network O
drives O
when O
they O
are O
added O
to O
target O
systems O
, O
and O
then O
RC4 O
like-encrypts O
and O
writes O
certain O
file O
metadata O
and O
contents O
to O
a O
local O
path O
for O
later O
Exfiltration O
. O

The O
stealer O
searches O
for O
files O
60mb O
and O
less O
with O
these O
extensions O
: O
.doc O
, O
.docx O
, O
.xls O
, O
.xlsx O
, O
.ppt O
, O
.pptx O
, O
.exe O
, O
.zip O
, O
.rar O
. O

At O
execution O
, O
it O
installs O
an O
application-defined O
Windows O
hook O
. O

The O
hook O
gets O
windows O
messages O
indicating O
when O
a O
network O
drive O
has O
been O
attached O
. O

Upon O
adding O
a O
network O
drive O
, O
the O
hook O
calls O
its O
“ O
RecordToFile O
” O
file O
stealer O
method O
. O

SPLM B-Organization
/ O
CHOPSTICK B-System
components O
deployed O
throughout O
2017 O
were O
native O
64-bit O
modular O
C++ O
Windows B-System
COM O
backdoors O
supporting O
http O
over O
fully O
encrypted O
TLSv1 O
and O
TLSv1.2 O
communications O
, O
mostly O
deployed O
in O
the O
second O
half O
of O
2017 O
by O
Sofacy B-Organization
. O

Earlier O
SPLM O
activity O
deployed O
32-bit O
modules O
over O
unencrypted O
http O
( O
and O
sometimes O
smtp O
) O
sessions O
. O

In O
2016 O
we O
saw O
fully O
functional O
, O
very O
large O
SPLM B-Organization
/ O
X-Agent O
modules O
supporting O
OS O
X O
. O

The O
executable O
module O
continues O
to O
be O
part O
of O
a O
framework O
supporting O
various O
internal O
and O
external O
components O
communicating O
over O
internal O
and O
external O
channels O
, O
maintaining O
slightly O
morphed O
encryption O
and O
functionality O
per O
deployment O
. O

Sofacy B-Organization
selectively O
used O
SPLM B-System
/ I-System
CHOPSTICK I-System
modules I-System
as O
second O
stage O
implants O
to O
high O
interest O
targets O
for O
years O
now O
. O

The O
newer O
SPLM O
modules O
are O
deployed O
mostly O
to O
Central O
Asian O
based O
targets O
that O
may O
have O
a O
tie O
to O
NATO O
in O
some O
form O
. O

These O
targets O
include O
foreign B-Organization
affairs O
government I-Organization
organizations I-Organization
both O
localized O
and O
abroad O
, O
and O
defense B-Organization
organizations O
’ O
presence O
localized O
, O
located O
in O
Europe O
and O
also O
located O
in O
Afghanistan O
. O

One O
outlier O
SPLM O
target O
profile O
within O
our O
visibility O
includes O
an O
audit O
and O
consulting O
firm O
in O
Bosnia O
and O
Herzegovina O
. O

Minor O
changes O
and O
updates O
to O
the O
code O
were O
released O
with O
these O
deployments O
, O
including O
a O
new O
mutex O
format O
and O
the O
exclusive O
use O
of O
encrypted O
HTTP O
communications O
over O
TLS O
. O

The O
compiled O
code O
itself O
already O
is O
altered O
per O
deployment O
in O
multiple O
subtle O
ways O
, O
in O
order O
to O
stymie O
identification O
and O
automated O
analysis O
and O
accommodate O
targeted O
environments O
. O

Strings O
( O
c2 O
domains O
and O
functionality O
, O
error O
messages O
, O
etc O
) O
are O
custom O
encrypted O
per O
deployment O
. O

This O
subset O
of O
SPLM O
/ O
CHOPSTICK O
activity O
leads O
into O
several O
small O
surprises O
that O
take O
us O
into O
2018 O
, O
to O
be O
discussed O
in O
further O
detail O
at O
SAS O
2018 O
. O

The O
group B-Organization
demonstrates O
malleability O
and O
innovation O
in O
maintaining O
and O
producing O
familiar O
SPLM O
functionality O
, O
but O
the O
pragmatic O
and O
systematic O
approach O
towards O
producing O
undetected O
or O
difficult-to-detect O
malware O
continues O
. O

Changes O
in O
the O
second O
stage O
SPLM B-System
backdoor I-System
are O
refined O
, O
making O
the O
code O
reliably O
modular O
. O

It O
’s O
interesting O
to O
note O
that O
this O
version O
of O
SPLM O
implements O
communications O
that O
are O
fully O
encrypted O
over O
HTTPS O
. O

As O
an O
example O
, O
we O
might O
see O
extraneous O
data O
in O
their O
SSL B-System
/ O
TLS O
certificates O
that O
give O
away O
information O
about O
their O
provider O
or O
resources O
. O

Leading O
up O
to O
summer O
2017 O
, O
infrastructure O
mostly O
was O
created O
with O
PDR O
and O
Internet O
Domain O
Service O
BS O
Corp O
, O
and O
their O
resellers O
. O

Hosting O
mostly O
was O
provided O
at O
Fast O
Serv O
Inc O
and O
resellers O
, O
in O
all O
likelihood O
related O
to O
bitcoin O
payment O
processing O
. O

Accordingly O
, O
the O
server O
side O
certificates O
appear O
to O
be O
generated O
locally O
on O
VPS O
hosts O
that O
exclusively O
are O
paid O
for O
at O
providers O
with O
bitcoin O
merchant O
processing O
. O

